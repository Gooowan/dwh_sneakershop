{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.1", "generated_at": "2024-11-07T12:25:14.631269Z", "invocation_id": "c5d7ad94-55ed-4694-babc-c1166ad21b8f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.374641Z", "completed_at": "2024-11-07T12:25:14.380317Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.396234Z", "completed_at": "2024-11-07T12:25:14.468180Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.12618589401245117, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.stg_orders", "compiled": true, "compiled_code": "SELECT\n  \n  TRY_CAST(order_id AS INTEGER)\n AS order_id,\n  \n  TRY_CAST(customer_id AS INTEGER)\n AS customer_id,\n  \n  TRY_CAST(order_date AS TIMESTAMP)\n AS order_date,\n  \n  TRY_CAST(total_amount AS DECIMAL(10,2))\n AS total_amount\nFROM \"jaffle_shop\".\"main\".\"raw_orders\"", "relation_name": "\"jaffle_shop\".\"main\".\"stg_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.346221Z", "completed_at": "2024-11-07T12:25:14.379767Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.380973Z", "completed_at": "2024-11-07T12:25:14.468992Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1290299892425537, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.stg_customers", "compiled": true, "compiled_code": "SELECT\n  \n  TRY_CAST(customer_id AS INTEGER)\n AS customer_id,\n  \nCONCAT(UPPER(SUBSTRING(TRIM(first_name), 1, 1)), LOWER(SUBSTRING(TRIM(first_name), 2)))\n AS first_name,\n  \nCONCAT(UPPER(SUBSTRING(TRIM(last_name), 1, 1)), LOWER(SUBSTRING(TRIM(last_name), 2)))\n AS last_name,\n  LOWER(TRIM(email)) AS email,\n  \n  TRY_CAST(created_at AS TIMESTAMP)\n AS created_at\nFROM \"jaffle_shop\".\"main\".\"raw_customers\"", "relation_name": "\"jaffle_shop\".\"main\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.372537Z", "completed_at": "2024-11-07T12:25:14.380038Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.394679Z", "completed_at": "2024-11-07T12:25:14.469500Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.12842273712158203, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.stg_inventory_transactions", "compiled": true, "compiled_code": "SELECT\n  CAST(transaction_id AS INTEGER) AS transaction_id,\n  CAST(product_id AS INTEGER) AS product_id,\n  CAST(quantity_change AS INTEGER) AS quantity_change,\n  CAST(transaction_date AS TIMESTAMP) AS transaction_date,\n  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason\nFROM \"jaffle_shop\".\"main\".\"raw_inventory_transactions\"", "relation_name": "\"jaffle_shop\".\"main\".\"stg_inventory_transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.351785Z", "completed_at": "2024-11-07T12:25:14.380642Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.399410Z", "completed_at": "2024-11-07T12:25:14.470147Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.12929987907409668, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.stg_inventory", "compiled": true, "compiled_code": "SELECT\n  CAST(product_id AS INTEGER) AS product_id,\n  CAST(quantity AS INTEGER) AS quantity,\n  CAST(last_updated AS TIMESTAMP) AS last_updated\nFROM \"jaffle_shop\".\"main\".\"raw_inventory\"", "relation_name": "\"jaffle_shop\".\"main\".\"stg_inventory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.373601Z", "completed_at": "2024-11-07T12:25:14.380476Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.397932Z", "completed_at": "2024-11-07T12:25:14.470623Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.12909626960754395, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.stg_order_details", "compiled": true, "compiled_code": "SELECT\n  CAST(order_id AS INTEGER) AS order_id,\n  CAST(product_id AS INTEGER) AS product_id,\n  CAST(quantity AS INTEGER) AS quantity,\n  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,\n  CAST(line_total AS DECIMAL(10,2)) AS line_total\nFROM \"jaffle_shop\".\"main\".\"raw_order_details\"", "relation_name": "\"jaffle_shop\".\"main\".\"stg_order_details\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.375984Z", "completed_at": "2024-11-07T12:25:14.380831Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.400759Z", "completed_at": "2024-11-07T12:25:14.471818Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.12923097610473633, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.stg_products", "compiled": true, "compiled_code": "SELECT\n  \n  TRY_CAST(product_id AS INTEGER)\n AS product_id,\n  \nCONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))\n AS product_name,\n  \nCONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))\n AS category,\n  \n  TRY_CAST(price AS DECIMAL(10,2))\n AS price,\n  \n  TRY_CAST(created_at AS TIMESTAMP)\n AS created_at\nFROM \"jaffle_shop\".\"main\".\"raw_products\"", "relation_name": "\"jaffle_shop\".\"main\".\"stg_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.377452Z", "completed_at": "2024-11-07T12:25:14.397799Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.404288Z", "completed_at": "2024-11-07T12:25:14.472265Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.12911701202392578, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.stg_supplier_products", "compiled": true, "compiled_code": "SELECT\n  CAST(supplier_id AS INTEGER) AS supplier_id,\n  CAST(product_id AS INTEGER) AS product_id\nFROM \"jaffle_shop\".\"main\".\"raw_supplier_products\"", "relation_name": "\"jaffle_shop\".\"main\".\"stg_supplier_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.378594Z", "completed_at": "2024-11-07T12:25:14.397661Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.402536Z", "completed_at": "2024-11-07T12:25:14.473156Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1323709487915039, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.stg_suppliers", "compiled": true, "compiled_code": "SELECT\n  CAST(supplier_id AS INTEGER) AS supplier_id,\n  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,\n  LOWER(TRIM(contact_email)) AS contact_email,\n  TRIM(phone_number) AS phone_number\nFROM \"jaffle_shop\".\"main\".\"raw_suppliers\"", "relation_name": "\"jaffle_shop\".\"main\".\"stg_suppliers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.488305Z", "completed_at": "2024-11-07T12:25:14.491121Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.491700Z", "completed_at": "2024-11-07T12:25:14.537693Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.054025888442993164, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.dim_products", "compiled": true, "compiled_code": "SELECT\n  product_id,\n  product_name,\n  category,\n  price,\n  created_at AS product_created_date\nFROM \"jaffle_shop\".\"main\".\"stg_products\"", "relation_name": "\"jaffle_shop\".\"main\".\"dim_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.485107Z", "completed_at": "2024-11-07T12:25:14.497421Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.503695Z", "completed_at": "2024-11-07T12:25:14.539244Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.05658388137817383, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.dim_customers", "compiled": true, "compiled_code": "SELECT\n  customer_id,\n  first_name,\n  last_name,\n  email,\n  created_at AS customer_created_date\nFROM \"jaffle_shop\".\"main\".\"stg_customers\"", "relation_name": "\"jaffle_shop\".\"main\".\"dim_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.486388Z", "completed_at": "2024-11-07T12:25:14.491413Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.502257Z", "completed_at": "2024-11-07T12:25:14.540085Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.05735421180725098, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.fact_sales", "compiled": true, "compiled_code": "SELECT\n  od.order_id,\n  o.order_date,\n  od.product_id,\n  od.quantity,\n  od.unit_price,\n  od.line_total,\n  o.customer_id\nFROM \"jaffle_shop\".\"main\".\"stg_order_details\" AS od\nJOIN \"jaffle_shop\".\"main\".\"stg_orders\" AS o ON od.order_id = o.order_id", "relation_name": "\"jaffle_shop\".\"main\".\"fact_sales\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.489341Z", "completed_at": "2024-11-07T12:25:14.491284Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.500692Z", "completed_at": "2024-11-07T12:25:14.540781Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.06094813346862793, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.low_stock", "compiled": true, "compiled_code": "WITH dim_products AS (\n    SELECT\n      product_id,\n      product_name,\n      category,\n      price,\n      created_at AS product_created_date\n    FROM \"jaffle_shop\".\"main\".\"stg_products\"\n),\n\ninventory_status AS (\n    SELECT\n      i.product_id,\n      p.product_name,\n      i.quantity,\n      i.last_updated\n    FROM \"jaffle_shop\".\"main\".\"stg_inventory\" AS i\n    JOIN \"jaffle_shop\".\"main\".\"stg_products\" AS p ON i.product_id = p.product_id\n),\n\ncurrent_inventory AS (\n    SELECT\n        i.product_id,\n        p.product_name,\n        p.category,\n        i.quantity,\n        i.last_updated\n    FROM inventory_status AS i\n    JOIN dim_products AS p ON i.product_id = p.product_id\n),\n\nlow_stock_products AS (\n    SELECT\n        ci.product_id,\n        ci.product_name,\n        ci.category,\n        ci.quantity,\n        ci.last_updated\n    FROM current_inventory AS ci\n    WHERE ci.quantity < 20\n)\n\nSELECT * FROM low_stock_products\nORDER BY quantity ASC", "relation_name": "\"jaffle_shop\".\"main\".\"low_stock\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.548457Z", "completed_at": "2024-11-07T12:25:14.551265Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.555037Z", "completed_at": "2024-11-07T12:25:14.588271Z"}], "thread_id": "Thread-17 (worker)", "execution_time": 0.06867504119873047, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.top_category", "compiled": true, "compiled_code": "WITH fact_sales AS (\n    SELECT\n        od.order_id,\n        o.order_date,\n        od.product_id,\n        od.quantity,\n        od.unit_price,\n        od.line_total,\n        o.customer_id\n    FROM \"jaffle_shop\".\"main\".\"stg_order_details\" AS od\n    JOIN \"jaffle_shop\".\"main\".\"stg_orders\" AS o ON od.order_id = o.order_id\n),\n\ncategory_sales AS (\n    SELECT\n        dp.category,\n        SUM(fs.line_total) AS total_category_sales\n    FROM fact_sales AS fs\n    JOIN \"jaffle_shop\".\"main\".\"dim_products\" AS dp ON fs.product_id = dp.product_id\n    GROUP BY dp.category\n),\n\ntop_category AS (\n    SELECT\n        cs.category,\n        cs.total_category_sales,\n        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank\n    FROM category_sales AS cs\n)\n\nSELECT * FROM top_category", "relation_name": "\"jaffle_shop\".\"main\".\"top_category\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.556595Z", "completed_at": "2024-11-07T12:25:14.560075Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.561798Z", "completed_at": "2024-11-07T12:25:14.619232Z"}], "thread_id": "Thread-22 (worker)", "execution_time": 0.06916689872741699, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.monthly_sales_growth", "compiled": true, "compiled_code": "WITH fact_sales AS (\n    SELECT\n      od.order_id,\n      o.order_date,\n      od.product_id,\n      od.quantity,\n      od.unit_price,\n      od.line_total,\n      o.customer_id\n    FROM \"jaffle_shop\".\"main\".\"stg_order_details\" AS od\n    JOIN \"jaffle_shop\".\"main\".\"stg_orders\" AS o ON od.order_id = o.order_id\n),\n\nmonthly_sales AS (\n    SELECT\n        DATE_TRUNC('month', order_date) AS sales_month,\n        SUM(line_total) AS total_revenue,\n        SUM(quantity) AS total_quantity_sold\n    FROM \"jaffle_shop\".\"main\".\"fact_sales\"\n    GROUP BY sales_month\n),\n\nsales_growth AS (\n    SELECT\n        ms.sales_month,\n        ms.total_revenue,\n        ms.total_quantity_sold,\n        LAG(ms.total_revenue) OVER (ORDER BY ms.sales_month) AS previous_revenue,\n        LAG(ms.total_quantity_sold) OVER (ORDER BY ms.sales_month) AS previous_quantity\n    FROM monthly_sales AS ms\n),\n\ngrowth_calculations AS (\n    SELECT\n        sg.sales_month,\n        sg.total_revenue,\n        sg.total_quantity_sold,\n        ROUND(((sg.total_revenue - sg.previous_revenue) / sg.previous_revenue) * 100, 2) AS revenue_growth_percentage,\n        ROUND(((sg.total_quantity_sold - sg.previous_quantity) / sg.previous_quantity) * 100, 2) AS quantity_growth_percentage\n    FROM sales_growth AS sg\n    WHERE sg.previous_revenue IS NOT NULL\n)\n\nSELECT * FROM growth_calculations\nORDER BY sales_month ASC", "relation_name": "\"jaffle_shop\".\"main\".\"monthly_sales_growth\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.551559Z", "completed_at": "2024-11-07T12:25:14.558144Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.558631Z", "completed_at": "2024-11-07T12:25:14.619727Z"}], "thread_id": "Thread-19 (worker)", "execution_time": 0.0699610710144043, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.avg_order_value", "compiled": true, "compiled_code": "WITH fact_sales AS (\n    SELECT\n      od.order_id,\n      o.order_date,\n      od.product_id,\n      od.quantity,\n      od.unit_price,\n      od.line_total,\n      o.customer_id\n    FROM \"jaffle_shop\".\"main\".\"stg_order_details\" AS od\n    JOIN \"jaffle_shop\".\"main\".\"stg_orders\" AS o ON od.order_id = o.order_id\n),\n\ncustomer_order_totals AS (\n    SELECT\n        customer_id,\n        COUNT(DISTINCT order_id) AS total_orders,\n        SUM(line_total) AS total_spent\n    FROM fact_sales\n    GROUP BY customer_id\n    HAVING COUNT(DISTINCT order_id) > 3\n),\n\naverage_order_value AS (\n    SELECT\n        cot.customer_id,\n        dc.first_name,\n        dc.last_name,\n        cot.total_orders,\n        cot.total_spent,\n        ROUND(cot.total_spent / cot.total_orders, 1) AS avg_order_value\n    FROM customer_order_totals AS cot\n    JOIN \"jaffle_shop\".\"main\".\"dim_customers\" AS dc ON cot.customer_id = dc.customer_id\n)\n\nSELECT * FROM average_order_value\nORDER BY avg_order_value DESC", "relation_name": "\"jaffle_shop\".\"main\".\"avg_order_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-07T12:25:14.553715Z", "completed_at": "2024-11-07T12:25:14.558284Z"}, {"name": "execute", "started_at": "2024-11-07T12:25:14.560226Z", "completed_at": "2024-11-07T12:25:14.621066Z"}], "thread_id": "Thread-20 (worker)", "execution_time": 0.07388806343078613, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.jaffle_shop.customer_LTV", "compiled": true, "compiled_code": "WITH fact_sales AS (\n    SELECT\n      od.order_id,\n      o.order_date,\n      od.product_id,\n      od.quantity,\n      od.unit_price,\n      od.line_total,\n      o.customer_id\n    FROM \"jaffle_shop\".\"main\".\"stg_order_details\" AS od\n    JOIN \"jaffle_shop\".\"main\".\"stg_orders\" AS o ON od.order_id = o.order_id\n),\n\ncustomer_revenue AS (\n    SELECT\n        fs.customer_id,\n        SUM(fs.line_total) AS total_revenue,\n        MIN(fs.order_date) AS first_purchase_date,\n        MAX(fs.order_date) AS last_purchase_date,\n        COUNT(DISTINCT fs.order_id) AS total_orders\n    FROM fact_sales AS fs\n    GROUP BY fs.customer_id\n),\n\ncustomer_ltv AS (\n    SELECT\n        cr.customer_id,\n        dc.first_name,\n        dc.last_name,\n        cr.total_revenue,\n        cr.total_orders,\n        DATE_PART('day', cr.last_purchase_date - cr.first_purchase_date) AS customer_lifespan_days,\n        ROUND(cr.total_revenue / NULLIF(cr.total_orders, 0), 2) AS avg_order_value,\n        ROUND(cr.total_revenue / NULLIF(DATE_PART('day', CURRENT_DATE - cr.first_purchase_date) / 30, 0), 2) AS monthly_ltv\n    FROM customer_revenue AS cr\n    JOIN \"jaffle_shop\".\"main\".\"dim_customers\" AS dc ON cr.customer_id = dc.customer_id\n)\n\nSELECT * FROM customer_ltv\nORDER BY total_revenue DESC", "relation_name": "\"jaffle_shop\".\"main\".\"customer_LTV\""}], "elapsed_time": 0.3600881099700928, "args": {"defer": false, "select": [], "which": "run", "partial_parse": true, "require_resource_names_without_spaces": false, "printer_width": 80, "enable_legacy_logger": false, "profiles_dir": "/Users/bunjee/Desktop/assignment4_db", "log_level_file": "debug", "use_colors": true, "partial_parse_file_diff": true, "macro_debugging": false, "empty": false, "print": true, "cache_selected_only": false, "vars": {}, "strict_mode": false, "version_check": true, "static_parser": true, "favor_state": false, "exclude": [], "indirect_selection": "eager", "log_format": "default", "invocation_command": "dbt run", "log_file_max_bytes": 10485760, "use_colors_file": true, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_level": "info", "log_format_file": "debug", "quiet": false, "populate_cache": true, "show_resource_report": false, "log_path": "/Users/bunjee/Desktop/assignment4_db/logs", "source_freshness_run_project_hooks": false, "project_dir": "/Users/bunjee/Desktop/assignment4_db", "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "introspect": true}}