[0m19:27:42.431980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd7880>]}


============================== 19:27:42.434605 | 94479c79-68f7-42df-9424-e2954b40d57e ==============================
[0m19:27:42.434605 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:27:42.434882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:27:43.069218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94479c79-68f7-42df-9424-e2954b40d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eac2e0>]}
[0m19:27:43.091302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94479c79-68f7-42df-9424-e2954b40d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eac0a0>]}
[0m19:27:43.091926 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:27:43.103555 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:27:43.103987 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:27:43.104167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94479c79-68f7-42df-9424-e2954b40d57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a77550>]}
[0m19:27:43.605082 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:27:43.605377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '94479c79-68f7-42df-9424-e2954b40d57e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424d120>]}
[0m19:27:43.611445 [warn ] [MainThread]: [[33mWARNING[0m]: 'customers' is a seed node, but it is specified in the models section of
models/schema.yml. To fix this error, place the `customers` specification under
the seeds key instead.
[0m19:27:43.613270 [warn ] [MainThread]: [[33mWARNING[0m]: 'orders' is a seed node, but it is specified in the models section of
models/schema.yml. To fix this error, place the `orders` specification under the
seeds key instead.
[0m19:27:43.713482 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation ""jaffle_shop"."main"."customers"".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - model.jaffle_shop.customers (models/customers.sql)
  - seed.jaffle_shop.customers (seeds/customers.csv)
[0m19:27:43.724516 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.3334256, "process_user_time": 1.266784, "process_kernel_time": 0.117786, "process_mem_max_rss": "114098176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:27:43.724834 [debug] [MainThread]: Command `dbt seed` failed at 19:27:43.724788 after 1.33 seconds
[0m19:27:43.725018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bb4d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104398730>]}
[0m19:27:43.725184 [debug] [MainThread]: Flushing usage events
[0m19:28:12.526878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104947fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049478b0>]}


============================== 19:28:12.529496 | 606195e8-7135-434a-ab9c-4fcd4d2e8b5f ==============================
[0m19:28:12.529496 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:28:12.529795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:28:12.991994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '606195e8-7135-434a-ab9c-4fcd4d2e8b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104906ad0>]}
[0m19:28:13.013361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '606195e8-7135-434a-ab9c-4fcd4d2e8b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d4f430>]}
[0m19:28:13.013813 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:28:13.021750 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:28:13.092761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:13.093130 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_customers.sql
[0m19:28:13.181311 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:28:13.181606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '606195e8-7135-434a-ab9c-4fcd4d2e8b5f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc3b80>]}
[0m19:28:13.253326 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation ""jaffle_shop"."main"."customers"".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - model.jaffle_shop.customers (models/customers.sql)
  - seed.jaffle_shop.customers (seeds/customers.csv)
[0m19:28:13.255284 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.7578252, "process_user_time": 0.828951, "process_kernel_time": 0.103983, "process_mem_max_rss": "117850112", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:28:13.255523 [debug] [MainThread]: Command `dbt seed` failed at 19:28:13.255484 after 0.76 seconds
[0m19:28:13.255697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103727fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543a860>]}
[0m19:28:13.255846 [debug] [MainThread]: Flushing usage events
[0m19:28:38.933255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f86980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047abcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ab610>]}


============================== 19:28:38.935807 | e26f384c-9a80-413e-825d-1724b0da0ff7 ==============================
[0m19:28:38.935807 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:28:38.936071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:28:39.059726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e26f384c-9a80-413e-825d-1724b0da0ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476de70>]}
[0m19:28:39.081518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e26f384c-9a80-413e-825d-1724b0da0ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ab610>]}
[0m19:28:39.081974 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:28:39.089975 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:28:39.162075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:28:39.162281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:28:39.165454 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation ""jaffle_shop"."main"."customers"".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - model.jaffle_shop.customers (models/customers.sql)
  - seed.jaffle_shop.customers (seeds/customers.csv)
[0m19:28:39.166963 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.2670994, "process_user_time": 0.654308, "process_kernel_time": 0.084734, "process_mem_max_rss": "110706688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:28:39.167269 [debug] [MainThread]: Command `dbt seed` failed at 19:28:39.167221 after 0.27 seconds
[0m19:28:39.167476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f86980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c01ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c00a30>]}
[0m19:28:39.167659 [debug] [MainThread]: Flushing usage events
[0m19:31:21.199835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027b2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104174070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041752d0>]}


============================== 19:31:21.202361 | 674f898b-90b4-46cf-8efe-001e108b16c5 ==============================
[0m19:31:21.202361 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:31:21.202617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m19:31:21.346572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '674f898b-90b4-46cf-8efe-001e108b16c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10413aad0>]}
[0m19:31:21.367803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '674f898b-90b4-46cf-8efe-001e108b16c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10357f430>]}
[0m19:31:21.368487 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:31:21.376951 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:31:21.447027 [debug] [MainThread]: Partial parsing enabled: 9 files deleted, 6 files added, 2 files changed.
[0m19:31:21.447355 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_inventory_transactions.csv
[0m19:31:21.447518 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_suppliers.csv
[0m19:31:21.447677 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_products.csv
[0m19:31:21.447815 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_inventory.csv
[0m19:31:21.447950 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_supplier_products.csv
[0m19:31:21.448090 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_order_details.csv
[0m19:31:21.448218 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/orders.csv
[0m19:31:21.448344 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/products.csv
[0m19:31:21.448463 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/customers.csv
[0m19:31:21.448579 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/order_details.csv
[0m19:31:21.448694 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/inventory.csv
[0m19:31:21.448808 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/inventory_transactions.csv
[0m19:31:21.448925 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/supplier_products.csv
[0m19:31:21.449036 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/suppliers.csv
[0m19:31:21.449235 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/raw_payments.csv
[0m19:31:21.449388 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/raw_orders.csv
[0m19:31:21.449542 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/raw_customers.csv
[0m19:31:21.596539 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:31:21.596850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '674f898b-90b4-46cf-8efe-001e108b16c5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b554e0>]}
[0m19:31:21.645035 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.stg_payments' (models/staging/stg_payments.sql) depends on a node named 'raw_payments' which was not found
[0m19:31:21.646844 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.48294613, "process_user_time": 0.841194, "process_kernel_time": 0.097782, "process_mem_max_rss": "118521856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:31:21.647133 [debug] [MainThread]: Command `dbt seed` failed at 19:31:21.647084 after 0.48 seconds
[0m19:31:21.647317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027b2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b03730>]}
[0m19:31:21.647481 [debug] [MainThread]: Flushing usage events
[0m19:32:17.188932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10307e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b77cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b77610>]}


============================== 19:32:17.192548 | 6b6097d1-51df-48d6-8177-d07d369d94d0 ==============================
[0m19:32:17.192548 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:32:17.192810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:32:17.315896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b6097d1-51df-48d6-8177-d07d369d94d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b39e70>]}
[0m19:32:17.337138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b6097d1-51df-48d6-8177-d07d369d94d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b77610>]}
[0m19:32:17.337565 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:32:17.345161 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:32:17.413935 [debug] [MainThread]: Partial parsing enabled: 8 files deleted, 6 files added, 3 files changed.
[0m19:32:17.414249 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_inventory.csv
[0m19:32:17.414408 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_products.csv
[0m19:32:17.414551 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_order_details.csv
[0m19:32:17.414684 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_suppliers.csv
[0m19:32:17.414829 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_supplier_products.csv
[0m19:32:17.414967 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_inventory_transactions.csv
[0m19:32:17.415082 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/order_details.csv
[0m19:32:17.415198 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/customers.csv
[0m19:32:17.415309 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/supplier_products.csv
[0m19:32:17.415418 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/inventory_transactions.csv
[0m19:32:17.415527 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/suppliers.csv
[0m19:32:17.415635 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/orders.csv
[0m19:32:17.415743 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/products.csv
[0m19:32:17.415857 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/inventory.csv
[0m19:32:17.416014 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/raw_customers.csv
[0m19:32:17.416171 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/raw_payments.csv
[0m19:32:17.416326 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/raw_orders.csv
[0m19:32:17.516818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b6097d1-51df-48d6-8177-d07d369d94d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f67ee0>]}
[0m19:32:17.568254 [error] [MainThread]: Encountered an error:
Compilation Error
  'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' depends on 'seed.jaffle_shop.customers' which is not in the graph!
[0m19:32:17.569661 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.40891275, "process_user_time": 0.786098, "process_kernel_time": 0.084178, "process_mem_max_rss": "114638848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:32:17.569887 [debug] [MainThread]: Command `dbt seed` failed at 19:32:17.569850 after 0.41 seconds
[0m19:32:17.570050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10307e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105477ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105474820>]}
[0m19:32:17.570197 [debug] [MainThread]: Flushing usage events
[0m19:33:16.482618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10836f790>]}


============================== 19:33:16.485318 | 83506367-d9dc-4709-83b0-edca5c5c3bb9 ==============================
[0m19:33:16.485318 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:33:16.485587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:33:16.636436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83506367-d9dc-4709-83b0-edca5c5c3bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcbeb0>]}
[0m19:33:16.657061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83506367-d9dc-4709-83b0-edca5c5c3bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10843cca0>]}
[0m19:33:16.657589 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:33:16.665402 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:33:16.736948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:16.737148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:16.761735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83506367-d9dc-4709-83b0-edca5c5c3bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f0130>]}
[0m19:33:16.814501 [error] [MainThread]: Encountered an error:
Compilation Error
  'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' depends on 'seed.jaffle_shop.customers' which is not in the graph!
[0m19:33:16.815934 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.37120083, "process_user_time": 0.710023, "process_kernel_time": 0.095274, "process_mem_max_rss": "111820800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:33:16.816162 [debug] [MainThread]: Command `dbt seed` failed at 19:33:16.816125 after 0.37 seconds
[0m19:33:16.816318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087bdf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087bfc70>]}
[0m19:33:16.816475 [debug] [MainThread]: Flushing usage events
[0m19:34:16.175483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10246a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c8fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c8f790>]}


============================== 19:34:16.178367 | da106a93-55b5-4b38-8bc2-358102925d6a ==============================
[0m19:34:16.178367 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:34:16.178640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:34:16.318433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da106a93-55b5-4b38-8bc2-358102925d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024ebeb0>]}
[0m19:34:16.339301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da106a93-55b5-4b38-8bc2-358102925d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d60ca0>]}
[0m19:34:16.339732 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:34:16.347753 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:34:16.416352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:16.416728 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/schema.yml
[0m19:34:16.488573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da106a93-55b5-4b38-8bc2-358102925d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dba950>]}
[0m19:34:16.540213 [error] [MainThread]: Encountered an error:
Compilation Error
  'test.jaffle_shop.unique_orders_order_id.fed79b3a6e' depends on 'seed.jaffle_shop.orders' which is not in the graph!
[0m19:34:16.542204 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.40101215, "process_user_time": 0.757797, "process_kernel_time": 0.093234, "process_mem_max_rss": "115245056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:34:16.542505 [debug] [MainThread]: Command `dbt seed` failed at 19:34:16.542462 after 0.40 seconds
[0m19:34:16.542694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10246a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409b640>]}
[0m19:34:16.542858 [debug] [MainThread]: Flushing usage events
[0m19:34:32.772964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105177ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105177820>]}


============================== 19:34:32.775781 | 3a3bc129-6227-4e37-9a17-aba666ff64e2 ==============================
[0m19:34:32.775781 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:34:32.776053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'version_check': 'True', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:34:32.912870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513aaa0>]}
[0m19:34:32.934245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105245270>]}
[0m19:34:32.934793 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:34:32.942478 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:34:33.014048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:33.014456 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/schema.yml
[0m19:34:33.039578 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:34:33.039844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a3760>]}
[0m19:34:33.135463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105999870>]}
[0m19:34:33.188152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059286d0>]}
[0m19:34:33.188408 [info ] [MainThread]: Found 11 models, 16 data tests, 9 seeds, 421 macros
[0m19:34:33.188579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566a770>]}
[0m19:34:33.189445 [info ] [MainThread]: 
[0m19:34:33.189694 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:34:33.192322 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m19:34:33.218494 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m19:34:33.218721 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m19:34:33.218860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:33.235288 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m19:34:33.236291 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m19:34:33.237138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m19:34:33.237377 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m19:34:33.240515 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:34:33.240665 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m19:34:33.240778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:33.242958 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:34:33.243483 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:34:33.243611 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m19:34:33.243754 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:34:33.243871 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:34:33.243988 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m19:34:33.244635 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:34:33.244962 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m19:34:33.245089 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:34:33.245209 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m19:34:33.245354 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:34:33.245477 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m19:34:33.246735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m19:34:33.249128 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m19:34:33.249258 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m19:34:33.249364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:33.251034 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:34:33.251175 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m19:34:33.251306 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m19:34:33.264584 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m19:34:33.265114 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m19:34:33.265628 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m19:34:33.265771 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m19:34:33.266437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522baf0>]}
[0m19:34:33.266667 [debug] [MainThread]: Using duckdb connection "master"
[0m19:34:33.266799 [debug] [MainThread]: On master: BEGIN
[0m19:34:33.266918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:33.268731 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:34:33.268867 [debug] [MainThread]: On master: COMMIT
[0m19:34:33.268988 [debug] [MainThread]: Using duckdb connection "master"
[0m19:34:33.269103 [debug] [MainThread]: On master: COMMIT
[0m19:34:33.269242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:34:33.269363 [debug] [MainThread]: On master: Close
[0m19:34:33.269791 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m19:34:33.269953 [info ] [MainThread]: 
[0m19:34:33.271818 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m19:34:33.271993 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_inventory
[0m19:34:33.272175 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_inventory_transactions
[0m19:34:33.272335 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_order_details
[0m19:34:33.272502 [debug] [Thread-5 (]: Began running node seed.jaffle_shop.raw_orders
[0m19:34:33.272642 [debug] [Thread-6 (]: Began running node seed.jaffle_shop.raw_payments
[0m19:34:33.272987 [debug] [Thread-7 (]: Began running node seed.jaffle_shop.raw_products
[0m19:34:33.272855 [info ] [Thread-1 (]: 1 of 9 START seed file main.raw_customers ...................................... [RUN]
[0m19:34:33.273211 [debug] [Thread-8 (]: Began running node seed.jaffle_shop.raw_supplier_products
[0m19:34:33.273398 [debug] [Thread-9 (]: Began running node seed.jaffle_shop.raw_suppliers
[0m19:34:33.273609 [info ] [Thread-2 (]: 2 of 9 START seed file main.raw_inventory ...................................... [RUN]
[0m19:34:33.273830 [info ] [Thread-3 (]: 3 of 9 START seed file main.raw_inventory_transactions ......................... [RUN]
[0m19:34:33.274074 [info ] [Thread-4 (]: 4 of 9 START seed file main.raw_order_details .................................. [RUN]
[0m19:34:33.274326 [info ] [Thread-5 (]: 5 of 9 START seed file main.raw_orders ......................................... [RUN]
[0m19:34:33.274549 [info ] [Thread-6 (]: 6 of 9 START seed file main.raw_payments ....................................... [RUN]
[0m19:34:33.274771 [info ] [Thread-7 (]: 7 of 9 START seed file main.raw_products ....................................... [RUN]
[0m19:34:33.275003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now seed.jaffle_shop.raw_customers)
[0m19:34:33.275205 [info ] [Thread-8 (]: 8 of 9 START seed file main.raw_supplier_products .............................. [RUN]
[0m19:34:33.275453 [info ] [Thread-9 (]: 9 of 9 START seed file main.raw_suppliers ...................................... [RUN]
[0m19:34:33.275684 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory'
[0m19:34:33.275894 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory_transactions'
[0m19:34:33.276094 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_order_details'
[0m19:34:33.276312 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m19:34:33.276523 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_payments'
[0m19:34:33.276727 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_products'
[0m19:34:33.276893 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m19:34:33.277092 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_supplier_products'
[0m19:34:33.277273 [debug] [Thread-9 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_suppliers'
[0m19:34:33.277422 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_inventory
[0m19:34:33.277567 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_inventory_transactions
[0m19:34:33.277707 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_order_details
[0m19:34:33.277842 [debug] [Thread-5 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m19:34:33.277987 [debug] [Thread-6 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m19:34:33.278133 [debug] [Thread-7 (]: Began compiling node seed.jaffle_shop.raw_products
[0m19:34:33.278293 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m19:34:33.278444 [debug] [Thread-8 (]: Began compiling node seed.jaffle_shop.raw_supplier_products
[0m19:34:33.278582 [debug] [Thread-9 (]: Began compiling node seed.jaffle_shop.raw_suppliers
[0m19:34:33.278721 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_inventory
[0m19:34:33.278861 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_inventory_transactions
[0m19:34:33.278999 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_order_details
[0m19:34:33.279139 [debug] [Thread-5 (]: Began executing node seed.jaffle_shop.raw_orders
[0m19:34:33.279285 [debug] [Thread-6 (]: Began executing node seed.jaffle_shop.raw_payments
[0m19:34:33.279431 [debug] [Thread-7 (]: Began executing node seed.jaffle_shop.raw_products
[0m19:34:33.293192 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:34:33.293356 [debug] [Thread-8 (]: Began executing node seed.jaffle_shop.raw_supplier_products
[0m19:34:33.293499 [debug] [Thread-9 (]: Began executing node seed.jaffle_shop.raw_suppliers
[0m19:34:33.318625 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:34:33.322209 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:34:33.325470 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:34:33.329868 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:34:33.332182 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:34:33.332371 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m19:34:33.336129 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:34:33.336316 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: BEGIN
[0m19:34:33.337327 [debug] [Thread-9 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:34:33.337513 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: BEGIN
[0m19:34:33.337728 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: BEGIN
[0m19:34:33.337886 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m19:34:33.338044 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: BEGIN
[0m19:34:33.338240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:33.338417 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: BEGIN
[0m19:34:33.338610 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:34:33.338771 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: BEGIN
[0m19:34:33.338970 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:34:33.339206 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:34:33.339362 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m19:34:33.339507 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:34:33.341441 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m19:34:33.341620 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:34:33.341849 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m19:34:33.342064 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m19:34:33.342277 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:34:33.342438 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:34:33.342685 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m19:34:33.342819 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m19:34:33.343009 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.343149 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:34:33.343363 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:34:33.343511 [debug] [Thread-9 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.343652 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:34:33.343890 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:34:33.344049 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:34:33.344196 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:34:33.344509 [debug] [Thread-6 (]: Compilation Error in seed raw_payments (seeds/raw_payments.csv)
  value was undefined because a callable raised a StopIteration exception
[0m19:34:33.344665 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:34:33.344815 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "jaffle_shop"."main"."raw_customers" ("customer_id" integer,"first_name" text,"last_name" text,"email" text,"created_at" timestamp without time zone)
  
[0m19:34:33.344978 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory"} */

    create table "jaffle_shop"."main"."raw_inventory" ("product_id" integer,"quantity" integer,"last_updated" timestamp without time zone)
  
[0m19:34:33.345130 [debug] [Thread-9 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:34:33.345283 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory_transactions"} */

    create table "jaffle_shop"."main"."raw_inventory_transactions" ("transaction_id" integer,"product_id" integer,"quantity_change" integer,"transaction_date" timestamp without time zone,"reason" text)
  
[0m19:34:33.345447 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_order_details"} */

    create table "jaffle_shop"."main"."raw_order_details" ("order_id" integer,"product_id" integer,"quantity" integer,"unit_price" float8,"line_total" float8)
  
[0m19:34:33.345609 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "jaffle_shop"."main"."raw_orders" ("order_id" integer,"customer_id" integer,"order_date" timestamp without time zone,"total_amount" float8)
  
[0m19:34:33.345771 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_products"} */

    create table "jaffle_shop"."main"."raw_products" ("product_id" integer,"product_name" text,"category" text,"price" float8,"created_at" timestamp without time zone)
  
[0m19:34:33.346497 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522bf10>]}
[0m19:34:33.346670 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_supplier_products"} */

    create table "jaffle_shop"."main"."raw_supplier_products" ("supplier_id" integer,"product_id" integer)
  
[0m19:34:33.346886 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_suppliers"} */

    create table "jaffle_shop"."main"."raw_suppliers" ("supplier_id" integer,"supplier_name" text,"contact_email" text,"phone_number" text)
  
[0m19:34:33.347230 [error] [Thread-6 (]: 6 of 9 ERROR loading seed file main.raw_payments ............................... [[31mERROR[0m in 0.07s]
[0m19:34:33.347612 [debug] [Thread-6 (]: Finished running node seed.jaffle_shop.raw_payments
[0m19:34:33.348316 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m19:34:33.348463 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.348635 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.348787 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.353833 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:34:33.353991 [debug] [Thread-9 (]: SQL status: OK in 0.006 seconds
[0m19:34:33.354124 [debug] [Thread-5 (]: SQL status: OK in 0.007 seconds
[0m19:34:33.354267 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m19:34:33.354412 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m19:34:33.354916 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:34:33.355377 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:34:33.355854 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:34:33.356025 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: 
          COPY "jaffle_shop"."main"."raw_supplier_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_supplier_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:34:33.356507 [debug] [Thread-9 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:34:33.356966 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:34:33.357467 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:34:33.357927 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:34:33.358096 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          COPY "jaffle_shop"."main"."raw_customers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:34:33.358260 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: 
          COPY "jaffle_shop"."main"."raw_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:34:33.358420 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: 
          COPY "jaffle_shop"."main"."raw_inventory" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:34:33.358599 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: 
          COPY "jaffle_shop"."main"."raw_suppliers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:34:33.358758 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: 
          COPY "jaffle_shop"."main"."raw_orders" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:34:33.358907 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: 
          COPY "jaffle_shop"."main"."raw_order_details" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:34:33.359058 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: 
          COPY "jaffle_shop"."main"."raw_inventory_transactions" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:34:33.364166 [debug] [Thread-9 (]: SQL status: OK in 0.005 seconds
[0m19:34:33.367033 [debug] [Thread-9 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_suppliers"
[0m19:34:33.367220 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m19:34:33.367375 [debug] [Thread-8 (]: SQL status: OK in 0.009 seconds
[0m19:34:33.367587 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:34:33.367747 [debug] [Thread-5 (]: SQL status: OK in 0.008 seconds
[0m19:34:33.367891 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m19:34:33.368051 [debug] [Thread-7 (]: SQL status: OK in 0.009 seconds
[0m19:34:33.368216 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m19:34:33.368511 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_order_details"
[0m19:34:33.368779 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_supplier_products"
[0m19:34:33.369072 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m19:34:33.369365 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m19:34:33.369662 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory"
[0m19:34:33.369950 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_products"
[0m19:34:33.370221 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory_transactions"
[0m19:34:33.378202 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m19:34:33.379108 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m19:34:33.379829 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m19:34:33.380517 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m19:34:33.381200 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m19:34:33.381933 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m19:34:33.382076 [debug] [Thread-9 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:34:33.382787 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m19:34:33.382945 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:34:33.383584 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m19:34:33.383731 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:34:33.383877 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:34:33.384028 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:34:33.384182 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:34:33.384326 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m19:34:33.384467 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:34:33.384610 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m19:34:33.384758 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:34:33.384908 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m19:34:33.385115 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m19:34:33.385272 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m19:34:33.385417 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m19:34:33.385593 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m19:34:33.385810 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m19:34:33.387010 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:34:33.387162 [debug] [Thread-9 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.387304 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.388098 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: Close
[0m19:34:33.388240 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:34:33.388375 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.388514 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.388638 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m19:34:33.388784 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m19:34:33.389074 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: Close
[0m19:34:33.389386 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: Close
[0m19:34:33.389626 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbe890>]}
[0m19:34:33.389955 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: Close
[0m19:34:33.390246 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m19:34:33.390530 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: Close
[0m19:34:33.390813 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: Close
[0m19:34:33.391091 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: Close
[0m19:34:33.391291 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea0a30>]}
[0m19:34:33.391501 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea0ac0>]}
[0m19:34:33.391737 [info ] [Thread-4 (]: 4 of 9 OK loaded seed file main.raw_order_details .............................. [[32mINSERT 100[0m in 0.11s]
[0m19:34:33.391966 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbc940>]}
[0m19:34:33.392169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbc280>]}
[0m19:34:33.392370 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbcee0>]}
[0m19:34:33.392566 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbe620>]}
[0m19:34:33.399425 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3bc129-6227-4e37-9a17-aba666ff64e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea06a0>]}
[0m19:34:33.399679 [info ] [Thread-9 (]: 9 of 9 OK loaded seed file main.raw_suppliers .................................. [[32mINSERT 100[0m in 0.11s]
[0m19:34:33.399932 [info ] [Thread-8 (]: 8 of 9 OK loaded seed file main.raw_supplier_products .......................... [[32mINSERT 100[0m in 0.11s]
[0m19:34:33.400222 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_order_details
[0m19:34:33.400454 [info ] [Thread-3 (]: 3 of 9 OK loaded seed file main.raw_inventory_transactions ..................... [[32mINSERT 100[0m in 0.12s]
[0m19:34:33.400688 [info ] [Thread-1 (]: 1 of 9 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.12s]
[0m19:34:33.400905 [info ] [Thread-2 (]: 2 of 9 OK loaded seed file main.raw_inventory .................................. [[32mINSERT 100[0m in 0.12s]
[0m19:34:33.401116 [info ] [Thread-5 (]: 5 of 9 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 100[0m in 0.12s]
[0m19:34:33.401350 [info ] [Thread-7 (]: 7 of 9 OK loaded seed file main.raw_products ................................... [[32mINSERT 100[0m in 0.12s]
[0m19:34:33.401608 [debug] [Thread-9 (]: Finished running node seed.jaffle_shop.raw_suppliers
[0m19:34:33.401851 [debug] [Thread-8 (]: Finished running node seed.jaffle_shop.raw_supplier_products
[0m19:34:33.402178 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_inventory_transactions
[0m19:34:33.402398 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m19:34:33.402624 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_inventory
[0m19:34:33.402844 [debug] [Thread-5 (]: Finished running node seed.jaffle_shop.raw_orders
[0m19:34:33.403070 [debug] [Thread-7 (]: Finished running node seed.jaffle_shop.raw_products
[0m19:34:33.404074 [debug] [MainThread]: Using duckdb connection "master"
[0m19:34:33.404214 [debug] [MainThread]: On master: BEGIN
[0m19:34:33.404336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:33.406353 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:34:33.406498 [debug] [MainThread]: On master: COMMIT
[0m19:34:33.406622 [debug] [MainThread]: Using duckdb connection "master"
[0m19:34:33.406740 [debug] [MainThread]: On master: COMMIT
[0m19:34:33.406882 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:34:33.407006 [debug] [MainThread]: On master: Close
[0m19:34:33.407437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:33.407572 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m19:34:33.407690 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory' was properly closed.
[0m19:34:33.407799 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory_transactions' was properly closed.
[0m19:34:33.407909 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_order_details' was properly closed.
[0m19:34:33.408015 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m19:34:33.408124 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m19:34:33.408239 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_products' was properly closed.
[0m19:34:33.408342 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_supplier_products' was properly closed.
[0m19:34:33.408445 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_suppliers' was properly closed.
[0m19:34:33.408669 [info ] [MainThread]: 
[0m19:34:33.408820 [info ] [MainThread]: Finished running 9 seeds in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m19:34:33.409583 [debug] [MainThread]: Command end result
[0m19:34:33.426396 [info ] [MainThread]: 
[0m19:34:33.426600 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:34:33.426734 [info ] [MainThread]: 
[0m19:34:33.426894 [error] [MainThread]:   Compilation Error in seed raw_payments (seeds/raw_payments.csv)
  value was undefined because a callable raised a StopIteration exception
[0m19:34:33.427026 [info ] [MainThread]: 
[0m19:34:33.427160 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:34:33.428610 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.68505543, "process_user_time": 1.044839, "process_kernel_time": 0.142471, "process_mem_max_rss": "148848640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:34:33.428884 [debug] [MainThread]: Command `dbt seed` failed at 19:34:33.428838 after 0.69 seconds
[0m19:34:33.429098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610bdf0>]}
[0m19:34:33.429258 [debug] [MainThread]: Flushing usage events
[0m19:41:37.581325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072228c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b77e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b77790>]}


============================== 19:41:37.584815 | 91275554-2ae8-4eb4-838f-4c7a3336492b ==============================
[0m19:41:37.584815 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:41:37.585072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'version_check': 'True', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:41:38.135986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729feb0>]}
[0m19:41:38.156715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e08ca0>]}
[0m19:41:38.157276 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:41:38.167014 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:41:38.238081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:41:38.238602 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/schema.yml
[0m19:41:38.334049 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:41:38.334345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d25f0>]}
[0m19:41:38.341426 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'suppliers' in the 'models' section of file 'models/schema.yml'
[0m19:41:38.342223 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'inventory_transactions' in the 'models' section of file 'models/schema.yml'
[0m19:41:38.343138 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'order_details' in the 'models' section of file 'models/schema.yml'
[0m19:41:38.343572 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'supplier_products' in the 'models' section of file 'models/schema.yml'
[0m19:41:38.344223 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'models' section of file 'models/schema.yml'
[0m19:41:38.344637 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'inventory' in the 'models' section of file 'models/schema.yml'
[0m19:41:38.418395 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_suppliers_supplier_id.9d48f48499' (models/schema.yml) depends on a node named 'suppliers' in package '' which was not found
[0m19:41:38.418662 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_suppliers_supplier_id.5646214577' (models/schema.yml) depends on a node named 'suppliers' in package '' which was not found
[0m19:41:38.418836 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_suppliers_contact_email.4350df4861' (models/schema.yml) depends on a node named 'suppliers' in package '' which was not found
[0m19:41:38.418987 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_inventory_transactions_transaction_id.503c168033' (models/schema.yml) depends on a node named 'inventory_transactions' in package '' which was not found
[0m19:41:38.419139 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_inventory_transactions_transaction_id.75ce9e839a' (models/schema.yml) depends on a node named 'inventory_transactions' in package '' which was not found
[0m19:41:38.419281 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_inventory_transactions_product_id.21643f22ac' (models/schema.yml) depends on a node named 'inventory_transactions' in package '' which was not found
[0m19:41:38.419421 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_inventory_transactions_product_id__product_id__ref_products_.7977d9239d' (models/schema.yml) depends on a node named 'products' in package '' which was not found
[0m19:41:38.419568 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_inventory_transactions_product_id__product_id__ref_products_.7977d9239d' (models/schema.yml) depends on a node named 'inventory_transactions' in package '' which was not found
[0m19:41:38.419714 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_inventory_transactions_transaction_date.247a299c02' (models/schema.yml) depends on a node named 'inventory_transactions' in package '' which was not found
[0m19:41:38.419860 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_order_details_order_id.4cea316ac4' (models/schema.yml) depends on a node named 'order_details' in package '' which was not found
[0m19:41:38.420011 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_order_details_order_id__order_id__ref_orders_.acb95eb1e2' (models/schema.yml) depends on a node named 'order_details' in package '' which was not found
[0m19:41:38.420157 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_order_details_product_id.2adb1e0c81' (models/schema.yml) depends on a node named 'order_details' in package '' which was not found
[0m19:41:38.420295 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_order_details_product_id__product_id__ref_products_.f51943e87e' (models/schema.yml) depends on a node named 'products' in package '' which was not found
[0m19:41:38.420434 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_order_details_product_id__product_id__ref_products_.f51943e87e' (models/schema.yml) depends on a node named 'order_details' in package '' which was not found
[0m19:41:38.420573 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_order_details_quantity.239eae7b89' (models/schema.yml) depends on a node named 'order_details' in package '' which was not found
[0m19:41:38.420720 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_order_details_unit_price.4b4ac959fe' (models/schema.yml) depends on a node named 'order_details' in package '' which was not found
[0m19:41:38.420860 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_order_details_line_total.708019f75c' (models/schema.yml) depends on a node named 'order_details' in package '' which was not found
[0m19:41:38.420998 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_supplier_products_supplier_id.b28665170d' (models/schema.yml) depends on a node named 'supplier_products' in package '' which was not found
[0m19:41:38.421534 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_supplier_products_supplier_id__supplier_id__ref_suppliers_.1fb0112d16' (models/schema.yml) depends on a node named 'suppliers' in package '' which was not found
[0m19:41:38.421673 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_supplier_products_supplier_id__supplier_id__ref_suppliers_.1fb0112d16' (models/schema.yml) depends on a node named 'supplier_products' in package '' which was not found
[0m19:41:38.421811 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_supplier_products_product_id.95ec3e5014' (models/schema.yml) depends on a node named 'supplier_products' in package '' which was not found
[0m19:41:38.421953 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_supplier_products_product_id__product_id__ref_products_.a0535d9cd4' (models/schema.yml) depends on a node named 'products' in package '' which was not found
[0m19:41:38.422091 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_supplier_products_product_id__product_id__ref_products_.a0535d9cd4' (models/schema.yml) depends on a node named 'supplier_products' in package '' which was not found
[0m19:41:38.422232 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_products_product_id.33741cf88e' (models/schema.yml) depends on a node named 'products' in package '' which was not found
[0m19:41:38.422374 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_products_product_id.68edffb83d' (models/schema.yml) depends on a node named 'products' in package '' which was not found
[0m19:41:38.422510 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_products_product_name.48f06f984e' (models/schema.yml) depends on a node named 'products' in package '' which was not found
[0m19:41:38.422648 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_products_price.3b5b0a69be' (models/schema.yml) depends on a node named 'products' in package '' which was not found
[0m19:41:38.422790 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_inventory_product_id.d054049864' (models/schema.yml) depends on a node named 'inventory' in package '' which was not found
[0m19:41:38.422923 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_inventory_product_id.73f4977e89' (models/schema.yml) depends on a node named 'inventory' in package '' which was not found
[0m19:41:38.423067 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_inventory_product_id__product_id__ref_products_.48f362a959' (models/schema.yml) depends on a node named 'products' in package '' which was not found
[0m19:41:38.423204 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_inventory_product_id__product_id__ref_products_.48f362a959' (models/schema.yml) depends on a node named 'inventory' in package '' which was not found
[0m19:41:38.423341 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_inventory_quantity.37d83b12f4' (models/schema.yml) depends on a node named 'inventory' in package '' which was not found
[0m19:41:38.451406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10962dd50>]}
[0m19:41:38.527128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bc1c0>]}
[0m19:41:38.527404 [info ] [MainThread]: Found 11 models, 18 data tests, 9 seeds, 421 macros
[0m19:41:38.527572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bc490>]}
[0m19:41:38.528584 [info ] [MainThread]: 
[0m19:41:38.528877 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:41:38.531404 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m19:41:38.555816 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m19:41:38.556006 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m19:41:38.556123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:38.560270 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:41:38.560819 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m19:41:38.561510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m19:41:38.561709 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m19:41:38.564599 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:41:38.564733 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m19:41:38.564848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:38.566765 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:41:38.567238 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:41:38.567351 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m19:41:38.567481 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:41:38.567598 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:41:38.567714 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m19:41:38.567901 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:41:38.568207 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m19:41:38.568323 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:41:38.568428 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m19:41:38.568552 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:41:38.568670 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m19:41:38.569968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m19:41:38.572499 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m19:41:38.572621 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m19:41:38.572724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:38.574401 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:41:38.574515 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m19:41:38.574634 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m19:41:38.582361 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:41:38.584172 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m19:41:38.584742 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m19:41:38.584888 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m19:41:38.585978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b75360>]}
[0m19:41:38.586176 [debug] [MainThread]: Using duckdb connection "master"
[0m19:41:38.586301 [debug] [MainThread]: On master: BEGIN
[0m19:41:38.586407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:38.588228 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:41:38.588363 [debug] [MainThread]: On master: COMMIT
[0m19:41:38.588482 [debug] [MainThread]: Using duckdb connection "master"
[0m19:41:38.588593 [debug] [MainThread]: On master: COMMIT
[0m19:41:38.588720 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:41:38.588837 [debug] [MainThread]: On master: Close
[0m19:41:38.589265 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m19:41:38.589435 [info ] [MainThread]: 
[0m19:41:38.591097 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m19:41:38.591279 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_inventory
[0m19:41:38.591449 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_inventory_transactions
[0m19:41:38.591800 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_order_details
[0m19:41:38.591667 [info ] [Thread-1 (]: 1 of 9 START seed file main.raw_customers ...................................... [RUN]
[0m19:41:38.591990 [debug] [Thread-5 (]: Began running node seed.jaffle_shop.raw_orders
[0m19:41:38.592133 [debug] [Thread-6 (]: Began running node seed.jaffle_shop.raw_payments
[0m19:41:38.592281 [debug] [Thread-7 (]: Began running node seed.jaffle_shop.raw_products
[0m19:41:38.592431 [debug] [Thread-8 (]: Began running node seed.jaffle_shop.raw_supplier_products
[0m19:41:38.592741 [debug] [Thread-9 (]: Began running node seed.jaffle_shop.raw_suppliers
[0m19:41:38.592615 [info ] [Thread-2 (]: 2 of 9 START seed file main.raw_inventory ...................................... [RUN]
[0m19:41:38.592998 [info ] [Thread-3 (]: 3 of 9 START seed file main.raw_inventory_transactions ......................... [RUN]
[0m19:41:38.593218 [info ] [Thread-4 (]: 4 of 9 START seed file main.raw_order_details .................................. [RUN]
[0m19:41:38.593418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now seed.jaffle_shop.raw_customers)
[0m19:41:38.593606 [info ] [Thread-5 (]: 5 of 9 START seed file main.raw_orders ......................................... [RUN]
[0m19:41:38.593817 [info ] [Thread-6 (]: 6 of 9 START seed file main.raw_payments ....................................... [RUN]
[0m19:41:38.594034 [info ] [Thread-7 (]: 7 of 9 START seed file main.raw_products ....................................... [RUN]
[0m19:41:38.594245 [info ] [Thread-8 (]: 8 of 9 START seed file main.raw_supplier_products .............................. [RUN]
[0m19:41:38.594453 [info ] [Thread-9 (]: 9 of 9 START seed file main.raw_suppliers ...................................... [RUN]
[0m19:41:38.594680 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory'
[0m19:41:38.594916 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory_transactions'
[0m19:41:38.595131 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_order_details'
[0m19:41:38.595282 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m19:41:38.595461 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m19:41:38.595653 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_payments'
[0m19:41:38.595857 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_products'
[0m19:41:38.596041 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_supplier_products'
[0m19:41:38.596223 [debug] [Thread-9 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_suppliers'
[0m19:41:38.596368 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_inventory
[0m19:41:38.596525 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_inventory_transactions
[0m19:41:38.596671 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_order_details
[0m19:41:38.596817 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m19:41:38.596954 [debug] [Thread-5 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m19:41:38.597090 [debug] [Thread-6 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m19:41:38.597235 [debug] [Thread-7 (]: Began compiling node seed.jaffle_shop.raw_products
[0m19:41:38.597376 [debug] [Thread-8 (]: Began compiling node seed.jaffle_shop.raw_supplier_products
[0m19:41:38.597513 [debug] [Thread-9 (]: Began compiling node seed.jaffle_shop.raw_suppliers
[0m19:41:38.597656 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_inventory
[0m19:41:38.597807 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_inventory_transactions
[0m19:41:38.597956 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_order_details
[0m19:41:38.605028 [debug] [Thread-5 (]: Began executing node seed.jaffle_shop.raw_orders
[0m19:41:38.612090 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:41:38.612276 [debug] [Thread-6 (]: Began executing node seed.jaffle_shop.raw_payments
[0m19:41:38.612436 [debug] [Thread-7 (]: Began executing node seed.jaffle_shop.raw_products
[0m19:41:38.612581 [debug] [Thread-8 (]: Began executing node seed.jaffle_shop.raw_supplier_products
[0m19:41:38.612720 [debug] [Thread-9 (]: Began executing node seed.jaffle_shop.raw_suppliers
[0m19:41:38.618255 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:41:38.621819 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:41:38.624120 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:41:38.625233 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m19:41:38.628243 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:41:38.632900 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:41:38.635161 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: BEGIN
[0m19:41:38.635423 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: BEGIN
[0m19:41:38.637023 [debug] [Thread-9 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:41:38.638567 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:41:38.638732 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: BEGIN
[0m19:41:38.638887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:38.639105 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m19:41:38.639299 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: BEGIN
[0m19:41:38.639477 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:41:38.639646 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:41:38.639823 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: BEGIN
[0m19:41:38.639982 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: BEGIN
[0m19:41:38.640135 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:41:38.642245 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m19:41:38.642410 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m19:41:38.642576 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:41:38.642822 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m19:41:38.642964 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:41:38.643192 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m19:41:38.643328 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m19:41:38.643543 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:41:38.643699 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:41:38.643884 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m19:41:38.644200 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:41:38.644338 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m19:41:38.644503 [debug] [Thread-9 (]: SQL status: OK in 0.002 seconds
[0m19:41:38.644661 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:41:38.644900 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:41:38.645045 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m19:41:38.645201 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "jaffle_shop"."main"."raw_customers"
[0m19:41:38.645352 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:41:38.645545 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory_transactions"} */
truncate table "jaffle_shop"."main"."raw_inventory_transactions"
[0m19:41:38.645730 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:41:38.645871 [debug] [Thread-9 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:41:38.646020 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory"} */
truncate table "jaffle_shop"."main"."raw_inventory"
[0m19:41:38.646233 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_order_details"} */
truncate table "jaffle_shop"."main"."raw_order_details"
[0m19:41:38.646410 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:41:38.646599 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "jaffle_shop"."main"."raw_orders"
[0m19:41:38.646933 [debug] [Thread-6 (]: Compilation Error in seed raw_payments (seeds/raw_payments.csv)
  value was undefined because a callable raised a StopIteration exception
[0m19:41:38.647084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.647235 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_products"} */
truncate table "jaffle_shop"."main"."raw_products"
[0m19:41:38.647394 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:41:38.647538 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_suppliers"} */
truncate table "jaffle_shop"."main"."raw_suppliers"
[0m19:41:38.647752 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_supplier_products"} */
truncate table "jaffle_shop"."main"."raw_supplier_products"
[0m19:41:38.647909 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:41:38.648060 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:41:38.648767 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb03a0>]}
[0m19:41:38.648917 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.653977 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:41:38.654526 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:41:38.655097 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:41:38.655248 [debug] [Thread-9 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.655392 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.655872 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:41:38.656003 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.656213 [error] [Thread-6 (]: 6 of 9 ERROR loading seed file main.raw_payments ............................... [[31mERROR[0m in 0.05s]
[0m19:41:38.656700 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:41:38.656848 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          COPY "jaffle_shop"."main"."raw_customers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:41:38.656996 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: 
          COPY "jaffle_shop"."main"."raw_inventory_transactions" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:41:38.657139 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: 
          COPY "jaffle_shop"."main"."raw_inventory" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:41:38.657558 [debug] [Thread-9 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:41:38.658012 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:41:38.658159 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: 
          COPY "jaffle_shop"."main"."raw_order_details" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:41:38.658578 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:41:38.658800 [debug] [Thread-6 (]: Finished running node seed.jaffle_shop.raw_payments
[0m19:41:38.658943 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: 
          COPY "jaffle_shop"."main"."raw_orders" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:41:38.659181 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: 
          COPY "jaffle_shop"."main"."raw_suppliers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:41:38.659350 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: 
          COPY "jaffle_shop"."main"."raw_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:41:38.659748 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: 
          COPY "jaffle_shop"."main"."raw_supplier_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_supplier_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:41:38.661181 [debug] [Thread-9 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.663923 [debug] [Thread-9 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_suppliers"
[0m19:41:38.664127 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m19:41:38.664303 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m19:41:38.664614 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m19:41:38.665422 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_order_details"
[0m19:41:38.666133 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_supplier_products"
[0m19:41:38.672928 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m19:41:38.673151 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m19:41:38.673448 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory"
[0m19:41:38.673618 [debug] [Thread-7 (]: SQL status: OK in 0.013 seconds
[0m19:41:38.673820 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m19:41:38.674002 [debug] [Thread-5 (]: SQL status: OK in 0.014 seconds
[0m19:41:38.674296 [debug] [Thread-9 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:41:38.674614 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m19:41:38.675241 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m19:41:38.675793 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m19:41:38.676119 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_products"
[0m19:41:38.676405 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory_transactions"
[0m19:41:38.676948 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m19:41:38.677295 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m19:41:38.677455 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m19:41:38.677647 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:41:38.677825 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:41:38.678407 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m19:41:38.678613 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:41:38.679242 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m19:41:38.679827 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m19:41:38.680025 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m19:41:38.680631 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m19:41:38.680775 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m19:41:38.680914 [debug] [Thread-9 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.681060 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:41:38.681206 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m19:41:38.681353 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:41:38.681504 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:41:38.681673 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:41:38.682529 [debug] [Thread-9 (]: On seed.jaffle_shop.raw_suppliers: Close
[0m19:41:38.682673 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.682813 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.682971 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m19:41:38.683154 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m19:41:38.683316 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:41:38.683460 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m19:41:38.683608 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m19:41:38.683839 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092adde0>]}
[0m19:41:38.684144 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_supplier_products: Close
[0m19:41:38.684432 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: Close
[0m19:41:38.684809 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: Close
[0m19:41:38.684955 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:41:38.685099 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m19:41:38.685387 [info ] [Thread-9 (]: 9 of 9 OK loaded seed file main.raw_suppliers .................................. [[32mINSERT 100[0m in 0.09s]
[0m19:41:38.685682 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df4df0>]}
[0m19:41:38.685835 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.685979 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m19:41:38.686167 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ae4a0>]}
[0m19:41:38.686359 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924dba0>]}
[0m19:41:38.686691 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m19:41:38.686985 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_products: Close
[0m19:41:38.687232 [debug] [Thread-9 (]: Finished running node seed.jaffle_shop.raw_suppliers
[0m19:41:38.687457 [info ] [Thread-8 (]: 8 of 9 OK loaded seed file main.raw_supplier_products .......................... [[32mINSERT 100[0m in 0.09s]
[0m19:41:38.687783 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: Close
[0m19:41:38.688077 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: Close
[0m19:41:38.688335 [info ] [Thread-4 (]: 4 of 9 OK loaded seed file main.raw_order_details .............................. [[32mINSERT 100[0m in 0.09s]
[0m19:41:38.688559 [info ] [Thread-2 (]: 2 of 9 OK loaded seed file main.raw_inventory .................................. [[32mINSERT 100[0m in 0.09s]
[0m19:41:38.688805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924fe80>]}
[0m19:41:38.689006 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ac700>]}
[0m19:41:38.689319 [debug] [Thread-8 (]: Finished running node seed.jaffle_shop.raw_supplier_products
[0m19:41:38.689507 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ac5b0>]}
[0m19:41:38.695317 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91275554-2ae8-4eb4-838f-4c7a3336492b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ac880>]}
[0m19:41:38.695594 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_order_details
[0m19:41:38.695823 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_inventory
[0m19:41:38.696045 [info ] [Thread-1 (]: 1 of 9 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.10s]
[0m19:41:38.696272 [info ] [Thread-7 (]: 7 of 9 OK loaded seed file main.raw_products ................................... [[32mINSERT 100[0m in 0.09s]
[0m19:41:38.696541 [info ] [Thread-3 (]: 3 of 9 OK loaded seed file main.raw_inventory_transactions ..................... [[32mINSERT 100[0m in 0.09s]
[0m19:41:38.696754 [info ] [Thread-5 (]: 5 of 9 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 100[0m in 0.10s]
[0m19:41:38.697073 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m19:41:38.697292 [debug] [Thread-7 (]: Finished running node seed.jaffle_shop.raw_products
[0m19:41:38.697504 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_inventory_transactions
[0m19:41:38.697712 [debug] [Thread-5 (]: Finished running node seed.jaffle_shop.raw_orders
[0m19:41:38.698489 [debug] [MainThread]: Using duckdb connection "master"
[0m19:41:38.698624 [debug] [MainThread]: On master: BEGIN
[0m19:41:38.698742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:38.700836 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:41:38.700988 [debug] [MainThread]: On master: COMMIT
[0m19:41:38.701111 [debug] [MainThread]: Using duckdb connection "master"
[0m19:41:38.701225 [debug] [MainThread]: On master: COMMIT
[0m19:41:38.701362 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:41:38.701483 [debug] [MainThread]: On master: Close
[0m19:41:38.701915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:38.702073 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m19:41:38.702195 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory' was properly closed.
[0m19:41:38.702307 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory_transactions' was properly closed.
[0m19:41:38.702536 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_order_details' was properly closed.
[0m19:41:38.702644 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m19:41:38.702750 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m19:41:38.702855 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_products' was properly closed.
[0m19:41:38.702963 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_supplier_products' was properly closed.
[0m19:41:38.703067 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_suppliers' was properly closed.
[0m19:41:38.703227 [info ] [MainThread]: 
[0m19:41:38.703378 [info ] [MainThread]: Finished running 9 seeds in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m19:41:38.704078 [debug] [MainThread]: Command end result
[0m19:41:38.724842 [info ] [MainThread]: 
[0m19:41:38.725059 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:41:38.725179 [info ] [MainThread]: 
[0m19:41:38.725326 [error] [MainThread]:   Compilation Error in seed raw_payments (seeds/raw_payments.csv)
  value was undefined because a callable raised a StopIteration exception
[0m19:41:38.725449 [info ] [MainThread]: 
[0m19:41:38.725578 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:41:38.727396 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.1820769, "process_user_time": 1.150573, "process_kernel_time": 0.132584, "process_mem_max_rss": "158646272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:38.727640 [debug] [MainThread]: Command `dbt seed` failed at 19:41:38.727598 after 1.18 seconds
[0m19:41:38.727824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072228c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107868190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c04790>]}
[0m19:41:38.728019 [debug] [MainThread]: Flushing usage events
[0m19:42:08.634536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103222950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105577fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055778b0>]}


============================== 19:42:08.637349 | 67367f5c-2bca-4ac9-9b53-609573de609b ==============================
[0m19:42:08.637349 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:42:08.637602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:42:08.768604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67367f5c-2bca-4ac9-9b53-609573de609b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10553aad0>]}
[0m19:42:08.789513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67367f5c-2bca-4ac9-9b53-609573de609b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487f430>]}
[0m19:42:08.789934 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:42:08.797518 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:42:08.870195 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m19:42:08.870628 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/raw_payments.csv
[0m19:42:08.968059 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:42:08.968334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '67367f5c-2bca-4ac9-9b53-609573de609b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc7d30>]}
[0m19:42:09.029892 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.stg_payments' (models/staging/stg_payments.sql) depends on a node named 'raw_payments' which was not found
[0m19:42:09.032533 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.42591313, "process_user_time": 0.793005, "process_kernel_time": 0.088202, "process_mem_max_rss": "116277248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:42:09.032831 [debug] [MainThread]: Command `dbt seed` failed at 19:42:09.032785 after 0.43 seconds
[0m19:42:09.033033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103222950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da42b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da5960>]}
[0m19:42:09.033205 [debug] [MainThread]: Flushing usage events
[0m19:42:31.218446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864f850>]}


============================== 19:42:31.221356 | 8c3cb111-706b-4e12-ae02-2e89c3e5e6df ==============================
[0m19:42:31.221356 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:42:31.221647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:42:31.356759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c3cb111-706b-4e12-ae02-2e89c3e5e6df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875b2e0>]}
[0m19:42:31.377792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c3cb111-706b-4e12-ae02-2e89c3e5e6df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087202e0>]}
[0m19:42:31.378264 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:42:31.387376 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:42:31.456462 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m19:42:31.456873 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/staging/stg_payments.sql
[0m19:42:31.457004 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/raw_payments.csv
[0m19:42:31.553031 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:42:31.553355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c3cb111-706b-4e12-ae02-2e89c3e5e6df', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875aad0>]}
[0m19:42:31.559209 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_payments' in the 'models' section of file 'models/staging/schema.yml'
[0m19:42:31.616960 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.customers' (models/customers.sql) depends on a node named 'stg_payments' which was not found
[0m19:42:31.619304 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.42943892, "process_user_time": 0.803981, "process_kernel_time": 0.090774, "process_mem_max_rss": "117719040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:42:31.619766 [debug] [MainThread]: Command `dbt seed` failed at 19:42:31.619702 after 0.43 seconds
[0m19:42:31.620011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae9cc0>]}
[0m19:42:31.620195 [debug] [MainThread]: Flushing usage events
[0m19:42:45.258404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e6860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800b340>]}


============================== 19:42:45.261415 | ac25ea5c-2139-4cf4-91c1-8d8a052cf666 ==============================
[0m19:42:45.261415 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:42:45.261695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m19:42:45.390089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac25ea5c-2139-4cf4-91c1-8d8a052cf666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080dca30>]}
[0m19:42:45.411335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac25ea5c-2139-4cf4-91c1-8d8a052cf666', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080dd300>]}
[0m19:42:45.411880 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:42:45.419661 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:42:45.488423 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
[0m19:42:45.488704 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/raw_payments.csv
[0m19:42:45.488945 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/staging/stg_payments.sql
[0m19:42:45.489082 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m19:42:45.582460 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:42:45.582749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac25ea5c-2139-4cf4-91c1-8d8a052cf666', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ef040>]}
[0m19:42:45.588411 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_payments' in the 'models' section of file 'models/staging/schema.yml'
[0m19:42:45.644108 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.orders' (models/orders.sql) depends on a node named 'stg_payments' which was not found
[0m19:42:45.645845 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.41668367, "process_user_time": 0.785619, "process_kernel_time": 0.085473, "process_mem_max_rss": "117555200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:42:45.646110 [debug] [MainThread]: Command `dbt seed` failed at 19:42:45.646058 after 0.42 seconds
[0m19:42:45.646287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e6860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082835e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a08b0>]}
[0m19:42:45.646435 [debug] [MainThread]: Flushing usage events
[0m19:42:54.541273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104977fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049778b0>]}


============================== 19:42:54.543968 | a7d47772-b7e1-453e-8b6a-e5de9acc2e77 ==============================
[0m19:42:54.543968 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:42:54.544206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m19:42:54.627717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104936ad0>]}
[0m19:42:54.648388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b7f430>]}
[0m19:42:54.648810 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:42:54.655010 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:42:54.726331 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 2 files changed.
[0m19:42:54.726771 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/staging/stg_payments.sql
[0m19:42:54.726915 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/raw_payments.csv
[0m19:42:54.727051 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/orders.sql
[0m19:42:54.727192 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m19:42:54.814487 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:42:54.814769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d18220>]}
[0m19:42:54.820575 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_payments' in the 'models' section of file 'models/staging/schema.yml'
[0m19:42:54.876801 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712' (models/staging/schema.yml) depends on a node named 'stg_payments' in package '' which was not found
[0m19:42:54.877056 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075' (models/staging/schema.yml) depends on a node named 'stg_payments' in package '' which was not found
[0m19:42:54.877208 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278' (models/staging/schema.yml) depends on a node named 'stg_payments' in package '' which was not found
[0m19:42:54.908001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ca2f0>]}
[0m19:42:54.963602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c3b50>]}
[0m19:42:54.963871 [info ] [MainThread]: Found 10 models, 15 data tests, 8 seeds, 421 macros
[0m19:42:54.964016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540d270>]}
[0m19:42:54.964827 [info ] [MainThread]: 
[0m19:42:54.965066 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:42:54.967468 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m19:42:55.014717 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m19:42:55.014927 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m19:42:55.015048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:55.028109 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m19:42:55.028983 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m19:42:55.029707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m19:42:55.029934 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m19:42:55.032909 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:42:55.033059 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m19:42:55.033183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:55.035518 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:42:55.036046 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:42:55.036169 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m19:42:55.036304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:42:55.036416 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:42:55.036534 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m19:42:55.037150 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:42:55.037473 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m19:42:55.037608 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:42:55.037722 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m19:42:55.037861 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:42:55.037984 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m19:42:55.039220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m19:42:55.041714 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m19:42:55.041856 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m19:42:55.041973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:55.043982 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:42:55.044115 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m19:42:55.044247 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m19:42:55.054931 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m19:42:55.057178 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m19:42:55.057677 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m19:42:55.057815 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m19:42:55.058938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d72530>]}
[0m19:42:55.059142 [debug] [MainThread]: Using duckdb connection "master"
[0m19:42:55.059267 [debug] [MainThread]: On master: BEGIN
[0m19:42:55.059373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:42:55.061164 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:42:55.061297 [debug] [MainThread]: On master: COMMIT
[0m19:42:55.061419 [debug] [MainThread]: Using duckdb connection "master"
[0m19:42:55.061532 [debug] [MainThread]: On master: COMMIT
[0m19:42:55.061661 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:42:55.061782 [debug] [MainThread]: On master: Close
[0m19:42:55.062244 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m19:42:55.062401 [info ] [MainThread]: 
[0m19:42:55.064100 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m19:42:55.064273 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_inventory
[0m19:42:55.064450 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_inventory_transactions
[0m19:42:55.064648 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_order_details
[0m19:42:55.064851 [debug] [Thread-5 (]: Began running node seed.jaffle_shop.raw_orders
[0m19:42:55.065080 [info ] [Thread-1 (]: 1 of 8 START seed file main.raw_customers ...................................... [RUN]
[0m19:42:55.065271 [debug] [Thread-6 (]: Began running node seed.jaffle_shop.raw_products
[0m19:42:55.065451 [debug] [Thread-7 (]: Began running node seed.jaffle_shop.raw_supplier_products
[0m19:42:55.065636 [debug] [Thread-8 (]: Began running node seed.jaffle_shop.raw_suppliers
[0m19:42:55.065837 [info ] [Thread-2 (]: 2 of 8 START seed file main.raw_inventory ...................................... [RUN]
[0m19:42:55.066082 [info ] [Thread-3 (]: 3 of 8 START seed file main.raw_inventory_transactions ......................... [RUN]
[0m19:42:55.066321 [info ] [Thread-4 (]: 4 of 8 START seed file main.raw_order_details .................................. [RUN]
[0m19:42:55.066543 [info ] [Thread-5 (]: 5 of 8 START seed file main.raw_orders ......................................... [RUN]
[0m19:42:55.066774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now seed.jaffle_shop.raw_customers)
[0m19:42:55.066973 [info ] [Thread-6 (]: 6 of 8 START seed file main.raw_products ....................................... [RUN]
[0m19:42:55.067183 [info ] [Thread-7 (]: 7 of 8 START seed file main.raw_supplier_products .............................. [RUN]
[0m19:42:55.067397 [info ] [Thread-8 (]: 8 of 8 START seed file main.raw_suppliers ...................................... [RUN]
[0m19:42:55.067620 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory'
[0m19:42:55.067834 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory_transactions'
[0m19:42:55.068030 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_order_details'
[0m19:42:55.068237 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m19:42:55.068389 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m19:42:55.068576 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_products'
[0m19:42:55.068765 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_supplier_products'
[0m19:42:55.068966 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_suppliers'
[0m19:42:55.069116 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_inventory
[0m19:42:55.069265 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_inventory_transactions
[0m19:42:55.069417 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_order_details
[0m19:42:55.069562 [debug] [Thread-5 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m19:42:55.069709 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m19:42:55.069855 [debug] [Thread-6 (]: Began compiling node seed.jaffle_shop.raw_products
[0m19:42:55.070008 [debug] [Thread-7 (]: Began compiling node seed.jaffle_shop.raw_supplier_products
[0m19:42:55.070158 [debug] [Thread-8 (]: Began compiling node seed.jaffle_shop.raw_suppliers
[0m19:42:55.070304 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_inventory
[0m19:42:55.070460 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_inventory_transactions
[0m19:42:55.070614 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_order_details
[0m19:42:55.070766 [debug] [Thread-5 (]: Began executing node seed.jaffle_shop.raw_orders
[0m19:42:55.077855 [debug] [Thread-6 (]: Began executing node seed.jaffle_shop.raw_products
[0m19:42:55.085309 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:42:55.085506 [debug] [Thread-7 (]: Began executing node seed.jaffle_shop.raw_supplier_products
[0m19:42:55.085673 [debug] [Thread-8 (]: Began executing node seed.jaffle_shop.raw_suppliers
[0m19:42:55.091510 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:42:55.095553 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:42:55.098192 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:42:55.100926 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:42:55.102122 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m19:42:55.104629 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:42:55.107098 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: BEGIN
[0m19:42:55.108511 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:42:55.110107 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:42:55.110251 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: BEGIN
[0m19:42:55.110386 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m19:42:55.110519 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: BEGIN
[0m19:42:55.110650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:55.110836 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: BEGIN
[0m19:42:55.110965 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:42:55.111094 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: BEGIN
[0m19:42:55.111223 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: BEGIN
[0m19:42:55.111346 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:42:55.111471 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m19:42:55.111592 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:42:55.113519 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m19:42:55.113675 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:42:55.113865 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m19:42:55.114012 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m19:42:55.114159 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:42:55.114409 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:42:55.114586 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m19:42:55.114794 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:42:55.114938 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:42:55.115069 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m19:42:55.115258 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:42:55.115391 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m19:42:55.115576 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:42:55.115723 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:42:55.115850 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m19:42:55.115992 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "jaffle_shop"."main"."raw_customers"
[0m19:42:55.116136 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:42:55.116272 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:42:55.116413 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory"} */
truncate table "jaffle_shop"."main"."raw_inventory"
[0m19:42:55.116550 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:42:55.116691 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_order_details"} */
truncate table "jaffle_shop"."main"."raw_order_details"
[0m19:42:55.116834 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "jaffle_shop"."main"."raw_orders"
[0m19:42:55.116973 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:42:55.117140 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory_transactions"} */
truncate table "jaffle_shop"."main"."raw_inventory_transactions"
[0m19:42:55.117294 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_products"} */
truncate table "jaffle_shop"."main"."raw_products"
[0m19:42:55.117494 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_suppliers"} */
truncate table "jaffle_shop"."main"."raw_suppliers"
[0m19:42:55.117949 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:42:55.118097 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:42:55.118245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:42:55.118370 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m19:42:55.118501 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_supplier_products"} */
truncate table "jaffle_shop"."main"."raw_supplier_products"
[0m19:42:55.123849 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:42:55.123999 [debug] [Thread-6 (]: SQL status: OK in 0.005 seconds
[0m19:42:55.124135 [debug] [Thread-8 (]: SQL status: OK in 0.005 seconds
[0m19:42:55.124287 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m19:42:55.124791 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:42:55.125285 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:42:55.125738 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:42:55.125917 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: 
          COPY "jaffle_shop"."main"."raw_order_details" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:42:55.126376 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:42:55.126514 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m19:42:55.126931 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:42:55.127380 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:42:55.127538 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: 
          COPY "jaffle_shop"."main"."raw_inventory" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:42:55.127688 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          COPY "jaffle_shop"."main"."raw_customers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:42:55.127839 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: 
          COPY "jaffle_shop"."main"."raw_orders" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:42:55.128022 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: 
          COPY "jaffle_shop"."main"."raw_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:42:55.128498 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:42:55.128666 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: 
          COPY "jaffle_shop"."main"."raw_suppliers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:42:55.128838 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: 
          COPY "jaffle_shop"."main"."raw_inventory_transactions" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:42:55.129238 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: 
          COPY "jaffle_shop"."main"."raw_supplier_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_supplier_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:42:55.131222 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m19:42:55.131624 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m19:42:55.131986 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m19:42:55.134585 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_suppliers"
[0m19:42:55.134950 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_supplier_products"
[0m19:42:55.135264 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_order_details"
[0m19:42:55.135992 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m19:42:55.142699 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m19:42:55.143294 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m19:42:55.143834 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m19:42:55.144033 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m19:42:55.144196 [debug] [Thread-5 (]: SQL status: OK in 0.015 seconds
[0m19:42:55.144369 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m19:42:55.144518 [debug] [Thread-6 (]: SQL status: OK in 0.015 seconds
[0m19:42:55.144778 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory"
[0m19:42:55.144939 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:42:55.145094 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:42:55.145248 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:42:55.145518 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m19:42:55.145771 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m19:42:55.146035 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory_transactions"
[0m19:42:55.146313 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_products"
[0m19:42:55.146516 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m19:42:55.146668 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m19:42:55.146835 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m19:42:55.147560 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m19:42:55.148299 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m19:42:55.148901 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m19:42:55.149531 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m19:42:55.150111 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m19:42:55.150258 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m19:42:55.150451 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:42:55.150614 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m19:42:55.150777 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:42:55.150954 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:42:55.151093 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:42:55.151253 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:42:55.151426 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:42:55.152239 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: Close
[0m19:42:55.152399 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m19:42:55.152714 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: Close
[0m19:42:55.152870 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m19:42:55.153021 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m19:42:55.153311 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: Close
[0m19:42:55.153465 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m19:42:55.153619 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m19:42:55.154273 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa2a70>]}
[0m19:42:55.154521 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105944b20>]}
[0m19:42:55.154698 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:42:55.154926 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd4af0>]}
[0m19:42:55.155147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:42:55.155303 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m19:42:55.155708 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:42:55.155576 [info ] [Thread-8 (]: 8 of 8 OK loaded seed file main.raw_suppliers .................................. [[32mINSERT 100[0m in 0.08s]
[0m19:42:55.155887 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m19:42:55.156105 [info ] [Thread-7 (]: 7 of 8 OK loaded seed file main.raw_supplier_products .......................... [[32mINSERT 100[0m in 0.09s]
[0m19:42:55.156446 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: Close
[0m19:42:55.156656 [info ] [Thread-4 (]: 4 of 8 OK loaded seed file main.raw_order_details .............................. [[32mINSERT 100[0m in 0.09s]
[0m19:42:55.156990 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m19:42:55.157297 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: Close
[0m19:42:55.157593 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: Close
[0m19:42:55.157819 [debug] [Thread-8 (]: Finished running node seed.jaffle_shop.raw_suppliers
[0m19:42:55.158099 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: Close
[0m19:42:55.158325 [debug] [Thread-7 (]: Finished running node seed.jaffle_shop.raw_supplier_products
[0m19:42:55.158530 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd6e00>]}
[0m19:42:55.158751 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_order_details
[0m19:42:55.158943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd7610>]}
[0m19:42:55.159148 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd75e0>]}
[0m19:42:55.159345 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd4dc0>]}
[0m19:42:55.166841 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7d47772-b7e1-453e-8b6a-e5de9acc2e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105979810>]}
[0m19:42:55.167134 [info ] [Thread-2 (]: 2 of 8 OK loaded seed file main.raw_inventory .................................. [[32mINSERT 100[0m in 0.09s]
[0m19:42:55.167430 [info ] [Thread-1 (]: 1 of 8 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.09s]
[0m19:42:55.167649 [info ] [Thread-5 (]: 5 of 8 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 100[0m in 0.09s]
[0m19:42:55.167868 [info ] [Thread-3 (]: 3 of 8 OK loaded seed file main.raw_inventory_transactions ..................... [[32mINSERT 100[0m in 0.09s]
[0m19:42:55.168074 [info ] [Thread-6 (]: 6 of 8 OK loaded seed file main.raw_products ................................... [[32mINSERT 100[0m in 0.10s]
[0m19:42:55.168311 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_inventory
[0m19:42:55.168545 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m19:42:55.168765 [debug] [Thread-5 (]: Finished running node seed.jaffle_shop.raw_orders
[0m19:42:55.168990 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_inventory_transactions
[0m19:42:55.169202 [debug] [Thread-6 (]: Finished running node seed.jaffle_shop.raw_products
[0m19:42:55.170340 [debug] [MainThread]: Using duckdb connection "master"
[0m19:42:55.170520 [debug] [MainThread]: On master: BEGIN
[0m19:42:55.170646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:42:55.172925 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:42:55.173061 [debug] [MainThread]: On master: COMMIT
[0m19:42:55.173182 [debug] [MainThread]: Using duckdb connection "master"
[0m19:42:55.173295 [debug] [MainThread]: On master: COMMIT
[0m19:42:55.173426 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:42:55.173547 [debug] [MainThread]: On master: Close
[0m19:42:55.173944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:55.174061 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m19:42:55.174168 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory' was properly closed.
[0m19:42:55.174273 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory_transactions' was properly closed.
[0m19:42:55.174374 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_order_details' was properly closed.
[0m19:42:55.174473 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m19:42:55.174576 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_products' was properly closed.
[0m19:42:55.174676 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_supplier_products' was properly closed.
[0m19:42:55.174778 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_suppliers' was properly closed.
[0m19:42:55.174927 [info ] [MainThread]: 
[0m19:42:55.175070 [info ] [MainThread]: Finished running 8 seeds in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m19:42:55.175714 [debug] [MainThread]: Command end result
[0m19:42:55.193628 [info ] [MainThread]: 
[0m19:42:55.193873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:42:55.194014 [info ] [MainThread]: 
[0m19:42:55.194159 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:42:55.194911 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.68110543, "process_user_time": 1.086816, "process_kernel_time": 0.111988, "process_mem_max_rss": "160464896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:42:55.195129 [debug] [MainThread]: Command `dbt seed` succeeded at 19:42:55.195089 after 0.68 seconds
[0m19:42:55.195286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c60ca0>]}
[0m19:42:55.195428 [debug] [MainThread]: Flushing usage events
[0m19:52:07.149827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa68c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109677e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109677790>]}


============================== 19:52:07.154863 | 7da46774-9ee8-4010-b33b-4e9486e4c2fc ==============================
[0m19:52:07.154863 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:52:07.155145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:52:07.310730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b27eb0>]}
[0m19:52:07.332443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109908ca0>]}
[0m19:52:07.333062 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m19:52:07.342486 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m19:52:07.419532 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 8 files changed.
[0m19:52:07.419886 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/customers.sql
[0m19:52:07.420043 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/orders.sql
[0m19:52:07.420253 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_customers.sql
[0m19:52:07.420427 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_products.sql
[0m19:52:07.420608 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_orders.sql
[0m19:52:07.420772 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_order_details.sql
[0m19:52:07.420932 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_suppliers.sql
[0m19:52:07.421094 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_inventory_transactions.sql
[0m19:52:07.421252 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_supplier_products.sql
[0m19:52:07.421408 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_inventory.sql
[0m19:52:07.523329 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:52:07.523647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d02710>]}
[0m19:52:07.529681 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customers' in the 'models' section of file 'models/schema.yml'
[0m19:52:07.530754 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'models' section of file 'models/schema.yml'
[0m19:52:07.588572 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d' (models/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m19:52:07.588827 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' (models/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m19:52:07.588982 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_customers_email.da3cfcd534' (models/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m19:52:07.589125 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_customers_created_at.377cb5ef44' (models/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m19:52:07.589262 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_orders_order_id.cf6c17daed' (models/schema.yml) depends on a node named 'orders' in package '' which was not found
[0m19:52:07.589396 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_orders_order_id.fed79b3a6e' (models/schema.yml) depends on a node named 'orders' in package '' which was not found
[0m19:52:07.589533 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_orders_customer_id.c5f02694af' (models/schema.yml) depends on a node named 'orders' in package '' which was not found
[0m19:52:07.589666 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2' (models/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m19:52:07.589800 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2' (models/schema.yml) depends on a node named 'orders' in package '' which was not found
[0m19:52:07.589929 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_orders_order_date.6910a855fe' (models/schema.yml) depends on a node named 'orders' in package '' which was not found
[0m19:52:07.590062 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_orders_total_amount.71e477d61b' (models/schema.yml) depends on a node named 'orders' in package '' which was not found
[0m19:52:07.621829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fab670>]}
[0m19:52:07.679463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a9030>]}
[0m19:52:07.679716 [info ] [MainThread]: Found 8 seeds, 8 models, 5 data tests, 421 macros
[0m19:52:07.679872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a10d540>]}
[0m19:52:07.680747 [info ] [MainThread]: 
[0m19:52:07.681002 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:52:07.683386 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m19:52:07.730450 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m19:52:07.730651 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m19:52:07.730776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:07.743249 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m19:52:07.744116 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m19:52:07.744963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m19:52:07.745151 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m19:52:07.748040 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:52:07.748169 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m19:52:07.748277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:07.750583 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:52:07.751100 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:52:07.751218 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m19:52:07.751360 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:52:07.751478 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:52:07.751596 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m19:52:07.751810 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:52:07.752127 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m19:52:07.752241 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m19:52:07.752342 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m19:52:07.752468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:52:07.752584 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m19:52:07.753775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m19:52:07.756036 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m19:52:07.756155 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m19:52:07.756253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:07.758058 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m19:52:07.758185 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m19:52:07.758314 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m19:52:07.768775 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:52:07.770931 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m19:52:07.771433 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m19:52:07.771560 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m19:52:07.772669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc0eb0>]}
[0m19:52:07.772866 [debug] [MainThread]: Using duckdb connection "master"
[0m19:52:07.772984 [debug] [MainThread]: On master: BEGIN
[0m19:52:07.773088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:07.774881 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:52:07.775014 [debug] [MainThread]: On master: COMMIT
[0m19:52:07.775135 [debug] [MainThread]: Using duckdb connection "master"
[0m19:52:07.775239 [debug] [MainThread]: On master: COMMIT
[0m19:52:07.775361 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:52:07.775479 [debug] [MainThread]: On master: Close
[0m19:52:07.775928 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m19:52:07.776071 [info ] [MainThread]: 
[0m19:52:07.777727 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m19:52:07.777898 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_inventory
[0m19:52:07.778053 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_inventory_transactions
[0m19:52:07.778205 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_order_details
[0m19:52:07.778410 [info ] [Thread-1 (]: 1 of 8 START seed file main.raw_customers ...................................... [RUN]
[0m19:52:07.778616 [debug] [Thread-5 (]: Began running node seed.jaffle_shop.raw_orders
[0m19:52:07.778803 [debug] [Thread-6 (]: Began running node seed.jaffle_shop.raw_products
[0m19:52:07.778948 [debug] [Thread-7 (]: Began running node seed.jaffle_shop.raw_supplier_products
[0m19:52:07.779281 [debug] [Thread-8 (]: Began running node seed.jaffle_shop.raw_suppliers
[0m19:52:07.779127 [info ] [Thread-2 (]: 2 of 8 START seed file main.raw_inventory ...................................... [RUN]
[0m19:52:07.779532 [info ] [Thread-3 (]: 3 of 8 START seed file main.raw_inventory_transactions ......................... [RUN]
[0m19:52:07.779756 [info ] [Thread-4 (]: 4 of 8 START seed file main.raw_order_details .................................. [RUN]
[0m19:52:07.779961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now seed.jaffle_shop.raw_customers)
[0m19:52:07.780160 [info ] [Thread-5 (]: 5 of 8 START seed file main.raw_orders ......................................... [RUN]
[0m19:52:07.780372 [info ] [Thread-6 (]: 6 of 8 START seed file main.raw_products ....................................... [RUN]
[0m19:52:07.780577 [info ] [Thread-7 (]: 7 of 8 START seed file main.raw_supplier_products .............................. [RUN]
[0m19:52:07.780785 [info ] [Thread-8 (]: 8 of 8 START seed file main.raw_suppliers ...................................... [RUN]
[0m19:52:07.781014 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory'
[0m19:52:07.781225 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory_transactions'
[0m19:52:07.781416 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_order_details'
[0m19:52:07.781565 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m19:52:07.781746 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m19:52:07.781936 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_products'
[0m19:52:07.782129 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_supplier_products'
[0m19:52:07.782315 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_suppliers'
[0m19:52:07.782466 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_inventory
[0m19:52:07.782615 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_inventory_transactions
[0m19:52:07.782754 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_order_details
[0m19:52:07.782907 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m19:52:07.783052 [debug] [Thread-5 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m19:52:07.783186 [debug] [Thread-6 (]: Began compiling node seed.jaffle_shop.raw_products
[0m19:52:07.783328 [debug] [Thread-7 (]: Began compiling node seed.jaffle_shop.raw_supplier_products
[0m19:52:07.783468 [debug] [Thread-8 (]: Began compiling node seed.jaffle_shop.raw_suppliers
[0m19:52:07.783610 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_inventory
[0m19:52:07.783753 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_inventory_transactions
[0m19:52:07.783888 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_order_details
[0m19:52:07.791095 [debug] [Thread-5 (]: Began executing node seed.jaffle_shop.raw_orders
[0m19:52:07.798139 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:52:07.798358 [debug] [Thread-6 (]: Began executing node seed.jaffle_shop.raw_products
[0m19:52:07.798503 [debug] [Thread-7 (]: Began executing node seed.jaffle_shop.raw_supplier_products
[0m19:52:07.798638 [debug] [Thread-8 (]: Began executing node seed.jaffle_shop.raw_suppliers
[0m19:52:07.804513 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:52:07.807601 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:52:07.809997 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:52:07.811156 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m19:52:07.813995 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:52:07.819687 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:52:07.819906 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: BEGIN
[0m19:52:07.821332 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:52:07.822820 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:52:07.822979 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: BEGIN
[0m19:52:07.823116 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: BEGIN
[0m19:52:07.823255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:07.823394 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m19:52:07.823526 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: BEGIN
[0m19:52:07.823657 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:52:07.823791 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: BEGIN
[0m19:52:07.823920 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: BEGIN
[0m19:52:07.824049 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:52:07.824175 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:52:07.826163 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m19:52:07.826316 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:52:07.826458 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m19:52:07.826659 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m19:52:07.826807 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:52:07.826940 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m19:52:07.827151 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m19:52:07.827347 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m19:52:07.827539 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:52:07.827678 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m19:52:07.827922 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.828063 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.828196 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:52:07.828375 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:52:07.828507 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m19:52:07.828637 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:52:07.828773 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "jaffle_shop"."main"."raw_customers"
[0m19:52:07.828905 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:52:07.829030 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:52:07.829159 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:52:07.829291 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory_transactions"} */
truncate table "jaffle_shop"."main"."raw_inventory_transactions"
[0m19:52:07.829427 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory"} */
truncate table "jaffle_shop"."main"."raw_inventory"
[0m19:52:07.829556 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:52:07.829685 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_order_details"} */
truncate table "jaffle_shop"."main"."raw_order_details"
[0m19:52:07.829855 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "jaffle_shop"."main"."raw_orders"
[0m19:52:07.830001 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_products"} */
truncate table "jaffle_shop"."main"."raw_products"
[0m19:52:07.830143 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_suppliers"} */
truncate table "jaffle_shop"."main"."raw_suppliers"
[0m19:52:07.830336 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_supplier_products"} */
truncate table "jaffle_shop"."main"."raw_supplier_products"
[0m19:52:07.831437 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.831596 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.831720 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.831833 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m19:52:07.831942 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.832061 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.832183 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:52:07.837330 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:52:07.837476 [debug] [Thread-7 (]: SQL status: OK in 0.007 seconds
[0m19:52:07.837957 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:52:07.838396 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:52:07.838836 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:52:07.839252 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:52:07.839679 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:52:07.840123 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:52:07.840287 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: 
          COPY "jaffle_shop"."main"."raw_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:52:07.840722 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:52:07.840874 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: 
          COPY "jaffle_shop"."main"."raw_orders" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:52:07.841034 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: 
          COPY "jaffle_shop"."main"."raw_inventory" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:52:07.841184 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          COPY "jaffle_shop"."main"."raw_customers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:52:07.841325 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: 
          COPY "jaffle_shop"."main"."raw_order_details" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:52:07.841462 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: 
          COPY "jaffle_shop"."main"."raw_suppliers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:52:07.841605 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: 
          COPY "jaffle_shop"."main"."raw_inventory_transactions" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:52:07.841794 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: 
          COPY "jaffle_shop"."main"."raw_supplier_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_supplier_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:52:07.844426 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m19:52:07.846999 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_supplier_products"
[0m19:52:07.847451 [debug] [Thread-8 (]: SQL status: OK in 0.005 seconds
[0m19:52:07.848330 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_suppliers"
[0m19:52:07.848726 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m19:52:07.854827 [debug] [Thread-5 (]: SQL status: OK in 0.013 seconds
[0m19:52:07.855940 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m19:52:07.856107 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m19:52:07.856296 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m19:52:07.856472 [debug] [Thread-6 (]: SQL status: OK in 0.015 seconds
[0m19:52:07.856730 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_order_details"
[0m19:52:07.856883 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m19:52:07.857165 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m19:52:07.857762 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m19:52:07.857922 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m19:52:07.858210 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory_transactions"
[0m19:52:07.858481 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory"
[0m19:52:07.858743 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_products"
[0m19:52:07.859037 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m19:52:07.859233 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m19:52:07.859392 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m19:52:07.860018 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m19:52:07.860784 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m19:52:07.861446 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m19:52:07.862059 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m19:52:07.862566 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m19:52:07.862695 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m19:52:07.863289 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m19:52:07.863432 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m19:52:07.863606 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m19:52:07.863775 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m19:52:07.863936 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m19:52:07.864110 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m19:52:07.864245 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.864416 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m19:52:07.864578 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m19:52:07.864710 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m19:52:07.864857 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m19:52:07.865004 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m19:52:07.865145 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m19:52:07.865286 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m19:52:07.866082 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: Close
[0m19:52:07.866249 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m19:52:07.866595 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: Close
[0m19:52:07.867183 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.867437 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.867626 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.868333 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce1ff0>]}
[0m19:52:07.868490 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m19:52:07.868638 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m19:52:07.868872 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce1870>]}
[0m19:52:07.869292 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: Close
[0m19:52:07.869433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:52:07.869738 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: Close
[0m19:52:07.870042 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: Close
[0m19:52:07.870270 [info ] [Thread-7 (]: 7 of 8 OK loaded seed file main.raw_supplier_products .......................... [[32mINSERT 100[0m in 0.09s]
[0m19:52:07.870612 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: Close
[0m19:52:07.870896 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: Close
[0m19:52:07.871092 [info ] [Thread-8 (]: 8 of 8 OK loaded seed file main.raw_suppliers .................................. [[32mINSERT 100[0m in 0.09s]
[0m19:52:07.871321 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12e7d0>]}
[0m19:52:07.871621 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m19:52:07.871807 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf6800>]}
[0m19:52:07.871994 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a042e0>]}
[0m19:52:07.872237 [debug] [Thread-7 (]: Finished running node seed.jaffle_shop.raw_supplier_products
[0m19:52:07.872442 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a635330>]}
[0m19:52:07.872631 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a694eb0>]}
[0m19:52:07.872855 [debug] [Thread-8 (]: Finished running node seed.jaffle_shop.raw_suppliers
[0m19:52:07.873045 [info ] [Thread-4 (]: 4 of 8 OK loaded seed file main.raw_order_details .............................. [[32mINSERT 100[0m in 0.09s]
[0m19:52:07.882043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da46774-9ee8-4010-b33b-4e9486e4c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d47790>]}
[0m19:52:07.882345 [info ] [Thread-3 (]: 3 of 8 OK loaded seed file main.raw_inventory_transactions ..................... [[32mINSERT 100[0m in 0.09s]
[0m19:52:07.882531 [info ] [Thread-2 (]: 2 of 8 OK loaded seed file main.raw_inventory .................................. [[32mINSERT 100[0m in 0.09s]
[0m19:52:07.882868 [info ] [Thread-5 (]: 5 of 8 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 100[0m in 0.09s]
[0m19:52:07.883078 [info ] [Thread-6 (]: 6 of 8 OK loaded seed file main.raw_products ................................... [[32mINSERT 100[0m in 0.09s]
[0m19:52:07.883386 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_order_details
[0m19:52:07.883611 [info ] [Thread-1 (]: 1 of 8 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.10s]
[0m19:52:07.883880 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_inventory_transactions
[0m19:52:07.884109 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_inventory
[0m19:52:07.884330 [debug] [Thread-5 (]: Finished running node seed.jaffle_shop.raw_orders
[0m19:52:07.884570 [debug] [Thread-6 (]: Finished running node seed.jaffle_shop.raw_products
[0m19:52:07.884830 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m19:52:07.885642 [debug] [MainThread]: Using duckdb connection "master"
[0m19:52:07.885772 [debug] [MainThread]: On master: BEGIN
[0m19:52:07.885888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:07.887935 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m19:52:07.888063 [debug] [MainThread]: On master: COMMIT
[0m19:52:07.888181 [debug] [MainThread]: Using duckdb connection "master"
[0m19:52:07.888294 [debug] [MainThread]: On master: COMMIT
[0m19:52:07.888425 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:52:07.888543 [debug] [MainThread]: On master: Close
[0m19:52:07.888943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:07.889066 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m19:52:07.889178 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory' was properly closed.
[0m19:52:07.889275 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory_transactions' was properly closed.
[0m19:52:07.889369 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_order_details' was properly closed.
[0m19:52:07.889472 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m19:52:07.889571 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_products' was properly closed.
[0m19:52:07.889672 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_supplier_products' was properly closed.
[0m19:52:07.889771 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_suppliers' was properly closed.
[0m19:52:07.889916 [info ] [MainThread]: 
[0m19:52:07.890053 [info ] [MainThread]: Finished running 8 seeds in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m19:52:07.890664 [debug] [MainThread]: Command end result
[0m19:52:07.912246 [info ] [MainThread]: 
[0m19:52:07.912487 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:52:07.912626 [info ] [MainThread]: 
[0m19:52:07.912764 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:52:07.914818 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.8020354, "process_user_time": 1.113963, "process_kernel_time": 0.142325, "process_mem_max_rss": "160661504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:52:07.915038 [debug] [MainThread]: Command `dbt seed` succeeded at 19:52:07.915001 after 0.80 seconds
[0m19:52:07.915198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa68c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093db460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a758d90>]}
[0m19:52:07.915345 [debug] [MainThread]: Flushing usage events
[0m20:12:54.152222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c3880>]}


============================== 20:12:54.157620 | c8633ece-d565-4adc-8850-fe84d5674dff ==============================
[0m20:12:54.157620 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:12:54.157891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:12:54.313492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087902e0>]}
[0m20:12:54.334330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087900a0>]}
[0m20:12:54.334891 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:12:54.343522 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:12:54.419429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:54.419678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:54.445229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b70130>]}
[0m20:12:54.503158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c50f0>]}
[0m20:12:54.503446 [info ] [MainThread]: Found 8 seeds, 8 models, 5 data tests, 421 macros
[0m20:12:54.503611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b85570>]}
[0m20:12:54.504388 [info ] [MainThread]: 
[0m20:12:54.504651 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:12:54.507161 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:12:54.532995 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:12:54.533202 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:12:54.533324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:54.547995 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:12:54.549055 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:12:54.549910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:12:54.550104 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:12:54.552986 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:12:54.553128 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:12:54.553245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:54.555490 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:12:54.555963 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:12:54.556082 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:12:54.556229 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:54.556342 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:12:54.556461 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:12:54.557262 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:12:54.557598 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:12:54.557714 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:12:54.557822 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:12:54.557958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:54.558078 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:12:54.559240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:12:54.561534 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:12:54.561662 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:12:54.561770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:54.563744 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:12:54.563878 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:12:54.564009 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:12:54.575803 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:12:54.578298 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:12:54.578802 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:12:54.578916 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:12:54.579996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbbb50>]}
[0m20:12:54.580217 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:54.580338 [debug] [MainThread]: On master: BEGIN
[0m20:12:54.580458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:54.582387 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:12:54.582529 [debug] [MainThread]: On master: COMMIT
[0m20:12:54.582653 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:54.582772 [debug] [MainThread]: On master: COMMIT
[0m20:12:54.582904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:54.583024 [debug] [MainThread]: On master: Close
[0m20:12:54.583492 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:12:54.583690 [info ] [MainThread]: 
[0m20:12:54.585377 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:12:54.585548 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_inventory
[0m20:12:54.585720 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_inventory_transactions
[0m20:12:54.586074 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_order_details
[0m20:12:54.585928 [info ] [Thread-1 (]: 1 of 8 START seed file main.raw_customers ...................................... [RUN]
[0m20:12:54.586265 [debug] [Thread-5 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:12:54.586414 [debug] [Thread-6 (]: Began running node seed.jaffle_shop.raw_products
[0m20:12:54.586562 [debug] [Thread-7 (]: Began running node seed.jaffle_shop.raw_supplier_products
[0m20:12:54.586709 [debug] [Thread-8 (]: Began running node seed.jaffle_shop.raw_suppliers
[0m20:12:54.586893 [info ] [Thread-2 (]: 2 of 8 START seed file main.raw_inventory ...................................... [RUN]
[0m20:12:54.587124 [info ] [Thread-3 (]: 3 of 8 START seed file main.raw_inventory_transactions ......................... [RUN]
[0m20:12:54.587335 [info ] [Thread-4 (]: 4 of 8 START seed file main.raw_order_details .................................. [RUN]
[0m20:12:54.587547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now seed.jaffle_shop.raw_customers)
[0m20:12:54.587743 [info ] [Thread-5 (]: 5 of 8 START seed file main.raw_orders ......................................... [RUN]
[0m20:12:54.587989 [info ] [Thread-6 (]: 6 of 8 START seed file main.raw_products ....................................... [RUN]
[0m20:12:54.588244 [info ] [Thread-7 (]: 7 of 8 START seed file main.raw_supplier_products .............................. [RUN]
[0m20:12:54.588470 [info ] [Thread-8 (]: 8 of 8 START seed file main.raw_suppliers ...................................... [RUN]
[0m20:12:54.588708 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory'
[0m20:12:54.588925 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_inventory_transactions'
[0m20:12:54.589160 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_order_details'
[0m20:12:54.589319 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:12:54.589518 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m20:12:54.589711 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_products'
[0m20:12:54.589900 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_supplier_products'
[0m20:12:54.590085 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_suppliers'
[0m20:12:54.590238 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_inventory
[0m20:12:54.590388 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_inventory_transactions
[0m20:12:54.590528 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_order_details
[0m20:12:54.590681 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:12:54.590823 [debug] [Thread-5 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:12:54.590961 [debug] [Thread-6 (]: Began compiling node seed.jaffle_shop.raw_products
[0m20:12:54.591099 [debug] [Thread-7 (]: Began compiling node seed.jaffle_shop.raw_supplier_products
[0m20:12:54.591233 [debug] [Thread-8 (]: Began compiling node seed.jaffle_shop.raw_suppliers
[0m20:12:54.591382 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_inventory
[0m20:12:54.591528 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_inventory_transactions
[0m20:12:54.591670 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_order_details
[0m20:12:54.599259 [debug] [Thread-5 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:12:54.607333 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m20:12:54.607553 [debug] [Thread-6 (]: Began executing node seed.jaffle_shop.raw_products
[0m20:12:54.607743 [debug] [Thread-7 (]: Began executing node seed.jaffle_shop.raw_supplier_products
[0m20:12:54.607923 [debug] [Thread-8 (]: Began executing node seed.jaffle_shop.raw_suppliers
[0m20:12:54.613089 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m20:12:54.615550 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m20:12:54.618672 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m20:12:54.620975 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m20:12:54.623563 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m20:12:54.628224 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m20:12:54.652045 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m20:12:54.652216 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: BEGIN
[0m20:12:54.653744 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m20:12:54.653926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:54.654083 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: BEGIN
[0m20:12:54.654228 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: BEGIN
[0m20:12:54.654365 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m20:12:54.654507 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: BEGIN
[0m20:12:54.654639 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: BEGIN
[0m20:12:54.654772 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:12:54.654912 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: BEGIN
[0m20:12:54.657028 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:12:54.657191 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:12:54.657332 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:12:54.657473 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:12:54.657615 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:12:54.657741 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:12:54.657926 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:12:54.658067 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:12:54.658249 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m20:12:54.658375 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.658614 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.658815 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.658980 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.659164 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.659333 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m20:12:54.659450 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:12:54.659586 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "jaffle_shop"."main"."raw_customers"
[0m20:12:54.659721 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m20:12:54.659853 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m20:12:54.659980 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m20:12:54.660118 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m20:12:54.660267 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m20:12:54.660401 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory"} */
truncate table "jaffle_shop"."main"."raw_inventory"
[0m20:12:54.660532 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m20:12:54.660714 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_inventory_transactions"} */
truncate table "jaffle_shop"."main"."raw_inventory_transactions"
[0m20:12:54.660889 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_order_details"} */
truncate table "jaffle_shop"."main"."raw_order_details"
[0m20:12:54.661047 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "jaffle_shop"."main"."raw_orders"
[0m20:12:54.661226 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_products"} */
truncate table "jaffle_shop"."main"."raw_products"
[0m20:12:54.661366 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_supplier_products"} */
truncate table "jaffle_shop"."main"."raw_supplier_products"
[0m20:12:54.661552 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_suppliers"} */
truncate table "jaffle_shop"."main"."raw_suppliers"
[0m20:12:54.662336 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.667195 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m20:12:54.667364 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: 
          COPY "jaffle_shop"."main"."raw_orders" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:12:54.667514 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:12:54.667661 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:12:54.667805 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:12:54.667958 [debug] [Thread-7 (]: SQL status: OK in 0.006 seconds
[0m20:12:54.668097 [debug] [Thread-6 (]: SQL status: OK in 0.006 seconds
[0m20:12:54.668244 [debug] [Thread-8 (]: SQL status: OK in 0.006 seconds
[0m20:12:54.668376 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:12:54.668902 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m20:12:54.669380 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m20:12:54.669818 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m20:12:54.670257 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m20:12:54.670689 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m20:12:54.671132 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m20:12:54.671584 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m20:12:54.671735 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: 
          COPY "jaffle_shop"."main"."raw_order_details" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:12:54.671894 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: 
          COPY "jaffle_shop"."main"."raw_inventory_transactions" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:12:54.672052 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: 
          COPY "jaffle_shop"."main"."raw_inventory" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_inventory.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:12:54.672208 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: 
          COPY "jaffle_shop"."main"."raw_supplier_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_supplier_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:12:54.672354 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: 
          COPY "jaffle_shop"."main"."raw_products" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:12:54.672502 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: 
          COPY "jaffle_shop"."main"."raw_suppliers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:12:54.672649 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          COPY "jaffle_shop"."main"."raw_customers" FROM '/Users/bunjee/Desktop/assignment4_db/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:12:54.674676 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.674834 [debug] [Thread-5 (]: SQL status: OK in 0.007 seconds
[0m20:12:54.674982 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m20:12:54.677498 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_suppliers"
[0m20:12:54.677650 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:12:54.677937 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:12:54.678080 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:12:54.678344 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_supplier_products"
[0m20:12:54.678724 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_order_details"
[0m20:12:54.679103 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory"
[0m20:12:54.685808 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m20:12:54.686038 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m20:12:54.686234 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:12:54.686814 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m20:12:54.686974 [debug] [Thread-6 (]: SQL status: OK in 0.014 seconds
[0m20:12:54.687158 [debug] [Thread-5 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m20:12:54.687755 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m20:12:54.688030 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_inventory_transactions"
[0m20:12:54.688598 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m20:12:54.688868 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:12:54.689494 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m20:12:54.689641 [debug] [Thread-8 (]: Using duckdb connection "seed.jaffle_shop.raw_suppliers"
[0m20:12:54.689899 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_products"
[0m20:12:54.690057 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m20:12:54.690210 [debug] [Thread-7 (]: Using duckdb connection "seed.jaffle_shop.raw_supplier_products"
[0m20:12:54.690396 [debug] [Thread-4 (]: Using duckdb connection "seed.jaffle_shop.raw_order_details"
[0m20:12:54.690601 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory"
[0m20:12:54.691205 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m20:12:54.691352 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: COMMIT
[0m20:12:54.691965 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m20:12:54.692169 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: COMMIT
[0m20:12:54.692752 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m20:12:54.692892 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: COMMIT
[0m20:12:54.693059 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: COMMIT
[0m20:12:54.693198 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.693357 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_inventory_transactions"
[0m20:12:54.693535 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m20:12:54.693713 [debug] [Thread-6 (]: Using duckdb connection "seed.jaffle_shop.raw_products"
[0m20:12:54.693856 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m20:12:54.694011 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:12:54.694885 [debug] [Thread-5 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:12:54.695030 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.695182 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.695330 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: COMMIT
[0m20:12:54.695488 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m20:12:54.695640 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: COMMIT
[0m20:12:54.695959 [debug] [Thread-8 (]: On seed.jaffle_shop.raw_suppliers: Close
[0m20:12:54.696253 [debug] [Thread-7 (]: On seed.jaffle_shop.raw_supplier_products: Close
[0m20:12:54.696889 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbfc40>]}
[0m20:12:54.697212 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_order_details: Close
[0m20:12:54.697519 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_inventory: Close
[0m20:12:54.697896 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbe200>]}
[0m20:12:54.698141 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:12:54.698342 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbfe50>]}
[0m20:12:54.698485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.698622 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:12:54.699027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbf940>]}
[0m20:12:54.698855 [info ] [Thread-5 (]: 5 of 8 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 100[0m in 0.11s]
[0m20:12:54.699257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbf580>]}
[0m20:12:54.699762 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_inventory_transactions: Close
[0m20:12:54.699493 [info ] [Thread-8 (]: 8 of 8 OK loaded seed file main.raw_suppliers .................................. [[32mINSERT 100[0m in 0.11s]
[0m20:12:54.700002 [info ] [Thread-7 (]: 7 of 8 OK loaded seed file main.raw_supplier_products .......................... [[32mINSERT 100[0m in 0.11s]
[0m20:12:54.700309 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:12:54.700601 [debug] [Thread-6 (]: On seed.jaffle_shop.raw_products: Close
[0m20:12:54.700818 [info ] [Thread-4 (]: 4 of 8 OK loaded seed file main.raw_order_details .............................. [[32mINSERT 100[0m in 0.11s]
[0m20:12:54.701080 [debug] [Thread-5 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:12:54.701291 [info ] [Thread-2 (]: 2 of 8 OK loaded seed file main.raw_inventory .................................. [[32mINSERT 100[0m in 0.11s]
[0m20:12:54.701503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbf6d0>]}
[0m20:12:54.701739 [debug] [Thread-8 (]: Finished running node seed.jaffle_shop.raw_suppliers
[0m20:12:54.701957 [debug] [Thread-7 (]: Finished running node seed.jaffle_shop.raw_supplier_products
[0m20:12:54.702137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbed40>]}
[0m20:12:54.710903 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8633ece-d565-4adc-8850-fe84d5674dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbff10>]}
[0m20:12:54.711192 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_order_details
[0m20:12:54.711505 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_inventory
[0m20:12:54.711746 [info ] [Thread-3 (]: 3 of 8 OK loaded seed file main.raw_inventory_transactions ..................... [[32mINSERT 100[0m in 0.11s]
[0m20:12:54.712090 [info ] [Thread-1 (]: 1 of 8 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.11s]
[0m20:12:54.712309 [info ] [Thread-6 (]: 6 of 8 OK loaded seed file main.raw_products ................................... [[32mINSERT 100[0m in 0.12s]
[0m20:12:54.712646 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_inventory_transactions
[0m20:12:54.712873 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:12:54.713090 [debug] [Thread-6 (]: Finished running node seed.jaffle_shop.raw_products
[0m20:12:54.713948 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:54.714088 [debug] [MainThread]: On master: BEGIN
[0m20:12:54.714207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:12:54.716263 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:12:54.716405 [debug] [MainThread]: On master: COMMIT
[0m20:12:54.716529 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:54.716638 [debug] [MainThread]: On master: COMMIT
[0m20:12:54.716763 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:54.716884 [debug] [MainThread]: On master: Close
[0m20:12:54.717365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:54.717482 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:12:54.717579 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory' was properly closed.
[0m20:12:54.717678 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_inventory_transactions' was properly closed.
[0m20:12:54.717774 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_order_details' was properly closed.
[0m20:12:54.717866 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:12:54.717961 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_products' was properly closed.
[0m20:12:54.718053 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_supplier_products' was properly closed.
[0m20:12:54.718143 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_suppliers' was properly closed.
[0m20:12:54.718278 [info ] [MainThread]: 
[0m20:12:54.718409 [info ] [MainThread]: Finished running 8 seeds in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m20:12:54.719026 [debug] [MainThread]: Command end result
[0m20:12:54.736445 [info ] [MainThread]: 
[0m20:12:54.736673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:54.736809 [info ] [MainThread]: 
[0m20:12:54.736949 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:12:54.738238 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.6237018, "process_user_time": 0.935993, "process_kernel_time": 0.13389, "process_mem_max_rss": "153878528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:12:54.738447 [debug] [MainThread]: Command `dbt seed` succeeded at 20:12:54.738413 after 0.62 seconds
[0m20:12:54.738595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b113f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109293670>]}
[0m20:12:54.738735 [debug] [MainThread]: Flushing usage events
[0m20:14:01.445161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e7e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105277e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105277790>]}


============================== 20:14:01.448560 | 0d87f35c-0d83-42b9-ad96-7cb8f27318a6 ==============================
[0m20:14:01.448560 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:14:01.448842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m20:14:01.585671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d87f35c-0d83-42b9-ad96-7cb8f27318a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102effeb0>]}
[0m20:14:01.606707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d87f35c-0d83-42b9-ad96-7cb8f27318a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550cca0>]}
[0m20:14:01.607147 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:14:01.614872 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:14:01.686365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:14:01.686598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:14:01.712303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d87f35c-0d83-42b9-ad96-7cb8f27318a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ec130>]}
[0m20:14:01.774447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d87f35c-0d83-42b9-ad96-7cb8f27318a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105897e20>]}
[0m20:14:01.774719 [info ] [MainThread]: Found 8 seeds, 8 models, 5 data tests, 421 macros
[0m20:14:01.774878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d87f35c-0d83-42b9-ad96-7cb8f27318a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059f9600>]}
[0m20:14:01.775607 [info ] [MainThread]: 
[0m20:14:01.775855 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:14:01.778392 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m20:14:01.802649 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:14:01.802865 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:14:01.802999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:01.810792 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:14:01.810941 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:14:01.811066 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:14:01.830047 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:14:01.832998 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:14:01.833489 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:14:01.833614 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:14:01.835174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d87f35c-0d83-42b9-ad96-7cb8f27318a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105894130>]}
[0m20:14:01.835369 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:01.835491 [debug] [MainThread]: On master: BEGIN
[0m20:14:01.835607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:01.837418 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:14:01.837550 [debug] [MainThread]: On master: COMMIT
[0m20:14:01.837673 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:01.837785 [debug] [MainThread]: On master: COMMIT
[0m20:14:01.837910 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:01.838032 [debug] [MainThread]: On master: Close
[0m20:14:01.838471 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:14:01.838669 [info ] [MainThread]: 
[0m20:14:01.840421 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:14:01.840619 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:01.840796 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:14:01.840975 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:14:01.841146 [debug] [Thread-5 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:14:01.841352 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m20:14:01.841557 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m20:14:01.841784 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m20:14:01.842003 [info ] [Thread-4 (]: 4 of 5 START test unique_stg_customers_customer_id ............................. [RUN]
[0m20:14:01.842196 [info ] [Thread-5 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m20:14:01.842403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m20:14:01.842626 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m20:14:01.842852 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m20:14:01.843059 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada'
[0m20:14:01.843276 [debug] [Thread-5 (]: Acquiring new duckdb connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a'
[0m20:14:01.843442 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:14:01.843599 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:01.843758 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:14:01.843905 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:14:01.844054 [debug] [Thread-5 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:14:01.852763 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:14:01.856133 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:14:01.857670 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:14:01.860098 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:14:01.861693 [debug] [Thread-5 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:14:01.862409 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:01.862566 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:14:01.862740 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:14:01.862899 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:14:01.863042 [debug] [Thread-5 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:14:01.869205 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:14:01.870781 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:14:01.871713 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:14:01.872658 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:14:01.873561 [debug] [Thread-5 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:14:01.874112 [debug] [Thread-4 (]: Using duckdb connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:14:01.874282 [debug] [Thread-2 (]: Using duckdb connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:14:01.874469 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:14:01.874665 [debug] [Thread-3 (]: Using duckdb connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:14:01.874834 [debug] [Thread-5 (]: Using duckdb connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:14:01.874979 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m20:14:01.875139 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m20:14:01.875299 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m20:14:01.875451 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m20:14:01.875617 [debug] [Thread-5 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m20:14:01.875786 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:14:01.875935 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:14:01.876090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:01.876237 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:14:01.876382 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:14:01.878551 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:14:01.878783 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:14:01.878935 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:14:01.879114 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:14:01.879282 [debug] [Thread-4 (]: Using duckdb connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:14:01.879417 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m20:14:01.879570 [debug] [Thread-2 (]: Using duckdb connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:14:01.879731 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:14:01.879879 [debug] [Thread-3 (]: Using duckdb connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:14:01.880046 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:01.880221 [debug] [Thread-5 (]: Using duckdb connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:14:01.880387 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "jaffle_shop"."main"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:14:01.880573 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_shop"."main"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m20:14:01.880756 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "jaffle_shop"."main"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m20:14:01.880952 [debug] [Thread-5 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:01.890589 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "jaffle_shop"."main"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m20:14:01.890830 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:01.891050 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "jaffle_shop"."main"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m20:14:01.891255 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_shop"."main"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m20:14:01.891485 [debug] [Thread-5 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:14:01.891654 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:01.891818 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:01.891976 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:01.892140 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:01.892294 [debug] [Thread-5 (]: DuckDB adapter: Rolling back transaction.
[0m20:14:01.892494 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m20:14:01.892680 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m20:14:01.892857 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m20:14:01.893052 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m20:14:01.893231 [debug] [Thread-5 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m20:14:01.898595 [debug] [Thread-4 (]: Failed to rollback 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada'
[0m20:14:01.898966 [debug] [Thread-5 (]: Failed to rollback 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a'
[0m20:14:01.899116 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m20:14:01.899452 [debug] [Thread-2 (]: Failed to rollback 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m20:14:01.899805 [debug] [Thread-3 (]: Failed to rollback 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m20:14:01.899995 [debug] [Thread-5 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m20:14:01.900371 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad'
[0m20:14:01.900709 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m20:14:01.900920 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m20:14:01.901251 [debug] [Thread-4 (]: Runtime Error in test unique_stg_customers_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  LINE 15: from "jaffle_shop"."main"."stg_customers"
                ^
[0m20:14:01.901568 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m20:14:01.902059 [debug] [Thread-5 (]: Runtime Error in test unique_stg_orders_order_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  LINE 15: from "jaffle_shop"."main"."stg_orders"
                ^
[0m20:14:01.902601 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_customers_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  LINE 14: from "jaffle_shop"."main"."stg_customers"
                ^
[0m20:14:01.902861 [error] [Thread-4 (]: 4 of 5 ERROR unique_stg_customers_customer_id .................................. [[31mERROR[0m in 0.06s]
[0m20:14:01.903259 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_orders_order_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  LINE 14: from "jaffle_shop"."main"."stg_orders"
                ^
[0m20:14:01.904058 [error] [Thread-5 (]: 5 of 5 ERROR unique_stg_orders_order_id ........................................ [[31mERROR[0m in 0.06s]
[0m20:14:01.904421 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned (models/staging/schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  LINE 17:     from "jaffle_shop"."main"."stg_orders"
                    ^
[0m20:14:01.904633 [error] [Thread-2 (]: 2 of 5 ERROR not_null_stg_customers_customer_id ................................ [[31mERROR[0m in 0.06s]
[0m20:14:01.904913 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:14:01.905114 [error] [Thread-3 (]: 3 of 5 ERROR not_null_stg_orders_order_id ...................................... [[31mERROR[0m in 0.06s]
[0m20:14:01.905367 [debug] [Thread-5 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:14:01.905571 [error] [Thread-1 (]: 1 of 5 ERROR accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[31mERROR[0m in 0.06s]
[0m20:14:01.905834 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:14:01.906162 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:14:01.906467 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:14:01.907188 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:01.907324 [debug] [MainThread]: On master: BEGIN
[0m20:14:01.907436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:01.909460 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:14:01.909607 [debug] [MainThread]: On master: COMMIT
[0m20:14:01.909727 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:01.909852 [debug] [MainThread]: On master: COMMIT
[0m20:14:01.909993 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:01.910115 [debug] [MainThread]: On master: Close
[0m20:14:01.910593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:01.910718 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad' was properly closed.
[0m20:14:01.910821 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
[0m20:14:01.910917 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m20:14:01.911013 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m20:14:01.911106 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m20:14:01.911238 [info ] [MainThread]: 
[0m20:14:01.911374 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m20:14:01.911841 [debug] [MainThread]: Command end result
[0m20:14:01.950433 [info ] [MainThread]: 
[0m20:14:01.950675 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m20:14:01.950811 [info ] [MainThread]: 
[0m20:14:01.950969 [error] [MainThread]:   Runtime Error in test unique_stg_customers_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  LINE 15: from "jaffle_shop"."main"."stg_customers"
                ^
[0m20:14:01.951099 [info ] [MainThread]: 
[0m20:14:01.951251 [error] [MainThread]:   Runtime Error in test unique_stg_orders_order_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  LINE 15: from "jaffle_shop"."main"."stg_orders"
                ^
[0m20:14:01.951377 [info ] [MainThread]: 
[0m20:14:01.951531 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  LINE 14: from "jaffle_shop"."main"."stg_customers"
                ^
[0m20:14:01.951654 [info ] [MainThread]: 
[0m20:14:01.951802 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_order_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  LINE 14: from "jaffle_shop"."main"."stg_orders"
                ^
[0m20:14:01.951927 [info ] [MainThread]: 
[0m20:14:01.952080 [error] [MainThread]:   Runtime Error in test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned (models/staging/schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  LINE 17:     from "jaffle_shop"."main"."stg_orders"
                    ^
[0m20:14:01.952207 [info ] [MainThread]: 
[0m20:14:01.952341 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m20:14:01.953725 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.5374306, "process_user_time": 0.881082, "process_kernel_time": 0.114096, "process_mem_max_rss": "132923392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:14:01.953934 [debug] [MainThread]: Command `dbt test` failed at 20:14:01.953897 after 0.54 seconds
[0m20:14:01.954092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e7e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a8b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f58c70>]}
[0m20:14:01.954240 [debug] [MainThread]: Flushing usage events
[0m20:16:23.668800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10377e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bb880>]}


============================== 20:16:23.672834 | c2d06089-2ee0-4b62-9c16-b15a8e5bf34c ==============================
[0m20:16:23.672834 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:16:23.673130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:16:23.813639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055082e0>]}
[0m20:16:23.834234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055080a0>]}
[0m20:16:23.834793 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:16:23.842886 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:16:23.915288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:16:23.915622 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/safe_cast.sql
[0m20:16:23.915830 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_orders.sql
[0m20:16:24.009203 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:16:24.009478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105563c40>]}
[0m20:16:24.085742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd0310>]}
[0m20:16:24.140452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db5480>]}
[0m20:16:24.140710 [info ] [MainThread]: Found 8 seeds, 8 models, 5 data tests, 422 macros
[0m20:16:24.140864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db5450>]}
[0m20:16:24.141591 [info ] [MainThread]: 
[0m20:16:24.141829 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:16:24.144337 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:16:24.193337 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:16:24.193531 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:16:24.193651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:24.202259 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:16:24.202872 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:16:24.203931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:16:24.204147 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:16:24.207164 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:16:24.207320 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:16:24.207446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:24.209661 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:16:24.210188 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:16:24.210317 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:16:24.210459 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:24.210572 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:16:24.210691 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:16:24.210889 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:24.211204 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:16:24.211329 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:16:24.211443 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:16:24.211589 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:16:24.211711 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:16:24.212881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:16:24.215280 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:16:24.215416 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:16:24.215540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:24.217466 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:16:24.217593 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:16:24.217715 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:16:24.227054 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:16:24.229050 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:16:24.229527 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:16:24.229656 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:16:24.230802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a093c0>]}
[0m20:16:24.230999 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:24.231125 [debug] [MainThread]: On master: BEGIN
[0m20:16:24.231239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:24.233075 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:16:24.233206 [debug] [MainThread]: On master: COMMIT
[0m20:16:24.233328 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:24.233444 [debug] [MainThread]: On master: COMMIT
[0m20:16:24.233578 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:24.233697 [debug] [MainThread]: On master: Close
[0m20:16:24.234118 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:16:24.234277 [info ] [MainThread]: 
[0m20:16:24.235941 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:16:24.236107 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:16:24.236295 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:16:24.236457 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:16:24.236789 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:16:24.236661 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m20:16:24.236967 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:16:24.237120 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:16:24.237294 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:16:24.237487 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_inventory ................................. [RUN]
[0m20:16:24.237716 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_inventory_transactions .................... [RUN]
[0m20:16:24.237931 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_order_details ............................. [RUN]
[0m20:16:24.238142 [info ] [Thread-5 (]: 5 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m20:16:24.238345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:16:24.238544 [info ] [Thread-6 (]: 6 of 8 START sql view model main.stg_products .................................. [RUN]
[0m20:16:24.238759 [info ] [Thread-7 (]: 7 of 8 START sql view model main.stg_supplier_products ......................... [RUN]
[0m20:16:24.238989 [info ] [Thread-8 (]: 8 of 8 START sql view model main.stg_suppliers ................................. [RUN]
[0m20:16:24.239220 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:16:24.239433 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:16:24.239622 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:16:24.239793 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:16:24.239940 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:16:24.240141 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:16:24.240330 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:16:24.240531 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:16:24.240678 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:16:24.240826 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:16:24.240970 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:16:24.241107 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:16:24.244886 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:16:24.245054 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:16:24.245205 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:16:24.245357 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:16:24.246505 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:16:24.247712 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:16:24.249409 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:16:24.251034 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:16:24.252368 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:16:24.253541 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:16:24.254658 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:16:24.254859 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:16:24.255064 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:16:24.255315 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:16:24.255492 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:16:24.255715 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:16:24.255880 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:16:24.256077 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:16:24.269332 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:16:24.271298 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:16:24.271443 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:16:24.272768 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:16:24.274087 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:16:24.275396 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:16:24.276709 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:16:24.278015 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:16:24.279774 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:16:24.280024 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:16:24.280207 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:16:24.280439 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:16:24.280694 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:16:24.280851 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:16:24.281063 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:16:24.281234 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:16:24.281451 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:16:24.281600 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:16:24.281755 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:16:24.281910 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:16:24.282058 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:16:24.282204 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:16:24.282348 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:16:24.282503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:24.282653 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:16:24.282799 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:16:24.282948 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:16:24.283097 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:16:24.283241 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:16:24.283380 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:16:24.283517 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:16:24.285711 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:16:24.285884 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:16:24.286073 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:16:24.286226 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:16:24.286427 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:16:24.286570 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m20:16:24.286781 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:16:24.286932 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m20:16:24.287086 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:16:24.287220 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m20:16:24.287400 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:16:24.287546 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:16:24.287684 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:16:24.287826 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:16:24.287964 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:16:24.288101 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:16:24.288263 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  CAST(customer_id AS INTEGER) AS customer_id,
  INITCAP(TRIM(first_name)) AS first_name,
  INITCAP(TRIM(last_name)) AS last_name,
  LOWER(TRIM(email)) AS email,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:16:24.288429 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:16:24.288590 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:16:24.288747 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:16:24.288905 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  INITCAP(TRIM(reason)) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:16:24.289071 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:16:24.289240 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:16:24.289404 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  INITCAP(TRIM(product_name)) AS product_name,
  INITCAP(TRIM(category)) AS category,
  CAST(price AS DECIMAL(10,2)) AS price,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:16:24.289595 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:16:24.289785 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  INITCAP(TRIM(supplier_name)) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:16:24.290011 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.290248 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.290405 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.290553 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.293379 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:16:24.293623 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  CAST(customer_id AS INTEGER) AS customer_id,
  INITCAP(TRIM(first_name)) AS first_name,
  INITCAP(TRIM(last_name)) AS last_name,
  LOWER(TRIM(email)) AS email,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:16:24.293831 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  INITCAP(TRIM(reason)) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:16:24.294031 [debug] [Thread-8 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  INITCAP(TRIM(supplier_name)) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:16:24.294240 [debug] [Thread-6 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  INITCAP(TRIM(product_name)) AS product_name,
  INITCAP(TRIM(category)) AS category,
  CAST(price AS DECIMAL(10,2)) AS price,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:16:24.295497 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:16:24.296636 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:16:24.297728 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:16:24.297885 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:16:24.298051 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:16:24.298213 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m20:16:24.298364 [debug] [Thread-8 (]: DuckDB adapter: Rolling back transaction.
[0m20:16:24.298534 [debug] [Thread-6 (]: DuckDB adapter: Rolling back transaction.
[0m20:16:24.298690 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:16:24.298845 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:16:24.299001 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:16:24.299228 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m20:16:24.299454 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: ROLLBACK
[0m20:16:24.299646 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: ROLLBACK
[0m20:16:24.299785 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:16:24.299989 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: ROLLBACK
[0m20:16:24.300218 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.300357 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.300498 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.306973 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:16:24.307663 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:16:24.308493 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:16:24.309172 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:16:24.309543 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:16:24.309776 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:16:24.309936 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:16:24.310223 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:16:24.310489 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:16:24.310800 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:16:24.311172 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:16:24.311365 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:16:24.311905 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.312123 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:16:24.312291 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:16:24.312460 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:16:24.314520 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:16:24.316095 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:16:24.317331 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:16:24.318397 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:16:24.318669 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:16:24.319093 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:16:24.319331 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:16:24.319691 [debug] [Thread-8 (]: Failed to rollback 'model.jaffle_shop.stg_suppliers'
[0m20:16:24.320059 [debug] [Thread-6 (]: Failed to rollback 'model.jaffle_shop.stg_products'
[0m20:16:24.320415 [debug] [Thread-1 (]: Failed to rollback 'model.jaffle_shop.stg_customers'
[0m20:16:24.320568 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:16:24.320903 [debug] [Thread-3 (]: Failed to rollback 'model.jaffle_shop.stg_inventory_transactions'
[0m20:16:24.321169 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:16:24.321315 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.321476 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.321617 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:16:24.321750 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:16:24.321889 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:16:24.322055 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:16:24.322345 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:16:24.323365 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:16:24.323915 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:16:24.324453 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:16:24.324775 [debug] [Thread-8 (]: Runtime Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(supplier_name)) AS supplier_name,
    LOWER(TRIM(contact_email)) AS contact_email,
    TRIM(phone_number) AS phone_number
  FROM "jaffle_shop"."main"."raw_suppliers"
    );
  ...
            ^
[0m20:16:24.325574 [debug] [Thread-6 (]: Runtime Error in model stg_products (models/staging/stg_products.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(product_name)) AS product_name,
    INITCAP(TRIM(category)) AS category,
    CAST(price AS DECIMAL(10,2)) AS price,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_products"
    );
  ...
            ^
[0m20:16:24.325993 [debug] [Thread-3 (]: Runtime Error in model stg_inventory_transactions (models/staging/stg_inventory_transactions.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 10:   INITCAP(TRIM(reason)) AS reason
             ^
[0m20:16:24.326483 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:16:24.326838 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(first_name)) AS first_name,
    INITCAP(TRIM(last_name)) AS last_name,
    LOWER(TRIM(email)) AS email,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_customers"
    );
  ...
            ^
[0m20:16:24.327484 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a11ff0>]}
[0m20:16:24.327702 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e8460>]}
[0m20:16:24.327903 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a126b0>]}
[0m20:16:24.328064 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106325030>]}
[0m20:16:24.328235 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dacc70>]}
[0m20:16:24.328401 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0b0d0>]}
[0m20:16:24.330527 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063588e0>]}
[0m20:16:24.330695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2d06089-2ee0-4b62-9c16-b15a8e5bf34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a48e20>]}
[0m20:16:24.330968 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_inventory ............................ [[32mOK[0m in 0.09s]
[0m20:16:24.331247 [info ] [Thread-7 (]: 7 of 8 OK created sql view model main.stg_supplier_products .................... [[32mOK[0m in 0.09s]
[0m20:16:24.331518 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_order_details ........................ [[32mOK[0m in 0.09s]
[0m20:16:24.331775 [error] [Thread-8 (]: 8 of 8 ERROR creating sql view model main.stg_suppliers ........................ [[31mERROR[0m in 0.09s]
[0m20:16:24.332030 [error] [Thread-6 (]: 6 of 8 ERROR creating sql view model main.stg_products ......................... [[31mERROR[0m in 0.09s]
[0m20:16:24.332275 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model main.stg_inventory_transactions ........... [[31mERROR[0m in 0.09s]
[0m20:16:24.332529 [info ] [Thread-5 (]: 5 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.09s]
[0m20:16:24.332795 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.09s]
[0m20:16:24.333060 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:16:24.333287 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:16:24.333497 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:16:24.333731 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:16:24.333966 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:16:24.334188 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:16:24.334396 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:16:24.334619 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:16:24.335522 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:24.335655 [debug] [MainThread]: On master: BEGIN
[0m20:16:24.335764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:24.337736 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:16:24.337875 [debug] [MainThread]: On master: COMMIT
[0m20:16:24.337998 [debug] [MainThread]: Using duckdb connection "master"
[0m20:16:24.338103 [debug] [MainThread]: On master: COMMIT
[0m20:16:24.338235 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:16:24.338353 [debug] [MainThread]: On master: Close
[0m20:16:24.338732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:24.338850 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:16:24.338951 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m20:16:24.339059 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:16:24.339162 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:16:24.339263 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:16:24.339373 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m20:16:24.339476 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:16:24.339579 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:16:24.339736 [info ] [MainThread]: 
[0m20:16:24.339874 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:16:24.340528 [debug] [MainThread]: Command end result
[0m20:16:24.358925 [info ] [MainThread]: 
[0m20:16:24.359151 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m20:16:24.359277 [info ] [MainThread]: 
[0m20:16:24.359434 [error] [MainThread]:   Runtime Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(supplier_name)) AS supplier_name,
    LOWER(TRIM(contact_email)) AS contact_email,
    TRIM(phone_number) AS phone_number
  FROM "jaffle_shop"."main"."raw_suppliers"
    );
  ...
            ^
[0m20:16:24.359566 [info ] [MainThread]: 
[0m20:16:24.359719 [error] [MainThread]:   Runtime Error in model stg_products (models/staging/stg_products.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(product_name)) AS product_name,
    INITCAP(TRIM(category)) AS category,
    CAST(price AS DECIMAL(10,2)) AS price,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_products"
    );
  ...
            ^
[0m20:16:24.359853 [info ] [MainThread]: 
[0m20:16:24.359999 [error] [MainThread]:   Runtime Error in model stg_inventory_transactions (models/staging/stg_inventory_transactions.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 10:   INITCAP(TRIM(reason)) AS reason
             ^
[0m20:16:24.360123 [info ] [MainThread]: 
[0m20:16:24.360270 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(first_name)) AS first_name,
    INITCAP(TRIM(last_name)) AS last_name,
    LOWER(TRIM(email)) AS email,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_customers"
    );
  ...
            ^
[0m20:16:24.360405 [info ] [MainThread]: 
[0m20:16:24.360540 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
[0m20:16:24.361903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.72832936, "process_user_time": 1.048886, "process_kernel_time": 0.123831, "process_mem_max_rss": "136052736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:16:24.362136 [debug] [MainThread]: Command `dbt run` failed at 20:16:24.362095 after 0.73 seconds
[0m20:16:24.362312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10377e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589beb0>]}
[0m20:16:24.362474 [debug] [MainThread]: Flushing usage events
[0m20:17:38.959465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a73f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a73880>]}


============================== 20:17:38.963077 | ff5a928b-471f-4e60-abb3-10d678425ba9 ==============================
[0m20:17:38.963077 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:17:38.963359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:17:39.083391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b402e0>]}
[0m20:17:39.103828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b400a0>]}
[0m20:17:39.105945 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:17:39.114160 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:17:39.181082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:17:39.181401 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_suppliers.sql
[0m20:17:39.283424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bd7e0>]}
[0m20:17:39.335027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107092c50>]}
[0m20:17:39.335311 [info ] [MainThread]: Found 8 seeds, 8 models, 5 data tests, 422 macros
[0m20:17:39.335986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107092c20>]}
[0m20:17:39.336840 [info ] [MainThread]: 
[0m20:17:39.337095 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:17:39.339458 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:17:39.363696 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:17:39.363909 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:17:39.364043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:39.372187 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:17:39.372732 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:17:39.373781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:17:39.373970 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:17:39.376821 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:17:39.376960 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:17:39.377074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:39.379008 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:17:39.379492 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:17:39.379609 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:17:39.379737 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:39.379853 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:17:39.379972 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:17:39.380172 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:39.380493 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:17:39.380621 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:17:39.380737 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:17:39.380872 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:17:39.380993 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:17:39.382100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:17:39.384374 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:17:39.384503 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:17:39.384608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:39.386427 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:17:39.386569 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:17:39.386705 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:17:39.395367 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:17:39.397400 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:17:39.397912 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:17:39.398036 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:17:39.399333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053353c0>]}
[0m20:17:39.399553 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:39.399673 [debug] [MainThread]: On master: BEGIN
[0m20:17:39.399778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:39.401573 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:17:39.401708 [debug] [MainThread]: On master: COMMIT
[0m20:17:39.401826 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:39.401926 [debug] [MainThread]: On master: COMMIT
[0m20:17:39.402052 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:39.402168 [debug] [MainThread]: On master: Close
[0m20:17:39.402626 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:17:39.402763 [info ] [MainThread]: 
[0m20:17:39.404465 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:17:39.404642 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:17:39.404813 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:17:39.404983 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:17:39.405125 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:17:39.405332 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m20:17:39.405504 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:17:39.405664 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:17:39.405856 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_inventory ................................. [RUN]
[0m20:17:39.406018 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:17:39.406218 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_inventory_transactions .................... [RUN]
[0m20:17:39.406424 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_order_details ............................. [RUN]
[0m20:17:39.406644 [info ] [Thread-5 (]: 5 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m20:17:39.406845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:17:39.407040 [info ] [Thread-6 (]: 6 of 8 START sql view model main.stg_products .................................. [RUN]
[0m20:17:39.407237 [info ] [Thread-7 (]: 7 of 8 START sql view model main.stg_supplier_products ......................... [RUN]
[0m20:17:39.407478 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:17:39.407665 [info ] [Thread-8 (]: 8 of 8 START sql view model main.stg_suppliers ................................. [RUN]
[0m20:17:39.407873 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:17:39.408072 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:17:39.408267 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:17:39.408421 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:17:39.408604 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:17:39.408790 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:17:39.408934 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:17:39.409110 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:17:39.409247 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:17:39.409383 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:17:39.409528 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:17:39.413020 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:17:39.413177 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:17:39.413325 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:17:39.414493 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:17:39.414660 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:17:39.416278 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:17:39.437803 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:17:39.439663 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:17:39.440875 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:17:39.441980 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:17:39.442178 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:17:39.443165 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:17:39.443384 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:17:39.443644 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:17:39.443907 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:17:39.449346 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:17:39.456937 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:17:39.457096 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:17:39.457332 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:17:39.459295 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:17:39.460644 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:17:39.460801 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:17:39.462101 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:17:39.463431 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:17:39.464871 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:17:39.466253 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:17:39.466459 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:17:39.468121 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:17:39.468401 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:17:39.468556 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:17:39.468821 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:17:39.468975 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:17:39.469152 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:17:39.469348 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:17:39.469543 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:17:39.469693 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:17:39.469855 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:17:39.470023 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:17:39.470174 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:17:39.470323 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:17:39.470468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:39.470625 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:17:39.470771 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:17:39.470926 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:17:39.471071 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:17:39.471213 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:17:39.471356 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:17:39.471501 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:17:39.473497 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:17:39.473656 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:17:39.473847 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:17:39.474018 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:17:39.474177 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:17:39.474323 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:17:39.474498 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:17:39.474685 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m20:17:39.474837 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:17:39.474976 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.475158 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:17:39.475305 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.475436 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:17:39.475612 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:17:39.475757 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:17:39.475888 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:17:39.476045 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  CAST(customer_id AS INTEGER) AS customer_id,
  INITCAP(TRIM(first_name)) AS first_name,
  INITCAP(TRIM(last_name)) AS last_name,
  LOWER(TRIM(email)) AS email,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:17:39.476204 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:17:39.476372 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  INITCAP(TRIM(reason)) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:17:39.476531 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:17:39.476689 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:17:39.476855 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:17:39.477018 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:17:39.477172 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:17:39.477357 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  INITCAP(TRIM(product_name)) AS product_name,
  INITCAP(TRIM(category)) AS category,
  CAST(price AS DECIMAL(10,2)) AS price,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:17:39.477556 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:17:39.477880 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:17:39.478029 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.478189 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.478334 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.481436 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:17:39.481686 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  INITCAP(TRIM(reason)) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:17:39.481897 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  CAST(customer_id AS INTEGER) AS customer_id,
  INITCAP(TRIM(first_name)) AS first_name,
  INITCAP(TRIM(last_name)) AS last_name,
  LOWER(TRIM(email)) AS email,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:17:39.482112 [debug] [Thread-6 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  INITCAP(TRIM(product_name)) AS product_name,
  INITCAP(TRIM(category)) AS category,
  CAST(price AS DECIMAL(10,2)) AS price,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:17:39.483348 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:17:39.483487 [debug] [Thread-8 (]: SQL status: OK in 0.005 seconds
[0m20:17:39.483623 [debug] [Thread-7 (]: SQL status: OK in 0.005 seconds
[0m20:17:39.484891 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:17:39.485047 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:17:39.485209 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m20:17:39.485358 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:17:39.485502 [debug] [Thread-6 (]: DuckDB adapter: Rolling back transaction.
[0m20:17:39.485659 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:17:39.486860 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:17:39.488024 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:17:39.488169 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m20:17:39.488390 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: ROLLBACK
[0m20:17:39.488593 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m20:17:39.488776 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: ROLLBACK
[0m20:17:39.488935 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.489102 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:17:39.489315 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m20:17:39.489455 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.489787 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.491161 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:17:39.491761 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.491925 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.493560 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:17:39.494783 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:17:39.495025 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:17:39.500956 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:17:39.502349 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:17:39.502640 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:17:39.502848 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:17:39.503252 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.503394 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:17:39.503638 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:17:39.503948 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.505314 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:17:39.505475 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:17:39.505685 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:17:39.506267 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:17:39.506531 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:17:39.506696 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.507281 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:17:39.507614 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:17:39.507832 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:17:39.507968 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.508564 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:17:39.508826 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:17:39.509155 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:17:39.511290 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:17:39.511658 [debug] [Thread-1 (]: Failed to rollback 'model.jaffle_shop.stg_customers'
[0m20:17:39.512011 [debug] [Thread-3 (]: Failed to rollback 'model.jaffle_shop.stg_inventory_transactions'
[0m20:17:39.512150 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:17:39.512494 [debug] [Thread-6 (]: Failed to rollback 'model.jaffle_shop.stg_products'
[0m20:17:39.512644 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:17:39.512809 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:17:39.513004 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m20:17:39.513145 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.513296 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:17:39.513449 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:17:39.514446 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:17:39.514596 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:17:39.514751 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:17:39.515847 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:17:39.515986 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.516285 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.516578 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:17:39.517171 [debug] [Thread-3 (]: Runtime Error in model stg_inventory_transactions (models/staging/stg_inventory_transactions.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 10:   INITCAP(TRIM(reason)) AS reason
             ^
[0m20:17:39.517336 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:17:39.517508 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.517852 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(first_name)) AS first_name,
    INITCAP(TRIM(last_name)) AS last_name,
    LOWER(TRIM(email)) AS email,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_customers"
    );
  ...
            ^
[0m20:17:39.519328 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:17:39.519690 [debug] [Thread-6 (]: Runtime Error in model stg_products (models/staging/stg_products.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(product_name)) AS product_name,
    INITCAP(TRIM(category)) AS category,
    CAST(price AS DECIMAL(10,2)) AS price,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_products"
    );
  ...
            ^
[0m20:17:39.520670 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:17:39.521375 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eac400>]}
[0m20:17:39.522383 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:17:39.522549 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:17:39.522709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f412d0>]}
[0m20:17:39.522880 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:17:39.523036 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.523189 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2f6d0>]}
[0m20:17:39.523402 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052cea40>]}
[0m20:17:39.523686 [error] [Thread-3 (]: 3 of 8 ERROR creating sql view model main.stg_inventory_transactions ........... [[31mERROR[0m in 0.11s]
[0m20:17:39.523889 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:17:39.524416 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:17:39.524661 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.12s]
[0m20:17:39.525233 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:17:39.525610 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:17:39.525482 [error] [Thread-6 (]: 6 of 8 ERROR creating sql view model main.stg_products ......................... [[31mERROR[0m in 0.11s]
[0m20:17:39.525878 [info ] [Thread-8 (]: 8 of 8 OK created sql view model main.stg_suppliers ............................ [[32mOK[0m in 0.11s]
[0m20:17:39.526149 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:17:39.526365 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fca3e0>]}
[0m20:17:39.526621 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:17:39.526764 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:17:39.526968 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107731a80>]}
[0m20:17:39.527494 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:17:39.527718 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:17:39.527939 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:17:39.528248 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_inventory ............................ [[32mOK[0m in 0.12s]
[0m20:17:39.528843 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:17:39.529082 [info ] [Thread-5 (]: 5 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.12s]
[0m20:17:39.529290 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766bac0>]}
[0m20:17:39.529606 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:17:39.531488 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff5a928b-471f-4e60-abb3-10d678425ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107682260>]}
[0m20:17:39.531690 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:17:39.531911 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_order_details ........................ [[32mOK[0m in 0.12s]
[0m20:17:39.532223 [info ] [Thread-7 (]: 7 of 8 OK created sql view model main.stg_supplier_products .................... [[32mOK[0m in 0.12s]
[0m20:17:39.532492 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:17:39.532703 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:17:39.533373 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:39.533508 [debug] [MainThread]: On master: BEGIN
[0m20:17:39.533625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:39.535498 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:17:39.535629 [debug] [MainThread]: On master: COMMIT
[0m20:17:39.535745 [debug] [MainThread]: Using duckdb connection "master"
[0m20:17:39.535851 [debug] [MainThread]: On master: COMMIT
[0m20:17:39.535974 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:17:39.536090 [debug] [MainThread]: On master: Close
[0m20:17:39.536511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:39.536634 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:17:39.536733 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m20:17:39.536825 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:17:39.536916 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:17:39.537007 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:17:39.537097 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m20:17:39.537185 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:17:39.537278 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:17:39.537422 [info ] [MainThread]: 
[0m20:17:39.537550 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:17:39.538127 [debug] [MainThread]: Command end result
[0m20:17:39.555032 [info ] [MainThread]: 
[0m20:17:39.555249 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:17:39.555371 [info ] [MainThread]: 
[0m20:17:39.555525 [error] [MainThread]:   Runtime Error in model stg_inventory_transactions (models/staging/stg_inventory_transactions.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 10:   INITCAP(TRIM(reason)) AS reason
             ^
[0m20:17:39.555639 [info ] [MainThread]: 
[0m20:17:39.555779 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(first_name)) AS first_name,
    INITCAP(TRIM(last_name)) AS last_name,
    LOWER(TRIM(email)) AS email,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_customers"
    );
  ...
            ^
[0m20:17:39.555897 [info ] [MainThread]: 
[0m20:17:39.556046 [error] [MainThread]:   Runtime Error in model stg_products (models/staging/stg_products.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(product_name)) AS product_name,
    INITCAP(TRIM(category)) AS category,
    CAST(price AS DECIMAL(10,2)) AS price,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_products"
    );
  ...
            ^
[0m20:17:39.556175 [info ] [MainThread]: 
[0m20:17:39.556315 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m20:17:39.557585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6264653, "process_user_time": 0.97362, "process_kernel_time": 0.119797, "process_mem_max_rss": "134201344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:17:39.557784 [debug] [MainThread]: Command `dbt run` failed at 20:17:39.557750 after 0.63 seconds
[0m20:17:39.557940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eaddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a0550>]}
[0m20:17:39.558081 [debug] [MainThread]: Flushing usage events
[0m20:18:35.434026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887f880>]}


============================== 20:18:35.437150 | 7987019c-2064-4515-b671-6fdba9b53239 ==============================
[0m20:18:35.437150 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:18:35.437408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:18:35.556713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894c2e0>]}
[0m20:18:35.577058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894c0a0>]}
[0m20:18:35.577483 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:18:35.585737 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:18:35.652621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:35.652949 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_inventory_transactions.sql
[0m20:18:35.755236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec57e0>]}
[0m20:18:35.806932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eaac50>]}
[0m20:18:35.807175 [info ] [MainThread]: Found 8 seeds, 8 models, 5 data tests, 422 macros
[0m20:18:35.807330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eaac20>]}
[0m20:18:35.808055 [info ] [MainThread]: 
[0m20:18:35.808278 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:18:35.810539 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:18:35.834666 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:18:35.834865 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:18:35.834991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:35.843473 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:18:35.844014 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:18:35.845076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:18:35.845306 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:18:35.848148 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:18:35.848290 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:18:35.848404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:35.850580 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:18:35.851097 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:18:35.851216 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:18:35.851347 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:18:35.851458 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:18:35.851578 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:18:35.851779 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:18:35.852099 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:18:35.852224 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:18:35.852329 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:18:35.852455 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:18:35.852575 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:18:35.853743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:18:35.855982 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:18:35.856107 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:18:35.856211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:35.858072 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:18:35.858201 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:18:35.858332 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:18:35.867024 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:18:35.869092 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:18:35.869628 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:18:35.869748 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:18:35.871045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071513c0>]}
[0m20:18:35.871258 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:35.871383 [debug] [MainThread]: On master: BEGIN
[0m20:18:35.871488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:35.873244 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:18:35.873381 [debug] [MainThread]: On master: COMMIT
[0m20:18:35.873501 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:35.873608 [debug] [MainThread]: On master: COMMIT
[0m20:18:35.873732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:18:35.873849 [debug] [MainThread]: On master: Close
[0m20:18:35.874291 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:18:35.874443 [info ] [MainThread]: 
[0m20:18:35.876134 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:18:35.876303 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:18:35.876475 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:18:35.876639 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:18:35.876788 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:18:35.876927 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:18:35.877136 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m20:18:35.877333 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:18:35.877492 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:18:35.877686 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_inventory ................................. [RUN]
[0m20:18:35.877916 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_inventory_transactions .................... [RUN]
[0m20:18:35.878142 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_order_details ............................. [RUN]
[0m20:18:35.878351 [info ] [Thread-5 (]: 5 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m20:18:35.878554 [info ] [Thread-6 (]: 6 of 8 START sql view model main.stg_products .................................. [RUN]
[0m20:18:35.878757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:18:35.879000 [info ] [Thread-7 (]: 7 of 8 START sql view model main.stg_supplier_products ......................... [RUN]
[0m20:18:35.879212 [info ] [Thread-8 (]: 8 of 8 START sql view model main.stg_suppliers ................................. [RUN]
[0m20:18:35.879423 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:18:35.879625 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:18:35.879826 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:18:35.880002 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:18:35.880180 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:18:35.880336 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:18:35.880547 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:18:35.880760 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:18:35.880916 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:18:35.881062 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:18:35.881212 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:18:35.881354 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:18:35.881497 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:18:35.885040 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:18:35.885213 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:18:35.885364 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:18:35.886448 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:18:35.888042 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:18:35.908981 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:18:35.910823 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:18:35.911808 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:18:35.912951 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:18:35.913989 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:18:35.914207 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:18:35.914481 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:18:35.914727 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:18:35.914885 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:18:35.915044 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:18:35.915254 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:18:35.927967 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:18:35.929895 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:18:35.930027 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:18:35.931366 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:18:35.932671 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:18:35.932821 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:18:35.934179 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:18:35.935542 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:18:35.937059 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:18:35.937293 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:18:35.937448 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:18:35.939088 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:18:35.939329 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:18:35.939483 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:18:35.939666 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:18:35.939866 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:18:35.940054 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:18:35.940210 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:18:35.940359 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:18:35.940545 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:18:35.940705 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:18:35.940855 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:18:35.941013 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:18:35.941165 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:18:35.941322 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:18:35.941469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:35.941617 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:18:35.941747 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:18:35.941870 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:18:35.942001 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:18:35.942152 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:18:35.944180 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:18:35.944335 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:18:35.944514 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:18:35.944667 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:18:35.944891 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:18:35.945053 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m20:18:35.945202 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:18:35.945343 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:18:35.945523 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:18:35.945663 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.945842 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:18:35.945975 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.946117 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:18:35.946264 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:18:35.946452 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:18:35.946586 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.946731 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:18:35.946868 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:18:35.947026 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  CAST(customer_id AS INTEGER) AS customer_id,
  INITCAP(TRIM(first_name)) AS first_name,
  INITCAP(TRIM(last_name)) AS last_name,
  LOWER(TRIM(email)) AS email,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:18:35.947188 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:18:35.947357 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:18:35.947531 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:18:35.947698 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:18:35.947852 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:18:35.948024 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  INITCAP(TRIM(product_name)) AS product_name,
  INITCAP(TRIM(category)) AS category,
  CAST(price AS DECIMAL(10,2)) AS price,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:18:35.948222 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:18:35.948365 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.948601 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:18:35.948861 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.948994 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.951898 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:18:35.952043 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:18:35.952292 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  CAST(customer_id AS INTEGER) AS customer_id,
  INITCAP(TRIM(first_name)) AS first_name,
  INITCAP(TRIM(last_name)) AS last_name,
  LOWER(TRIM(email)) AS email,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:18:35.952521 [debug] [Thread-6 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  INITCAP(TRIM(product_name)) AS product_name,
  INITCAP(TRIM(category)) AS category,
  CAST(price AS DECIMAL(10,2)) AS price,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:18:35.952685 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m20:18:35.954007 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:18:35.954158 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.955324 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:18:35.955465 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:18:35.956582 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:18:35.956749 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:18:35.956901 [debug] [Thread-6 (]: DuckDB adapter: Rolling back transaction.
[0m20:18:35.958078 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:18:35.958237 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m20:18:35.959523 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:18:35.959675 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:18:35.959869 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m20:18:35.960103 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m20:18:35.960257 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.960458 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: ROLLBACK
[0m20:18:35.960627 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m20:18:35.960833 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:18:35.960975 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.961166 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.961344 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.962940 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:18:35.964191 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:18:35.964323 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.964518 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.965735 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:18:35.971922 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:18:35.972171 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:18:35.972358 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:18:35.973493 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:18:35.974666 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:18:35.974881 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:18:35.975063 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:18:35.975320 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.975504 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:18:35.975676 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.975858 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:18:35.976161 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.976338 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:18:35.977733 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:18:35.978401 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:18:35.978555 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.979185 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:18:35.979306 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.979549 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:18:35.979750 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.979964 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:18:35.980562 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:18:35.980790 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:18:35.981344 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:18:35.981564 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:18:35.983565 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:18:35.983782 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:18:35.984081 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:18:35.984256 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:18:35.984604 [debug] [Thread-6 (]: Failed to rollback 'model.jaffle_shop.stg_products'
[0m20:18:35.984960 [debug] [Thread-1 (]: Failed to rollback 'model.jaffle_shop.stg_customers'
[0m20:18:35.985101 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:18:35.985295 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m20:18:35.985439 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.985625 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:18:35.985763 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.985949 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:18:35.986091 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.986249 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:18:35.986405 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:18:35.987925 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:18:35.988118 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:18:35.989113 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:18:35.989245 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.990329 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:18:35.990717 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:18:35.991041 [debug] [Thread-6 (]: Runtime Error in model stg_products (models/staging/stg_products.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(product_name)) AS product_name,
    INITCAP(TRIM(category)) AS category,
    CAST(price AS DECIMAL(10,2)) AS price,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_products"
    );
  ...
            ^
[0m20:18:35.991193 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.992153 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:18:35.992352 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:18:35.992683 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(first_name)) AS first_name,
    INITCAP(TRIM(last_name)) AS last_name,
    LOWER(TRIM(email)) AS email,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_customers"
    );
  ...
            ^
[0m20:18:35.993648 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:18:35.993798 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:18:35.994425 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb8400>]}
[0m20:18:35.995385 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:18:35.995599 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ad990>]}
[0m20:18:35.995747 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:18:35.995934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e60790>]}
[0m20:18:35.996105 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:18:35.996250 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.996542 [error] [Thread-6 (]: 6 of 8 ERROR creating sql view model main.stg_products ......................... [[31mERROR[0m in 0.11s]
[0m20:18:35.996756 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:18:35.996905 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m20:18:35.997183 [info ] [Thread-3 (]: 3 of 8 OK created sql view model main.stg_inventory_transactions ............... [[32mOK[0m in 0.12s]
[0m20:18:35.997707 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:18:35.997940 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.12s]
[0m20:18:35.998485 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:18:35.998742 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:18:35.998892 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:18:35.999365 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:18:35.999624 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:18:35.999848 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093addb0>]}
[0m20:18:36.000002 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m20:18:36.000234 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:18:36.000435 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093add20>]}
[0m20:18:36.001025 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:18:36.001221 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094136a0>]}
[0m20:18:36.001523 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_inventory ............................ [[32mOK[0m in 0.12s]
[0m20:18:36.002052 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:18:36.002365 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_order_details ........................ [[32mOK[0m in 0.12s]
[0m20:18:36.002583 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d5990>]}
[0m20:18:36.002809 [info ] [Thread-5 (]: 5 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.12s]
[0m20:18:36.003059 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:18:36.005149 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7987019c-2064-4515-b671-6fdba9b53239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109407bb0>]}
[0m20:18:36.005373 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:18:36.005618 [info ] [Thread-7 (]: 7 of 8 OK created sql view model main.stg_supplier_products .................... [[32mOK[0m in 0.12s]
[0m20:18:36.005853 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:18:36.006126 [info ] [Thread-8 (]: 8 of 8 OK created sql view model main.stg_suppliers ............................ [[32mOK[0m in 0.12s]
[0m20:18:36.006422 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:18:36.006678 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:18:36.007437 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:36.007576 [debug] [MainThread]: On master: BEGIN
[0m20:18:36.007685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:36.009602 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:18:36.009733 [debug] [MainThread]: On master: COMMIT
[0m20:18:36.009846 [debug] [MainThread]: Using duckdb connection "master"
[0m20:18:36.009944 [debug] [MainThread]: On master: COMMIT
[0m20:18:36.010067 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:18:36.010183 [debug] [MainThread]: On master: Close
[0m20:18:36.010587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:36.010705 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:18:36.010805 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m20:18:36.010901 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:18:36.010993 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:18:36.011088 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:18:36.011179 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m20:18:36.011273 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:18:36.011363 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:18:36.011514 [info ] [MainThread]: 
[0m20:18:36.011644 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:18:36.012252 [debug] [MainThread]: Command end result
[0m20:18:36.029823 [info ] [MainThread]: 
[0m20:18:36.030039 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:18:36.030167 [info ] [MainThread]: 
[0m20:18:36.030321 [error] [MainThread]:   Runtime Error in model stg_products (models/staging/stg_products.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(product_name)) AS product_name,
    INITCAP(TRIM(category)) AS category,
    CAST(price AS DECIMAL(10,2)) AS price,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_products"
    );
  ...
            ^
[0m20:18:36.030444 [info ] [MainThread]: 
[0m20:18:36.030585 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(first_name)) AS first_name,
    INITCAP(TRIM(last_name)) AS last_name,
    LOWER(TRIM(email)) AS email,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_customers"
    );
  ...
            ^
[0m20:18:36.030707 [info ] [MainThread]: 
[0m20:18:36.030826 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m20:18:36.032215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6264304, "process_user_time": 0.975273, "process_kernel_time": 0.118565, "process_mem_max_rss": "134201344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:18:36.032426 [debug] [MainThread]: Command `dbt run` failed at 20:18:36.032387 after 0.63 seconds
[0m20:18:36.032585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108842e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950c3d0>]}
[0m20:18:36.032724 [debug] [MainThread]: Flushing usage events
[0m20:20:22.137366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10279e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc38b0>]}


============================== 20:20:22.146517 | ac2a0183-85b3-4d7b-bb9f-760fc8417aa7 ==============================
[0m20:20:22.146517 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:20:22.146846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:22.284303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f86ad0>]}
[0m20:20:22.305401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033cb430>]}
[0m20:20:22.305961 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:20:22.315010 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:20:22.383655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:20:22.383956 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/initcap.sql
[0m20:20:22.384131 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_products.sql
[0m20:20:22.489139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e69b0>]}
[0m20:20:22.542189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045938b0>]}
[0m20:20:22.542456 [info ] [MainThread]: Found 8 seeds, 8 models, 5 data tests, 423 macros
[0m20:20:22.542609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104593910>]}
[0m20:20:22.543331 [info ] [MainThread]: 
[0m20:20:22.543565 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:20:22.545842 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:20:22.570688 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:20:22.570888 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:20:22.571016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:22.579465 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:20:22.580016 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:20:22.581025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:20:22.581254 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:20:22.584085 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:20:22.584228 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:20:22.584342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:22.586443 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:20:22.586950 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:20:22.587070 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:20:22.587201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:20:22.587314 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:20:22.587433 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:20:22.587615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:20:22.587929 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:20:22.588042 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:20:22.588144 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:20:22.588269 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:20:22.588389 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:20:22.589495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:20:22.591726 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:20:22.591852 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:20:22.591955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:22.593779 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:20:22.593910 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:20:22.594036 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:20:22.604536 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:20:22.606695 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:20:22.607389 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:20:22.607507 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:20:22.608876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dd5a0>]}
[0m20:20:22.609164 [debug] [MainThread]: Using duckdb connection "master"
[0m20:20:22.609284 [debug] [MainThread]: On master: BEGIN
[0m20:20:22.609394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:22.611161 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:20:22.611295 [debug] [MainThread]: On master: COMMIT
[0m20:20:22.611416 [debug] [MainThread]: Using duckdb connection "master"
[0m20:20:22.611528 [debug] [MainThread]: On master: COMMIT
[0m20:20:22.611655 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:20:22.611775 [debug] [MainThread]: On master: Close
[0m20:20:22.612192 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:20:22.612348 [info ] [MainThread]: 
[0m20:20:22.614185 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:20:22.614351 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:20:22.614512 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:20:22.614668 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:20:22.614814 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:20:22.615196 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:20:22.615048 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m20:20:22.615366 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:20:22.615510 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:20:22.615706 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_inventory ................................. [RUN]
[0m20:20:22.615937 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_inventory_transactions .................... [RUN]
[0m20:20:22.616161 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_order_details ............................. [RUN]
[0m20:20:22.616388 [info ] [Thread-5 (]: 5 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m20:20:22.616598 [info ] [Thread-6 (]: 6 of 8 START sql view model main.stg_products .................................. [RUN]
[0m20:20:22.616828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:20:22.617031 [info ] [Thread-7 (]: 7 of 8 START sql view model main.stg_supplier_products ......................... [RUN]
[0m20:20:22.617249 [info ] [Thread-8 (]: 8 of 8 START sql view model main.stg_suppliers ................................. [RUN]
[0m20:20:22.617492 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:20:22.617714 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:20:22.617913 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:20:22.618100 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:20:22.618335 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:20:22.618503 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:20:22.618715 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:20:22.618915 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:20:22.619065 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:20:22.619216 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:20:22.619365 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:20:22.619516 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:20:22.619658 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:20:22.623542 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:20:22.623717 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:20:22.623855 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:20:22.625433 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:20:22.646867 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:20:22.647963 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:20:22.649417 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:20:22.651235 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:20:22.652434 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:20:22.653628 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:20:22.653921 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:20:22.654195 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:20:22.654566 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:20:22.654704 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:20:22.654832 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:20:22.668440 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:20:22.668639 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:20:22.668816 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:20:22.668974 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:20:22.670633 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:20:22.671995 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:20:22.673351 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:20:22.674636 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:20:22.676065 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:20:22.677747 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:20:22.679193 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:20:22.679362 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:20:22.679708 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:20:22.679914 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:20:22.680072 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:20:22.680372 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:20:22.680532 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:20:22.680684 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:20:22.680874 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:20:22.681025 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:20:22.681182 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:20:22.681334 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:20:22.681489 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:20:22.681641 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:20:22.681789 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:20:22.681939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:22.682085 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:20:22.682236 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:20:22.682382 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:20:22.682524 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:20:22.682664 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:20:22.682808 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:20:22.682953 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:20:22.685060 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:20:22.685238 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:20:22.685423 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:20:22.685556 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:20:22.685777 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:20:22.685927 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:20:22.686123 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m20:20:22.686289 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:20:22.686426 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m20:20:22.686601 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:20:22.686746 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m20:20:22.686929 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:20:22.687062 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:20:22.687214 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:20:22.687372 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:20:22.687537 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  CAST(customer_id AS INTEGER) AS customer_id,
  INITCAP(TRIM(first_name)) AS first_name,
  INITCAP(TRIM(last_name)) AS last_name,
  LOWER(TRIM(email)) AS email,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:20:22.687702 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:20:22.687862 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:20:22.688026 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:20:22.688189 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:20:22.688352 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:20:22.688516 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:20:22.688698 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  
  TRY_CAST(product_id AS INTEGER)
 AS product_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))
 AS product_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))
 AS category,
  
  TRY_CAST(price AS DECIMAL(10,2))
 AS price,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:20:22.688901 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:20:22.689096 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:20:22.689294 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:20:22.689488 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.689654 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.689793 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.689950 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.690132 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.693165 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:20:22.693316 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m20:20:22.693544 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  CAST(customer_id AS INTEGER) AS customer_id,
  INITCAP(TRIM(first_name)) AS first_name,
  INITCAP(TRIM(last_name)) AS last_name,
  LOWER(TRIM(email)) AS email,
  CAST(created_at AS TIMESTAMP) AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:20:22.693718 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m20:20:22.694977 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:20:22.696190 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:20:22.697351 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:20:22.698491 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:20:22.698645 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:20:22.700229 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:20:22.700384 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:20:22.701598 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:20:22.701759 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions" rename to "stg_inventory_transactions__dbt_backup"
[0m20:20:22.701928 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m20:20:22.702086 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:20:22.702236 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:20:22.702419 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m20:20:22.702650 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m20:20:22.702824 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:20:22.702969 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:20:22.703184 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.703361 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.703498 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.703656 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.703848 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.705084 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:20:22.706239 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:20:22.706372 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:20:22.707521 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:20:22.713700 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:20:22.714901 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:20:22.716363 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:20:22.716544 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:20:22.716746 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m20:20:22.717825 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:20:22.718049 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:20:22.718223 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:20:22.718380 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:20:22.718576 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:20:22.718833 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:20:22.718985 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.719120 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.719323 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:20:22.719487 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.719760 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.719943 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.721264 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:20:22.721408 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:20:22.722023 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:20:22.722659 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:20:22.722804 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:20:22.723339 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:20:22.723866 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:20:22.724059 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:20:22.724570 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:20:22.724743 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:20:22.724902 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:20:22.726889 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:20:22.727059 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:20:22.727270 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:20:22.727428 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:20:22.727578 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:20:22.727724 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:20:22.727895 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:20:22.728048 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
drop view if exists "jaffle_shop"."main"."stg_products__dbt_backup" cascade
[0m20:20:22.728232 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:20:22.728385 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:20:22.728578 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:20:22.728721 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.729018 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.729203 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.729374 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.729613 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.729976 [debug] [Thread-1 (]: Failed to rollback 'model.jaffle_shop.stg_customers'
[0m20:20:22.730138 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:20:22.731177 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:20:22.731327 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:20:22.732253 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:20:22.733150 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:20:22.734157 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:20:22.735101 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:20:22.735259 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:20:22.736639 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:20:22.736788 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:20:22.737739 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:20:22.737897 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m20:20:22.738061 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:20:22.738724 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af9780>]}
[0m20:20:22.738891 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:20:22.739257 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:20:22.739695 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(first_name)) AS first_name,
    INITCAP(TRIM(last_name)) AS last_name,
    LOWER(TRIM(email)) AS email,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_customers"
    );
  ...
            ^
[0m20:20:22.739865 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m20:20:22.740010 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:20:22.740489 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.740345 [info ] [Thread-6 (]: 6 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.12s]
[0m20:20:22.740743 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:20:22.740904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463b850>]}
[0m20:20:22.741121 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:20:22.741629 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:20:22.741752 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:20:22.742263 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:20:22.742498 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:20:22.742653 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:20:22.743130 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:20:22.743370 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.12s]
[0m20:20:22.743916 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:20:22.744102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afaa10>]}
[0m20:20:22.744591 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:20:22.744783 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afa590>]}
[0m20:20:22.745386 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:20:22.745591 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afa980>]}
[0m20:20:22.745829 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:20:22.746024 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afad70>]}
[0m20:20:22.746273 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_inventory ............................ [[32mOK[0m in 0.13s]
[0m20:20:22.746477 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afaaa0>]}
[0m20:20:22.746729 [info ] [Thread-3 (]: 3 of 8 OK created sql view model main.stg_inventory_transactions ............... [[32mOK[0m in 0.13s]
[0m20:20:22.748960 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2a0183-85b3-4d7b-bb9f-760fc8417aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aface0>]}
[0m20:20:22.749214 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_order_details ........................ [[32mOK[0m in 0.13s]
[0m20:20:22.749545 [info ] [Thread-7 (]: 7 of 8 OK created sql view model main.stg_supplier_products .................... [[32mOK[0m in 0.13s]
[0m20:20:22.749813 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:20:22.750063 [info ] [Thread-5 (]: 5 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.13s]
[0m20:20:22.750326 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:20:22.750564 [info ] [Thread-8 (]: 8 of 8 OK created sql view model main.stg_suppliers ............................ [[32mOK[0m in 0.13s]
[0m20:20:22.750825 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:20:22.751041 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:20:22.751299 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:20:22.751579 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:20:22.752368 [debug] [MainThread]: Using duckdb connection "master"
[0m20:20:22.752502 [debug] [MainThread]: On master: BEGIN
[0m20:20:22.752619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:22.754621 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:20:22.754762 [debug] [MainThread]: On master: COMMIT
[0m20:20:22.754876 [debug] [MainThread]: Using duckdb connection "master"
[0m20:20:22.754978 [debug] [MainThread]: On master: COMMIT
[0m20:20:22.755101 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:20:22.755221 [debug] [MainThread]: On master: Close
[0m20:20:22.755677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:22.755790 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:20:22.755888 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m20:20:22.755981 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:20:22.756071 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:20:22.756163 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:20:22.756252 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m20:20:22.756343 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:20:22.756431 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:20:22.756582 [info ] [MainThread]: 
[0m20:20:22.756712 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m20:20:22.757280 [debug] [MainThread]: Command end result
[0m20:20:22.774354 [info ] [MainThread]: 
[0m20:20:22.774562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:20:22.774687 [info ] [MainThread]: 
[0m20:20:22.774857 [error] [MainThread]:   Runtime Error in model stg_customers (models/staging/stg_customers.sql)
  Catalog Error: Scalar Function with name initcap does not exist!
  Did you mean "bin"?
  LINE 7:   INITCAP(TRIM(first_name)) AS first_name,
    INITCAP(TRIM(last_name)) AS last_name,
    LOWER(TRIM(email)) AS email,
    CAST(created_at AS TIMESTAMP) AS created_at
  FROM "jaffle_shop"."main"."raw_customers"
    );
  ...
            ^
[0m20:20:22.775000 [info ] [MainThread]: 
[0m20:20:22.775137 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m20:20:22.776438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.67227346, "process_user_time": 0.979901, "process_kernel_time": 0.122786, "process_mem_max_rss": "136445952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:20:22.776654 [debug] [MainThread]: Command `dbt run` failed at 20:20:22.776614 after 0.67 seconds
[0m20:20:22.776814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10279e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103411db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b41fc0>]}
[0m20:20:22.776958 [debug] [MainThread]: Flushing usage events
[0m20:21:52.631678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103722950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105307fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053078b0>]}


============================== 20:21:52.635070 | 8cc177f7-24ea-4d0f-a56e-cf927421cd8b ==============================
[0m20:21:52.635070 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:21:52.635337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:21:52.757508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052faad0>]}
[0m20:21:52.778175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434f430>]}
[0m20:21:52.778774 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:21:52.786980 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:21:52.855378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:21:52.855714 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_customers.sql
[0m20:21:52.946990 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:21:52.947282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ebb80>]}
[0m20:21:53.017136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf4130>]}
[0m20:21:53.070746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf86a0>]}
[0m20:21:53.070993 [info ] [MainThread]: Found 8 seeds, 8 models, 5 data tests, 423 macros
[0m20:21:53.071149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab16f0>]}
[0m20:21:53.071876 [info ] [MainThread]: 
[0m20:21:53.072111 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:21:53.074596 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:21:53.119401 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:21:53.119614 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:21:53.119745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:53.128153 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:21:53.128679 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:21:53.129764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:21:53.130005 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:21:53.132977 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:21:53.133123 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:21:53.133240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:53.135410 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:21:53.135916 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:21:53.136034 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:21:53.136163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:53.136275 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:21:53.136391 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:21:53.136587 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:53.136902 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:21:53.137012 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:21:53.137113 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:21:53.137238 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:53.137355 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:21:53.138486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:21:53.141075 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:21:53.141217 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:21:53.141332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:53.143223 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:21:53.143346 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:21:53.143466 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:21:53.152278 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:21:53.154432 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:21:53.154963 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:21:53.155087 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:21:53.156531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038093c0>]}
[0m20:21:53.156759 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:53.156887 [debug] [MainThread]: On master: BEGIN
[0m20:21:53.156998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:21:53.158886 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:21:53.159028 [debug] [MainThread]: On master: COMMIT
[0m20:21:53.159149 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:53.159257 [debug] [MainThread]: On master: COMMIT
[0m20:21:53.159384 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:53.159506 [debug] [MainThread]: On master: Close
[0m20:21:53.159998 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:21:53.160145 [info ] [MainThread]: 
[0m20:21:53.161827 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:21:53.161997 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:21:53.162169 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:21:53.162340 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:21:53.162481 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:21:53.162835 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:21:53.162695 [info ] [Thread-1 (]: 1 of 8 START sql view model main.stg_customers ................................. [RUN]
[0m20:21:53.163067 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:21:53.163226 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:21:53.163447 [info ] [Thread-2 (]: 2 of 8 START sql view model main.stg_inventory ................................. [RUN]
[0m20:21:53.163670 [info ] [Thread-3 (]: 3 of 8 START sql view model main.stg_inventory_transactions .................... [RUN]
[0m20:21:53.163889 [info ] [Thread-4 (]: 4 of 8 START sql view model main.stg_order_details ............................. [RUN]
[0m20:21:53.164095 [info ] [Thread-5 (]: 5 of 8 START sql view model main.stg_orders .................................... [RUN]
[0m20:21:53.164317 [info ] [Thread-6 (]: 6 of 8 START sql view model main.stg_products .................................. [RUN]
[0m20:21:53.164535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:21:53.164738 [info ] [Thread-7 (]: 7 of 8 START sql view model main.stg_supplier_products ......................... [RUN]
[0m20:21:53.164955 [info ] [Thread-8 (]: 8 of 8 START sql view model main.stg_suppliers ................................. [RUN]
[0m20:21:53.165190 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:21:53.165392 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:21:53.165601 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:21:53.165788 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:21:53.165995 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:21:53.166151 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:21:53.166348 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:21:53.166536 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:21:53.166682 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:21:53.166828 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:21:53.166968 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:21:53.167108 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:21:53.167258 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:21:53.171285 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:21:53.171454 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:21:53.171593 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:21:53.172712 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:21:53.173808 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:21:53.174898 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:21:53.176415 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:21:53.178608 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:21:53.179747 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:21:53.180812 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:21:53.181034 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:21:53.181258 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:21:53.194642 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:21:53.196126 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:21:53.196354 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:21:53.196551 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:21:53.196680 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:21:53.196884 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:21:53.197036 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:21:53.199074 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:21:53.199223 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:21:53.199429 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:21:53.200855 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:21:53.202263 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:21:53.202420 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:21:53.203737 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:21:53.205014 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:21:53.206539 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:21:53.206710 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:21:53.206913 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:21:53.207128 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:21:53.207287 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:21:53.207537 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:21:53.207745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:53.207922 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:21:53.208070 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:21:53.208228 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:21:53.208399 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:21:53.208532 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:21:53.208678 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:21:53.208821 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:21:53.210926 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:21:53.211080 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:21:53.211247 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:21:53.211401 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:21:53.211548 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:21:53.211724 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:21:53.211876 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:21:53.212006 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:21:53.212143 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:21:53.212287 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:21:53.212462 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:21:53.212606 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.212735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:21:53.212904 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:21:53.213046 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.213256 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.213407 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(first_name), 1, 1)), LOWER(SUBSTRING(TRIM(first_name), 2)))
 AS first_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(last_name), 1, 1)), LOWER(SUBSTRING(TRIM(last_name), 2)))
 AS last_name,
  LOWER(TRIM(email)) AS email,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:21:53.213554 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.213737 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:21:53.213865 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.214056 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:21:53.214202 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.214339 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:21:53.214490 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:21:53.214664 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:21:53.214819 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:21:53.214974 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:21:53.215141 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.215307 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:21:53.215458 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.215603 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:21:53.215797 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  
  TRY_CAST(product_id AS INTEGER)
 AS product_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))
 AS product_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))
 AS category,
  
  TRY_CAST(price AS DECIMAL(10,2))
 AS price,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:21:53.215995 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:21:53.216182 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:21:53.219048 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:21:53.219238 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:21:53.219392 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m20:21:53.220648 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:21:53.220942 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.221119 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:21:53.221290 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.221442 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.221589 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.222829 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:21:53.222978 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.223123 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:21:53.224349 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:21:53.225665 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:21:53.226819 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:21:53.226965 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:21:53.228096 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:21:53.228255 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:21:53.229696 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:21:53.229895 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:21:53.230036 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.230208 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m20:21:53.230391 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m20:21:53.236462 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:21:53.236647 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:21:53.236834 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions" rename to "stg_inventory_transactions__dbt_backup"
[0m20:21:53.238028 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:21:53.238163 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.238302 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.238528 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:21:53.238668 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.238794 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.239024 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:21:53.239152 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.239280 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.240355 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:21:53.241432 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:21:53.241599 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:21:53.242720 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:21:53.243829 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:21:53.245062 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:21:53.245208 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.246315 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:21:53.246471 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:21:53.246625 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:21:53.246827 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:21:53.247005 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:21:53.247482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.247625 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m20:21:53.248925 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:21:53.249074 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:21:53.249293 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.249433 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.249583 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.251591 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:21:53.251733 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:21:53.251911 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:21:53.252458 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:21:53.252968 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:21:53.253106 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.253244 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.253742 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:21:53.253892 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m20:21:53.254397 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:21:53.254539 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:21:53.254686 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:21:53.254838 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:21:53.255321 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:21:53.255878 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:21:53.256024 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:21:53.256185 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:21:53.256342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.256495 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:21:53.256634 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.256776 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:21:53.256920 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:21:53.257063 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:21:53.257202 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:21:53.257338 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:21:53.258283 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:21:53.259316 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:21:53.259451 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.259621 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:21:53.259760 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.259905 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:21:53.260653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3b520>]}
[0m20:21:53.260843 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.260983 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.261126 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:21:53.262121 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:21:53.263114 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:21:53.263250 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.263575 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.10s]
[0m20:21:53.263759 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.264714 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:21:53.265698 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:21:53.265874 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m20:21:53.266040 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:21:53.267349 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:21:53.267483 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:21:53.267750 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:21:53.268718 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:21:53.268861 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:21:53.269014 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:21:53.269231 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m20:21:53.269755 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:21:53.269897 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.270045 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.270259 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
drop view if exists "jaffle_shop"."main"."stg_products__dbt_backup" cascade
[0m20:21:53.270510 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.270719 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb46a0>]}
[0m20:21:53.270866 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:21:53.271370 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:21:53.271848 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:21:53.271990 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:21:53.272501 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:21:53.272889 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:21:53.272764 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main.stg_inventory ............................ [[32mOK[0m in 0.11s]
[0m20:21:53.273404 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:21:53.273599 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a38610>]}
[0m20:21:53.273807 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a39090>]}
[0m20:21:53.274284 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:21:53.274465 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a391b0>]}
[0m20:21:53.274946 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:21:53.275161 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:21:53.275346 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a38af0>]}
[0m20:21:53.275589 [info ] [Thread-5 (]: 5 of 8 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.11s]
[0m20:21:53.275856 [info ] [Thread-8 (]: 8 of 8 OK created sql view model main.stg_suppliers ............................ [[32mOK[0m in 0.11s]
[0m20:21:53.276072 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a388b0>]}
[0m20:21:53.276300 [info ] [Thread-7 (]: 7 of 8 OK created sql view model main.stg_supplier_products .................... [[32mOK[0m in 0.11s]
[0m20:21:53.278480 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc177f7-24ea-4d0f-a56e-cf927421cd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a38c10>]}
[0m20:21:53.278808 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.stg_order_details ........................ [[32mOK[0m in 0.11s]
[0m20:21:53.279050 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:21:53.279276 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:21:53.279521 [info ] [Thread-3 (]: 3 of 8 OK created sql view model main.stg_inventory_transactions ............... [[32mOK[0m in 0.11s]
[0m20:21:53.279780 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:21:53.280018 [info ] [Thread-6 (]: 6 of 8 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.11s]
[0m20:21:53.280261 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:21:53.280579 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:21:53.280850 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:21:53.281595 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:53.281724 [debug] [MainThread]: On master: BEGIN
[0m20:21:53.281832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:21:53.283770 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:21:53.283899 [debug] [MainThread]: On master: COMMIT
[0m20:21:53.284019 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:53.284130 [debug] [MainThread]: On master: COMMIT
[0m20:21:53.284259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:53.284381 [debug] [MainThread]: On master: Close
[0m20:21:53.284801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:53.284923 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:21:53.285031 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m20:21:53.285140 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:21:53.285246 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:21:53.285350 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:21:53.285452 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m20:21:53.285548 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:21:53.285650 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:21:53.285842 [info ] [MainThread]: 
[0m20:21:53.285985 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m20:21:53.286587 [debug] [MainThread]: Command end result
[0m20:21:53.303932 [info ] [MainThread]: 
[0m20:21:53.304158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:21:53.304294 [info ] [MainThread]: 
[0m20:21:53.304434 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:21:53.305878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7029564, "process_user_time": 1.04952, "process_kernel_time": 0.116042, "process_mem_max_rss": "135708672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:21:53.306093 [debug] [MainThread]: Command `dbt run` succeeded at 20:21:53.306057 after 0.70 seconds
[0m20:21:53.306247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103722950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104395db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ccb50>]}
[0m20:21:53.306392 [debug] [MainThread]: Flushing usage events
[0m20:35:21.949415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a53f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a53880>]}


============================== 20:35:21.955773 | 3aa45aaf-b919-48ef-9fb7-d3c8ad6d55ef ==============================
[0m20:35:21.955773 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:35:21.956034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:35:22.103644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aa45aaf-b919-48ef-9fb7-d3c8ad6d55ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b242e0>]}
[0m20:35:22.124573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aa45aaf-b919-48ef-9fb7-d3c8ad6d55ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b240a0>]}
[0m20:35:22.125117 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:35:22.134058 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:35:22.204543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:35:22.204884 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:35:22.205024 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:35:22.205151 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:35:22.205270 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:35:22.205390 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:35:22.277821 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.customer_LTV' (models/customer_LTV.sql) depends on a node named 'fact_sales' which was not found
[0m20:35:22.279533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36437666, "process_user_time": 0.6915, "process_kernel_time": 0.099476, "process_mem_max_rss": "112869376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:35:22.279788 [debug] [MainThread]: Command `dbt run` failed at 20:35:22.279745 after 0.36 seconds
[0m20:35:22.279972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5b370>]}
[0m20:35:22.280127 [debug] [MainThread]: Flushing usage events
[0m20:36:39.007569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d22920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bb880>]}


============================== 20:36:39.011737 | 8de36c1f-aa4b-40fb-8356-5df638839cc5 ==============================
[0m20:36:39.011737 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:36:39.012024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:36:39.131296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8de36c1f-aa4b-40fb-8356-5df638839cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049082e0>]}
[0m20:36:39.151639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8de36c1f-aa4b-40fb-8356-5df638839cc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049080a0>]}
[0m20:36:39.152253 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:36:39.160036 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:36:39.227255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:36:39.227552 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:36:39.227695 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:36:39.227824 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:36:39.227944 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:36:39.228062 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:36:39.300388 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.avg_order_value' (models/avg_order_value.sql) depends on a node named 'fact_sales' which was not found
[0m20:36:39.302000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3273076, "process_user_time": 0.69518, "process_kernel_time": 0.084178, "process_mem_max_rss": "114737152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:36:39.302265 [debug] [MainThread]: Command `dbt run` failed at 20:36:39.302225 after 0.33 seconds
[0m20:36:39.302439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d22920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e43f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e43100>]}
[0m20:36:39.302592 [debug] [MainThread]: Flushing usage events
[0m20:37:37.418568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181228c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b77f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b77850>]}


============================== 20:37:37.425805 | 6c579c01-c3a7-40ce-985f-73e40aebccdb ==============================
[0m20:37:37.425805 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:37:37.426069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:37:37.577730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c579c01-c3a7-40ce-985f-73e40aebccdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c46ec0>]}
[0m20:37:37.599273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c579c01-c3a7-40ce-985f-73e40aebccdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c45300>]}
[0m20:37:37.599842 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:37:37.608079 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:37:37.679953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:37:37.680229 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:37:37.680367 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:37:37.680492 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:37:37.680610 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:37:37.680728 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:37:37.752485 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.customer_LTV' (models/customer_LTV.sql) depends on a node named 'dim_customers' which was not found
[0m20:37:37.754090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.37159926, "process_user_time": 0.71041, "process_kernel_time": 0.097219, "process_mem_max_rss": "112869376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:37:37.754345 [debug] [MainThread]: Command `dbt run` failed at 20:37:37.754303 after 0.37 seconds
[0m20:37:37.754523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181228c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2fcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2fd2d0>]}
[0m20:37:37.754677 [debug] [MainThread]: Flushing usage events
[0m20:38:31.594445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043da8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bffe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bff7c0>]}


============================== 20:38:31.602334 | 38b6cab9-45c2-4ce6-bc66-15ab214674d2 ==============================
[0m20:38:31.602334 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:38:31.602647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:38:31.744171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38b6cab9-45c2-4ce6-bc66-15ab214674d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105031ae0>]}
[0m20:38:31.765245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38b6cab9-45c2-4ce6-bc66-15ab214674d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cccca0>]}
[0m20:38:31.765775 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:38:31.773761 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:38:31.845863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:38:31.846145 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:38:31.846287 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:38:31.846415 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:38:31.846537 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:38:31.846663 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:38:31.919692 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.avg_order_value' (models/avg_order_value.sql) depends on a node named 'fact_sales' which was not found
[0m20:38:31.921180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36296958, "process_user_time": 0.714195, "process_kernel_time": 0.09604, "process_mem_max_rss": "115048448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:38:31.921445 [debug] [MainThread]: Command `dbt run` failed at 20:38:31.921404 after 0.36 seconds
[0m20:38:31.921616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043da8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bed70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bcbe0>]}
[0m20:38:31.921769 [debug] [MainThread]: Flushing usage events
[0m20:39:25.365074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d22920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104747f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104747880>]}


============================== 20:39:25.368718 | 242d1222-0e61-4f48-874c-bd9c6fd2894f ==============================
[0m20:39:25.368718 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:39:25.369017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:39:25.490397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '242d1222-0e61-4f48-874c-bd9c6fd2894f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0c2e0>]}
[0m20:39:25.511044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '242d1222-0e61-4f48-874c-bd9c6fd2894f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0c0a0>]}
[0m20:39:25.511476 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:39:25.519080 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:39:25.588844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:39:25.589136 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:39:25.589280 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:39:25.589409 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:39:25.589533 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:39:25.589667 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:39:25.661314 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.avg_order_value' (models/avg_order_value.sql) depends on a node named 'fact_sales' which was not found
[0m20:39:25.662820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.32647857, "process_user_time": 0.709361, "process_kernel_time": 0.086575, "process_mem_max_rss": "114573312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:39:25.663130 [debug] [MainThread]: Command `dbt run` failed at 20:39:25.663082 after 0.33 seconds
[0m20:39:25.663324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d22920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105143f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105143100>]}
[0m20:39:25.663501 [debug] [MainThread]: Flushing usage events
[0m20:40:18.039479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678f8b0>]}


============================== 20:40:18.045757 | 3f939f11-23ea-4408-bc46-f5f26925f1c7 ==============================
[0m20:40:18.045757 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:40:18.046063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:18.186176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f939f11-23ea-4408-bc46-f5f26925f1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674ead0>]}
[0m20:40:18.206719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f939f11-23ea-4408-bc46-f5f26925f1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b97430>]}
[0m20:40:18.207281 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:40:18.215135 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:40:18.284145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:40:18.284438 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:40:18.284582 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:40:18.284708 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:40:18.284833 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:40:18.284953 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:40:18.357024 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.avg_order_value' (models/avg_order_value.sql) depends on a node named 'fact_sales' which was not found
[0m20:40:18.358556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34921667, "process_user_time": 0.709911, "process_kernel_time": 0.097293, "process_mem_max_rss": "114606080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:18.358830 [debug] [MainThread]: Command `dbt run` failed at 20:40:18.358785 after 0.35 seconds
[0m20:40:18.359010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4fa00>]}
[0m20:40:18.359167 [debug] [MainThread]: Flushing usage events
[0m20:40:36.670254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e68f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0b850>]}


============================== 20:40:36.673635 | 29b9ea78-affb-42d4-8d07-ea6f76e81560 ==============================
[0m20:40:36.673635 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:40:36.673924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:40:36.798536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29b9ea78-affb-42d4-8d07-ea6f76e81560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801b2e0>]}
[0m20:40:36.819055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29b9ea78-affb-42d4-8d07-ea6f76e81560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd82e0>]}
[0m20:40:36.819480 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:40:36.827261 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:40:36.902327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:40:36.902619 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:40:36.902779 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:40:36.902907 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:40:36.903029 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:40:36.903172 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:40:36.977409 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.top_category' (models/top_category.sql) depends on a node named 'fact_sales' which was not found
[0m20:40:36.978936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.337061, "process_user_time": 0.707697, "process_kernel_time": 0.091721, "process_mem_max_rss": "114032640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:36.979183 [debug] [MainThread]: Command `dbt run` failed at 20:40:36.979142 after 0.34 seconds
[0m20:40:36.979350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e68f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fa050>]}
[0m20:40:36.979503 [debug] [MainThread]: Flushing usage events
[0m20:40:46.072708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106053e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106053790>]}


============================== 20:40:46.075790 | 16db8edb-05ee-4494-81cc-b87981fde41b ==============================
[0m20:40:46.075790 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:40:46.076091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:40:46.159607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16db8edb-05ee-4494-81cc-b87981fde41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048afeb0>]}
[0m20:40:46.180380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16db8edb-05ee-4494-81cc-b87981fde41b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106120ca0>]}
[0m20:40:46.180948 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:40:46.187699 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:40:46.266922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:40:46.267312 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:40:46.267464 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:40:46.267610 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:40:46.267755 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:40:46.267909 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:40:46.341956 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.low_stock' (models/low_stock.sql) depends on a node named 'inventory_status' which was not found
[0m20:40:46.342818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29850546, "process_user_time": 0.719044, "process_kernel_time": 0.075894, "process_mem_max_rss": "113147904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:46.343068 [debug] [MainThread]: Command `dbt run` failed at 20:40:46.343027 after 0.30 seconds
[0m20:40:46.343251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650cbe0>]}
[0m20:40:46.343450 [debug] [MainThread]: Flushing usage events
[0m20:41:30.767642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b1bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b1b8b0>]}


============================== 20:41:30.773533 | 2587846d-c685-4256-8e17-e69386e8cea7 ==============================
[0m20:41:30.773533 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:41:30.773843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:41:30.914065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2587846d-c685-4256-8e17-e69386e8cea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108adaad0>]}
[0m20:41:30.935358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2587846d-c685-4256-8e17-e69386e8cea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f23430>]}
[0m20:41:30.936008 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:41:30.944829 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:41:31.014903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:41:31.015203 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:41:31.015355 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:41:31.015487 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:41:31.015618 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:41:31.015743 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:41:31.089025 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.low_stock' (models/low_stock.sql) depends on a node named 'inventory_status' which was not found
[0m20:41:31.090630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.35743472, "process_user_time": 0.712896, "process_kernel_time": 0.093181, "process_mem_max_rss": "113901568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:41:31.090920 [debug] [MainThread]: Command `dbt run` failed at 20:41:31.090876 after 0.36 seconds
[0m20:41:31.091111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdb070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdba00>]}
[0m20:41:31.091291 [debug] [MainThread]: Flushing usage events
[0m20:41:58.880689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1a980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663f610>]}


============================== 20:41:58.884523 | adcee6d7-c098-4612-ac12-37c108b9cbd2 ==============================
[0m20:41:58.884523 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:41:58.884823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'version_check': 'True', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:41:59.009505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adcee6d7-c098-4612-ac12-37c108b9cbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106601e70>]}
[0m20:41:59.030186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adcee6d7-c098-4612-ac12-37c108b9cbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663f610>]}
[0m20:41:59.030806 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:41:59.039109 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:41:59.109745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:41:59.110033 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:41:59.110181 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:41:59.110307 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:41:59.110430 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:41:59.110547 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:41:59.181180 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.top_category' (models/top_category.sql) depends on a node named 'fact_sales' which was not found
[0m20:41:59.182811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.33103293, "process_user_time": 0.710745, "process_kernel_time": 0.089673, "process_mem_max_rss": "113770496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:41:59.183080 [debug] [MainThread]: Command `dbt run` failed at 20:41:59.183038 after 0.33 seconds
[0m20:41:59.183253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1a980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b027a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b01570>]}
[0m20:41:59.183403 [debug] [MainThread]: Flushing usage events
[0m20:42:21.005320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107322950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d77fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d778b0>]}


============================== 20:42:21.008163 | d34cf894-171a-469d-a153-71be88336952 ==============================
[0m20:42:21.008163 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:42:21.008442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:42:21.130215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd34cf894-171a-469d-a153-71be88336952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3aad0>]}
[0m20:42:21.151325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd34cf894-171a-469d-a153-71be88336952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817f430>]}
[0m20:42:21.151761 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:42:21.159664 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:42:21.229874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:42:21.230169 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:42:21.230310 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:42:21.230438 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:42:21.230559 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:42:21.230678 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:42:21.303649 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.top_category' (models/top_category.sql) depends on a node named 'fact_sales' which was not found
[0m20:42:21.305204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.32928705, "process_user_time": 0.720424, "process_kernel_time": 0.089009, "process_mem_max_rss": "113836032", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:42:21.305471 [debug] [MainThread]: Command `dbt run` failed at 20:42:21.305425 after 0.33 seconds
[0m20:42:21.305646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107322950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f8460>]}
[0m20:42:21.305810 [debug] [MainThread]: Flushing usage events
[0m20:42:38.206215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897f880>]}


============================== 20:42:38.209839 | 6ada3a9e-c997-44b7-bfb5-735febb66fae ==============================
[0m20:42:38.209839 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:42:38.210107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:42:38.288661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ada3a9e-c997-44b7-bfb5-735febb66fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4c2e0>]}
[0m20:42:38.309027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ada3a9e-c997-44b7-bfb5-735febb66fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4c0a0>]}
[0m20:42:38.309376 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:42:38.315719 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:42:38.376869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:42:38.377160 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:42:38.377302 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:42:38.377431 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:42:38.377554 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:42:38.377676 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:42:38.447889 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.low_stock' (models/low_stock.sql) depends on a node named 'dim_products' which was not found
[0m20:42:38.448668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.269805, "process_user_time": 0.694889, "process_kernel_time": 0.070598, "process_mem_max_rss": "110592000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:42:38.448901 [debug] [MainThread]: Command `dbt run` failed at 20:42:38.448862 after 0.27 seconds
[0m20:42:38.449066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e85d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e87370>]}
[0m20:42:38.449218 [debug] [MainThread]: Flushing usage events
[0m20:43:32.391377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c77fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c778b0>]}


============================== 20:43:32.398459 | 933c1342-9605-46cb-806a-52776e613b58 ==============================
[0m20:43:32.398459 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:43:32.398778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:32.547065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '933c1342-9605-46cb-806a-52776e613b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c36ad0>]}
[0m20:43:32.568932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '933c1342-9605-46cb-806a-52776e613b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7f430>]}
[0m20:43:32.569586 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:43:32.581351 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:43:32.651760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:43:32.652061 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:43:32.652207 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:43:32.652332 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:43:32.652455 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:43:32.652576 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:43:32.725608 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.monthly_sales_growth' (models/monthly_sales_growth.sql) depends on a node named 'fact_sales' which was not found
[0m20:43:32.727316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.37109643, "process_user_time": 0.709235, "process_kernel_time": 0.097869, "process_mem_max_rss": "114655232", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:43:32.727606 [debug] [MainThread]: Command `dbt run` failed at 20:43:32.727563 after 0.37 seconds
[0m20:43:32.727779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111134e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111134460>]}
[0m20:43:32.727933 [debug] [MainThread]: Flushing usage events
[0m20:44:07.659019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069228f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a838100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a839330>]}


============================== 20:44:07.662308 | 184432d1-2a13-47f6-8e9d-5741e5286f9e ==============================
[0m20:44:07.662308 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:44:07.662604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:44:07.787010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '184432d1-2a13-47f6-8e9d-5741e5286f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9472e0>]}
[0m20:44:07.808524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '184432d1-2a13-47f6-8e9d-5741e5286f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9082e0>]}
[0m20:44:07.808946 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:44:07.816501 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:44:07.886709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:44:07.887014 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:44:07.887160 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:44:07.887289 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:44:07.887413 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:44:07.887537 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:44:07.958881 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.monthly_sales_growth' (models/monthly_sales_growth.sql) depends on a node named 'fact_sales' which was not found
[0m20:44:07.960494 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3307235, "process_user_time": 0.721282, "process_kernel_time": 0.091784, "process_mem_max_rss": "114032640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:44:07.960765 [debug] [MainThread]: Command `dbt run` failed at 20:44:07.960717 after 0.33 seconds
[0m20:44:07.960953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069228f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfa740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfbac0>]}
[0m20:44:07.961111 [debug] [MainThread]: Flushing usage events
[0m20:44:38.182674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b77fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b778b0>]}


============================== 20:44:38.195389 | 6c196581-b843-44fd-ab37-1a4099407f4b ==============================
[0m20:44:38.195389 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:44:38.195697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:38.353238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c196581-b843-44fd-ab37-1a4099407f4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b3aad0>]}
[0m20:44:38.375193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c196581-b843-44fd-ab37-1a4099407f4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7f430>]}
[0m20:44:38.375710 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:44:38.383981 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:44:38.458658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m20:44:38.458991 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:44:38.459153 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:44:38.459298 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:44:38.459435 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:44:38.459569 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:44:38.536240 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.avg_order_value' (models/avg_order_value.sql) depends on a node named 'dim_customers' which was not found
[0m20:44:38.537840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.39281553, "process_user_time": 0.737366, "process_kernel_time": 0.098764, "process_mem_max_rss": "114851840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:44:38.538127 [debug] [MainThread]: Command `dbt run` failed at 20:44:38.538079 after 0.39 seconds
[0m20:44:38.538317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fba00>]}
[0m20:44:38.538489 [debug] [MainThread]: Flushing usage events
[0m20:45:34.711479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e86920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066abf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ab880>]}


============================== 20:45:34.718368 | aa29be09-62a8-4315-858c-f405e283c950 ==============================
[0m20:45:34.718368 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:45:34.718626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:45:34.854512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa29be09-62a8-4315-858c-f405e283c950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067782e0>]}
[0m20:45:34.876292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa29be09-62a8-4315-858c-f405e283c950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067780a0>]}
[0m20:45:34.876913 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:45:34.885991 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:45:34.960984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m20:45:34.961310 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:45:34.961457 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:45:34.961594 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:45:34.961729 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/fact_sales.sql
[0m20:45:34.961862 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:45:34.961997 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:45:35.037207 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.customer_LTV' (models/customer_LTV.sql) depends on a node named 'dim_customers' which was not found
[0m20:45:35.038959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3608585, "process_user_time": 0.706701, "process_kernel_time": 0.099359, "process_mem_max_rss": "114720768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:45:35.039225 [debug] [MainThread]: Command `dbt run` failed at 20:45:35.039179 after 0.36 seconds
[0m20:45:35.039405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e86920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd0ac0>]}
[0m20:45:35.039564 [debug] [MainThread]: Flushing usage events
[0m20:46:12.271261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102db6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045db880>]}


============================== 20:46:12.274354 | 04e7d5c8-740a-412d-9de7-2848dc96dd1a ==============================
[0m20:46:12.274354 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:46:12.274625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:46:12.396603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04e7d5c8-740a-412d-9de7-2848dc96dd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a82e0>]}
[0m20:46:12.417778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04e7d5c8-740a-412d-9de7-2848dc96dd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a80a0>]}
[0m20:46:12.418298 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:46:12.426867 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:46:12.497081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 0 files changed.
[0m20:46:12.497387 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/dim_customers.sql
[0m20:46:12.497538 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:46:12.497672 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:46:12.497800 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:46:12.497927 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/fact_sales.sql
[0m20:46:12.498054 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:46:12.498177 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:46:12.572832 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.top_category' (models/top_category.sql) depends on a node named 'dim_products' which was not found
[0m20:46:12.574505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3365348, "process_user_time": 0.716357, "process_kernel_time": 0.09189, "process_mem_max_rss": "112640000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:46:12.574778 [debug] [MainThread]: Command `dbt run` failed at 20:46:12.574734 after 0.34 seconds
[0m20:46:12.574958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102db6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aded10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104addf90>]}
[0m20:46:12.575115 [debug] [MainThread]: Flushing usage events
[0m20:46:46.749379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4f880>]}


============================== 20:46:46.752317 | d2b61596-1dd3-4aef-bccc-a62a1f717f85 ==============================
[0m20:46:46.752317 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:46:46.752579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:46:46.871495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5b2e0>]}
[0m20:46:46.891916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1c2e0>]}
[0m20:46:46.892522 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:46:46.900205 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:46:46.967567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m20:46:46.967845 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/avg_order_value.sql
[0m20:46:46.967988 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customer_LTV.sql
[0m20:46:46.968114 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/fact_sales.sql
[0m20:46:46.968234 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/dim_customers.sql
[0m20:46:46.968354 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/dim_products.sql
[0m20:46:46.968473 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/low_stock.sql
[0m20:46:46.968591 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/monthly_sales_growth.sql
[0m20:46:46.968709 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/top_category.sql
[0m20:46:47.079999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b0af0>]}
[0m20:46:47.140645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829a6b0>]}
[0m20:46:47.140971 [info ] [MainThread]: Found 8 seeds, 16 models, 5 data tests, 423 macros
[0m20:46:47.141138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829a650>]}
[0m20:46:47.142035 [info ] [MainThread]: 
[0m20:46:47.142280 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:46:47.145012 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:46:47.170808 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:46:47.171054 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:46:47.171205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:47.179638 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:46:47.180336 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:46:47.181450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:46:47.181692 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:46:47.184591 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:46:47.184740 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:46:47.184856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:47.187161 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:46:47.187810 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:46:47.187949 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:46:47.188095 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:46:47.188257 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:46:47.188386 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:46:47.188599 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:46:47.188929 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:46:47.189044 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:46:47.189147 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:46:47.189283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:46:47.189407 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:46:47.190862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:46:47.193354 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:46:47.193506 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:46:47.193624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:47.195838 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:46:47.196020 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:46:47.196175 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:46:47.205492 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:46:47.207796 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:46:47.208341 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:46:47.208459 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:46:47.209997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0bac0>]}
[0m20:46:47.210204 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:47.210337 [debug] [MainThread]: On master: BEGIN
[0m20:46:47.210458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:47.212341 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:46:47.212479 [debug] [MainThread]: On master: COMMIT
[0m20:46:47.212599 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:47.212708 [debug] [MainThread]: On master: COMMIT
[0m20:46:47.212834 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:46:47.212955 [debug] [MainThread]: On master: Close
[0m20:46:47.213408 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:46:47.213561 [info ] [MainThread]: 
[0m20:46:47.215554 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:46:47.215743 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:46:47.215930 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:46:47.216095 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:46:47.216263 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:46:47.216442 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:46:47.216837 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:46:47.216995 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:46:47.216693 [info ] [Thread-1 (]: 1 of 16 START sql view model main.stg_customers ................................ [RUN]
[0m20:46:47.217259 [info ] [Thread-2 (]: 2 of 16 START sql view model main.stg_inventory ................................ [RUN]
[0m20:46:47.217561 [info ] [Thread-3 (]: 3 of 16 START sql view model main.stg_inventory_transactions ................... [RUN]
[0m20:46:47.217819 [info ] [Thread-4 (]: 4 of 16 START sql view model main.stg_order_details ............................ [RUN]
[0m20:46:47.218041 [info ] [Thread-5 (]: 5 of 16 START sql view model main.stg_orders ................................... [RUN]
[0m20:46:47.218309 [info ] [Thread-6 (]: 6 of 16 START sql view model main.stg_products ................................. [RUN]
[0m20:46:47.218524 [info ] [Thread-7 (]: 7 of 16 START sql view model main.stg_supplier_products ........................ [RUN]
[0m20:46:47.218733 [info ] [Thread-8 (]: 8 of 16 START sql view model main.stg_suppliers ................................ [RUN]
[0m20:46:47.218970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:46:47.219206 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:46:47.219429 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:46:47.219632 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:46:47.219817 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:46:47.220026 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:46:47.220214 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:46:47.220408 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:46:47.220570 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:46:47.220736 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:46:47.220894 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:46:47.221040 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:46:47.221183 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:46:47.221337 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:46:47.221503 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:46:47.221655 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:46:47.226875 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:46:47.251159 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:46:47.252384 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:46:47.253556 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:46:47.255028 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:46:47.256507 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:46:47.257482 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:46:47.258574 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:46:47.259676 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:46:47.259860 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:46:47.273802 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:46:47.273974 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:46:47.275427 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:46:47.275569 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:46:47.275698 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:46:47.275854 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:46:47.275995 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:46:47.276186 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:46:47.277647 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:46:47.277909 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:46:47.279345 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:46:47.280696 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:46:47.282372 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:46:47.282515 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:46:47.283820 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:46:47.285153 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:46:47.285350 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:46:47.285576 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:46:47.285795 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:46:47.286055 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:46:47.286250 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:46:47.286410 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:46:47.286588 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:46:47.286768 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:46:47.286960 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:46:47.287128 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:46:47.287265 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:46:47.287416 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:46:47.289435 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:46:47.289585 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:46:47.289756 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:46:47.289905 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:46:47.290055 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:46:47.290215 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:46:47.290414 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:46:47.290558 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:46:47.290711 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:46:47.290849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:47.290982 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:46:47.291160 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:46:47.291297 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.291442 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:46:47.291630 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:46:47.291772 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.291934 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:46:47.292160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.292336 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.292491 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:46:47.292629 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.292846 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:46:47.293001 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:46:47.293147 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:46:47.293332 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:46:47.293484 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:46:47.293624 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.293785 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:46:47.293947 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:46:47.294121 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:46:47.294279 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:46:47.294430 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.294599 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(first_name), 1, 1)), LOWER(SUBSTRING(TRIM(first_name), 2)))
 AS first_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(last_name), 1, 1)), LOWER(SUBSTRING(TRIM(last_name), 2)))
 AS last_name,
  LOWER(TRIM(email)) AS email,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:46:47.294777 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:46:47.297677 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:46:47.297898 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  
  TRY_CAST(product_id AS INTEGER)
 AS product_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))
 AS product_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))
 AS category,
  
  TRY_CAST(price AS DECIMAL(10,2))
 AS price,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:46:47.298105 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:46:47.298275 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.299662 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:46:47.299884 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:46:47.300044 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:46:47.300196 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.300349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.301683 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:46:47.301845 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m20:46:47.301996 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.302139 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m20:46:47.303414 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:46:47.304988 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:46:47.305125 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:46:47.306220 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:46:47.306360 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:46:47.307526 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:46:47.308729 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:46:47.308867 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:46:47.309021 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:46:47.309194 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m20:46:47.310341 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:46:47.310487 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:46:47.310674 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions" rename to "stg_inventory_transactions__dbt_backup"
[0m20:46:47.310830 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.310986 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:46:47.312100 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:46:47.312303 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:46:47.312452 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.312605 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.312763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.313957 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:46:47.314128 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.314287 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:46:47.314441 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.315864 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:46:47.316010 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:46:47.317128 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:46:47.318163 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:46:47.318305 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:46:47.319362 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:46:47.320456 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:46:47.320605 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:46:47.320725 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.327640 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:46:47.327820 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:46:47.327983 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:46:47.328173 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m20:46:47.328344 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:46:47.328532 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.329026 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:46:47.329177 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:46:47.329292 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.329512 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.329671 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.329819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.330292 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:46:47.330466 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:46:47.330600 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.330738 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:46:47.331280 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:46:47.331739 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:46:47.332217 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:46:47.332702 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:46:47.332849 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:46:47.332987 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:46:47.333447 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:46:47.333629 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:46:47.333793 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:46:47.333971 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:46:47.334118 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:46:47.334239 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.334372 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:46:47.334535 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:46:47.334687 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:46:47.334828 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.334958 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:46:47.335088 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:46:47.335216 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:46:47.337245 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:46:47.337424 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:46:47.338913 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:46:47.339051 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.339210 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m20:46:47.339448 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.339594 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.339730 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.339875 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:46:47.340059 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:46:47.340198 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.341115 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:46:47.342073 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:46:47.342939 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:46:47.343853 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:46:47.344756 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:46:47.345765 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:46:47.345926 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m20:46:47.346072 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.346223 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:46:47.346358 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.346506 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:46:47.346671 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m20:46:47.346833 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m20:46:47.346990 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
drop view if exists "jaffle_shop"."main"."stg_products__dbt_backup" cascade
[0m20:46:47.347998 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:46:47.348539 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:46:47.348694 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:46:47.348875 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.349646 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cbca0>]}
[0m20:46:47.349811 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.349949 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.350098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.350289 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879ce50>]}
[0m20:46:47.350438 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:46:47.350935 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:46:47.351400 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:46:47.351667 [info ] [Thread-2 (]: 2 of 16 OK created sql view model main.stg_inventory ........................... [[32mOK[0m in 0.13s]
[0m20:46:47.352197 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:46:47.352652 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:46:47.353151 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:46:47.353396 [info ] [Thread-4 (]: 4 of 16 OK created sql view model main.stg_order_details ....................... [[32mOK[0m in 0.13s]
[0m20:46:47.353916 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:46:47.354112 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c8c10>]}
[0m20:46:47.354338 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fa6e0>]}
[0m20:46:47.354580 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:46:47.354788 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e40a0>]}
[0m20:46:47.354981 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ebeb0>]}
[0m20:46:47.355179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ca950>]}
[0m20:46:47.355424 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:46:47.358319 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cf730>]}
[0m20:46:47.358606 [info ] [Thread-8 (]: 8 of 16 OK created sql view model main.stg_suppliers ........................... [[32mOK[0m in 0.13s]
[0m20:46:47.358870 [info ] [Thread-5 (]: 5 of 16 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.13s]
[0m20:46:47.359227 [info ] [Thread-3 (]: 3 of 16 OK created sql view model main.stg_inventory_transactions .............. [[32mOK[0m in 0.14s]
[0m20:46:47.359501 [info ] [Thread-7 (]: 7 of 16 OK created sql view model main.stg_supplier_products ................... [[32mOK[0m in 0.13s]
[0m20:46:47.359762 [info ] [Thread-1 (]: 1 of 16 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.14s]
[0m20:46:47.360094 [info ] [Thread-6 (]: 6 of 16 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.14s]
[0m20:46:47.360342 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:46:47.360566 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:46:47.360773 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:46:47.360972 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:46:47.361180 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:46:47.361405 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:46:47.361715 [debug] [Thread-10 ]: Began running node model.jaffle_shop.fact_sales
[0m20:46:47.362032 [debug] [Thread-12 ]: Began running node model.jaffle_shop.dim_customers
[0m20:46:47.362189 [debug] [Thread-6 (]: Began running node model.jaffle_shop.dim_products
[0m20:46:47.362590 [debug] [Thread-14 ]: Began running node model.jaffle_shop.low_stock
[0m20:46:47.362432 [info ] [Thread-10 ]: 9 of 16 START sql table model main.fact_sales .................................. [RUN]
[0m20:46:47.362769 [info ] [Thread-12 ]: 10 of 16 START sql table model main.dim_customers .............................. [RUN]
[0m20:46:47.363034 [info ] [Thread-6 (]: 11 of 16 START sql table model main.dim_products ............................... [RUN]
[0m20:46:47.363249 [info ] [Thread-14 ]: 12 of 16 START sql table model main.low_stock .................................. [RUN]
[0m20:46:47.363481 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.jaffle_shop.fact_sales'
[0m20:46:47.363683 [debug] [Thread-12 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m20:46:47.363873 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_products, now model.jaffle_shop.dim_products)
[0m20:46:47.364071 [debug] [Thread-14 ]: Acquiring new duckdb connection 'model.jaffle_shop.low_stock'
[0m20:46:47.364224 [debug] [Thread-10 ]: Began compiling node model.jaffle_shop.fact_sales
[0m20:46:47.364373 [debug] [Thread-12 ]: Began compiling node model.jaffle_shop.dim_customers
[0m20:46:47.364517 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.dim_products
[0m20:46:47.364674 [debug] [Thread-14 ]: Began compiling node model.jaffle_shop.low_stock
[0m20:46:47.366234 [debug] [Thread-10 ]: Writing injected SQL for node "model.jaffle_shop.fact_sales"
[0m20:46:47.368019 [debug] [Thread-12 ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:46:47.369003 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.dim_products"
[0m20:46:47.370403 [debug] [Thread-14 ]: Writing injected SQL for node "model.jaffle_shop.low_stock"
[0m20:46:47.370927 [debug] [Thread-12 ]: Began executing node model.jaffle_shop.dim_customers
[0m20:46:47.371071 [debug] [Thread-10 ]: Began executing node model.jaffle_shop.fact_sales
[0m20:46:47.371212 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.dim_products
[0m20:46:47.371359 [debug] [Thread-14 ]: Began executing node model.jaffle_shop.low_stock
[0m20:46:47.379852 [debug] [Thread-12 ]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m20:46:47.381369 [debug] [Thread-10 ]: Writing runtime sql for node "model.jaffle_shop.fact_sales"
[0m20:46:47.382772 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.dim_products"
[0m20:46:47.384655 [debug] [Thread-14 ]: Writing runtime sql for node "model.jaffle_shop.low_stock"
[0m20:46:47.385075 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:46:47.385238 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:46:47.385434 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:46:47.385590 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: BEGIN
[0m20:46:47.385738 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:46:47.385890 [debug] [Thread-10 ]: On model.jaffle_shop.fact_sales: BEGIN
[0m20:46:47.386094 [debug] [Thread-6 (]: On model.jaffle_shop.dim_products: BEGIN
[0m20:46:47.386245 [debug] [Thread-12 ]: Opening a new connection, currently in state init
[0m20:46:47.386396 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: BEGIN
[0m20:46:47.386544 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m20:46:47.386695 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m20:46:47.388771 [debug] [Thread-14 ]: Opening a new connection, currently in state init
[0m20:46:47.388929 [debug] [Thread-12 ]: SQL status: OK in 0.003 seconds
[0m20:46:47.389193 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m20:46:47.389374 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m20:46:47.389530 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:46:47.389670 [debug] [Thread-14 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.389813 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:46:47.389964 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:46:47.390118 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:46:47.390268 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:46:47.390426 [debug] [Thread-10 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fact_sales__dbt_tmp"
  
    as (
      SELECT
  od.order_id,
  o.order_date,
  od.product_id,
  od.quantity,
  od.unit_price,
  od.line_total,
  o.customer_id
FROM "jaffle_shop"."main"."stg_order_details" AS od
JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
    );
  
  
[0m20:46:47.390602 [debug] [Thread-6 (]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_products__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:46:47.390817 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */

  
    
    

    create  table
      "jaffle_shop"."main"."low_stock__dbt_tmp"
  
    as (
      with dim_products as (
    SELECT
      product_id,
      product_name,
      category,
      price,
      created_at AS product_created_date
    FROM "jaffle_shop"."main"."stg_products"
),

inventory_status AS (
    SELECT
      i.product_id,
      p.product_name,
      i.quantity,
      i.last_updated
    FROM "jaffle_shop"."main"."stg_inventory" AS i
    JOIN "jaffle_shop"."main"."stg_products" AS p ON i.product_id = p.product_id
),

current_inventory AS (
    SELECT
        i.product_id,
        p.product_name,
        p.category,
        i.quantity,
        i.last_updated
    FROM inventory_status AS i
    JOIN dim_products AS p ON i.product_id = p.product_id
),

low_stock_products AS (
    SELECT
        ci.product_id,
        ci.product_name,
        ci.category,
        ci.quantity,
        ci.last_updated
    FROM current_inventory AS ci
    WHERE ci.quantity < 20
)

SELECT * FROM low_stock_products
ORDER BY ci.quantity ASC
    );
  
  
[0m20:46:47.392838 [debug] [Thread-12 ]: SQL status: OK in 0.002 seconds
[0m20:46:47.393023 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m20:46:47.393177 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m20:46:47.394508 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:46:47.394770 [debug] [Thread-14 ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */

  
    
    

    create  table
      "jaffle_shop"."main"."low_stock__dbt_tmp"
  
    as (
      with dim_products as (
    SELECT
      product_id,
      product_name,
      category,
      price,
      created_at AS product_created_date
    FROM "jaffle_shop"."main"."stg_products"
),

inventory_status AS (
    SELECT
      i.product_id,
      p.product_name,
      i.quantity,
      i.last_updated
    FROM "jaffle_shop"."main"."stg_inventory" AS i
    JOIN "jaffle_shop"."main"."stg_products" AS p ON i.product_id = p.product_id
),

current_inventory AS (
    SELECT
        i.product_id,
        p.product_name,
        p.category,
        i.quantity,
        i.last_updated
    FROM inventory_status AS i
    JOIN dim_products AS p ON i.product_id = p.product_id
),

low_stock_products AS (
    SELECT
        ci.product_id,
        ci.product_name,
        ci.category,
        ci.quantity,
        ci.last_updated
    FROM current_inventory AS ci
    WHERE ci.quantity < 20
)

SELECT * FROM low_stock_products
ORDER BY ci.quantity ASC
    );
  
  
[0m20:46:47.396063 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:46:47.397239 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:46:47.397411 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:46:47.397589 [debug] [Thread-14 ]: DuckDB adapter: Rolling back transaction.
[0m20:46:47.397750 [debug] [Thread-10 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m20:46:47.397908 [debug] [Thread-6 (]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m20:46:47.398139 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: ROLLBACK
[0m20:46:47.398364 [debug] [Thread-12 ]: SQL status: OK in 0.000 seconds
[0m20:46:47.398535 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:46:47.398742 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.401097 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:46:47.402258 [debug] [Thread-10 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:46:47.402782 [debug] [Thread-6 (]: On model.jaffle_shop.dim_products: COMMIT
[0m20:46:47.402945 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:46:47.403106 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:46:47.403262 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:46:47.403407 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:46:47.403588 [debug] [Thread-10 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:46:47.403757 [debug] [Thread-6 (]: On model.jaffle_shop.dim_products: COMMIT
[0m20:46:47.404245 [debug] [Thread-12 ]: SQL status: OK in 0.000 seconds
[0m20:46:47.405391 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:46:47.405573 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m20:46:47.405715 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m20:46:47.405912 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m20:46:47.406846 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:46:47.407961 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:46:47.408162 [debug] [Thread-10 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
drop table if exists "jaffle_shop"."main"."fact_sales__dbt_backup" cascade
[0m20:46:47.408298 [debug] [Thread-12 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.408490 [debug] [Thread-6 (]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
drop table if exists "jaffle_shop"."main"."dim_products__dbt_backup" cascade
[0m20:46:47.409118 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: Close
[0m20:46:47.409337 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.409601 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cb010>]}
[0m20:46:47.409807 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:46:47.410323 [debug] [Thread-10 ]: On model.jaffle_shop.fact_sales: Close
[0m20:46:47.411089 [debug] [Thread-6 (]: On model.jaffle_shop.dim_products: Close
[0m20:46:47.410619 [info ] [Thread-12 ]: 10 of 16 OK created sql table model main.dim_customers ......................... [[32mOK[0m in 0.05s]
[0m20:46:47.411520 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cb280>]}
[0m20:46:47.411773 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ca620>]}
[0m20:46:47.412020 [debug] [Thread-12 ]: Finished running node model.jaffle_shop.dim_customers
[0m20:46:47.412347 [info ] [Thread-10 ]: 9 of 16 OK created sql table model main.fact_sales ............................. [[32mOK[0m in 0.05s]
[0m20:46:47.412610 [info ] [Thread-6 (]: 11 of 16 OK created sql table model main.dim_products .......................... [[32mOK[0m in 0.05s]
[0m20:46:47.413013 [debug] [Thread-14 ]: Failed to rollback 'model.jaffle_shop.low_stock'
[0m20:46:47.413373 [debug] [Thread-10 ]: Finished running node model.jaffle_shop.fact_sales
[0m20:46:47.413541 [debug] [Thread-16 ]: Began running node model.jaffle_shop.avg_order_value
[0m20:46:47.413715 [debug] [Thread-17 ]: Began running node model.jaffle_shop.customer_LTV
[0m20:46:47.414179 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.dim_products
[0m20:46:47.414325 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: Close
[0m20:46:47.414569 [debug] [Thread-19 ]: Began running node model.jaffle_shop.monthly_sales_growth
[0m20:46:47.414778 [info ] [Thread-16 ]: 13 of 16 START sql table model main.avg_order_value ............................ [RUN]
[0m20:46:47.415004 [info ] [Thread-17 ]: 14 of 16 START sql table model main.customer_LTV ............................... [RUN]
[0m20:46:47.415258 [debug] [Thread-21 ]: Began running node model.jaffle_shop.top_category
[0m20:46:47.418883 [info ] [Thread-19 ]: 15 of 16 START sql table model main.monthly_sales_growth ....................... [RUN]
[0m20:46:47.419145 [debug] [Thread-16 ]: Acquiring new duckdb connection 'model.jaffle_shop.avg_order_value'
[0m20:46:47.419525 [debug] [Thread-14 ]: Runtime Error in model low_stock (models/low_stock.sql)
  Binder Error: Referenced table "ci" not found!
  Candidate tables: "low_stock_products"
  LINE 54: ORDER BY ci.quantity ASC
                    ^
[0m20:46:47.419740 [debug] [Thread-17 ]: Acquiring new duckdb connection 'model.jaffle_shop.customer_LTV'
[0m20:46:47.419940 [info ] [Thread-21 ]: 16 of 16 START sql table model main.top_category ............................... [RUN]
[0m20:46:47.420155 [debug] [Thread-19 ]: Acquiring new duckdb connection 'model.jaffle_shop.monthly_sales_growth'
[0m20:46:47.420319 [debug] [Thread-16 ]: Began compiling node model.jaffle_shop.avg_order_value
[0m20:46:47.420499 [debug] [Thread-14 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895de10>]}
[0m20:46:47.420664 [debug] [Thread-17 ]: Began compiling node model.jaffle_shop.customer_LTV
[0m20:46:47.420864 [debug] [Thread-21 ]: Acquiring new duckdb connection 'model.jaffle_shop.top_category'
[0m20:46:47.421020 [debug] [Thread-19 ]: Began compiling node model.jaffle_shop.monthly_sales_growth
[0m20:46:47.423243 [debug] [Thread-16 ]: Writing injected SQL for node "model.jaffle_shop.avg_order_value"
[0m20:46:47.423498 [error] [Thread-14 ]: 12 of 16 ERROR creating sql table model main.low_stock ......................... [[31mERROR[0m in 0.06s]
[0m20:46:47.424915 [debug] [Thread-17 ]: Writing injected SQL for node "model.jaffle_shop.customer_LTV"
[0m20:46:47.425083 [debug] [Thread-21 ]: Began compiling node model.jaffle_shop.top_category
[0m20:46:47.426454 [debug] [Thread-19 ]: Writing injected SQL for node "model.jaffle_shop.monthly_sales_growth"
[0m20:46:47.426743 [debug] [Thread-14 ]: Finished running node model.jaffle_shop.low_stock
[0m20:46:47.428204 [debug] [Thread-21 ]: Writing injected SQL for node "model.jaffle_shop.top_category"
[0m20:46:47.428354 [debug] [Thread-16 ]: Began executing node model.jaffle_shop.avg_order_value
[0m20:46:47.428560 [debug] [Thread-17 ]: Began executing node model.jaffle_shop.customer_LTV
[0m20:46:47.430294 [debug] [Thread-16 ]: Writing runtime sql for node "model.jaffle_shop.avg_order_value"
[0m20:46:47.431760 [debug] [Thread-17 ]: Writing runtime sql for node "model.jaffle_shop.customer_LTV"
[0m20:46:47.431911 [debug] [Thread-19 ]: Began executing node model.jaffle_shop.monthly_sales_growth
[0m20:46:47.432097 [debug] [Thread-21 ]: Began executing node model.jaffle_shop.top_category
[0m20:46:47.433568 [debug] [Thread-19 ]: Writing runtime sql for node "model.jaffle_shop.monthly_sales_growth"
[0m20:46:47.435525 [debug] [Thread-21 ]: Writing runtime sql for node "model.jaffle_shop.top_category"
[0m20:46:47.435696 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:46:47.435882 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:46:47.436084 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: BEGIN
[0m20:46:47.436250 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: BEGIN
[0m20:46:47.436411 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:46:47.436621 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:46:47.436774 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m20:46:47.436937 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m20:46:47.437096 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: BEGIN
[0m20:46:47.437255 [debug] [Thread-21 ]: On model.jaffle_shop.top_category: BEGIN
[0m20:46:47.439381 [debug] [Thread-16 ]: SQL status: OK in 0.003 seconds
[0m20:46:47.439547 [debug] [Thread-19 ]: Opening a new connection, currently in state init
[0m20:46:47.439693 [debug] [Thread-17 ]: SQL status: OK in 0.003 seconds
[0m20:46:47.439843 [debug] [Thread-21 ]: Opening a new connection, currently in state init
[0m20:46:47.439993 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:46:47.440181 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:46:47.440319 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.440541 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */

  
    
    

    create  table
      "jaffle_shop"."main"."avg_order_value__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_order_totals AS (
    SELECT
        customer_id,
        COUNT(DISTINCT order_id) AS total_orders,
        SUM(line_total) AS total_spent
    FROM fact_sales
    GROUP BY customer_id
    HAVING COUNT(DISTINCT order_id) > 3
),

average_order_value AS (
    SELECT
        cot.customer_id,
        dc.first_name,
        dc.last_name,
        cot.total_orders,
        cot.total_spent,
        ROUND(cot.total_spent / cot.total_orders, 1) AS avg_order_value
    FROM customer_order_totals AS cot
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cot.customer_id = dc.customer_id
)

SELECT * FROM average_order_value
ORDER BY avg_order_value DESC
    );
  
  
[0m20:46:47.440706 [debug] [Thread-21 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.440894 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */

  
    
    

    create  table
      "jaffle_shop"."main"."customer_LTV__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_revenue AS (
    SELECT
        fs.customer_id,
        SUM(fs.line_total) AS total_revenue,
        MIN(fs.order_date) AS first_purchase_date,
        MAX(fs.order_date) AS last_purchase_date,
        COUNT(DISTINCT fs.order_id) AS total_orders
    FROM fact_sales AS fs
    GROUP BY fs.customer_id
),

customer_ltv AS (
    SELECT
        cr.customer_id,
        dc.first_name,
        dc.last_name,
        cr.total_revenue,
        cr.total_orders,
        DATE_PART('day', cr.last_purchase_date - cr.first_purchase_date) AS customer_lifespan_days,
        ROUND(cr.total_revenue / NULLIF(cr.total_orders, 0), 2) AS avg_order_value,
        ROUND(cr.total_revenue / NULLIF(DATE_PART('day', CURRENT_DATE - cr.first_purchase_date) / 30, 0), 2) AS monthly_ltv
    FROM customer_revenue AS cr
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cr.customer_id = dc.customer_id
)

SELECT * FROM customer_ltv
ORDER BY total_revenue DESC
    );
  
  
[0m20:46:47.441080 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:46:47.441247 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:46:47.441465 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */

  
    
    

    create  table
      "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

monthly_sales AS (
    SELECT
        DATE_TRUNC('month', order_date) AS sales_month,
        SUM(line_total) AS total_revenue,
        SUM(quantity) AS total_quantity_sold
    FROM "jaffle_shop"."main"."fact_sales"
    GROUP BY sales_month
),

sales_growth AS (
    SELECT
        ms.sales_month,
        ms.total_revenue,
        ms.total_quantity_sold,
        LAG(ms.total_revenue) OVER (ORDER BY ms.sales_month) AS previous_revenue,
        LAG(ms.total_quantity_sold) OVER (ORDER BY ms.sales_month) AS previous_quantity
    FROM monthly_sales AS ms
),

growth_calculations AS (
    SELECT
        sg.sales_month,
        sg.total_revenue,
        sg.total_quantity_sold,
        ROUND(((sg.total_revenue - sg.previous_revenue) / sg.previous_revenue) * 100, 2) AS revenue_growth_percentage,
        ROUND(((sg.total_quantity_sold - sg.previous_quantity) / sg.previous_quantity) * 100, 2) AS quantity_growth_percentage
    FROM sales_growth AS sg
    WHERE sg.previous_revenue IS NOT NULL
)

SELECT * FROM growth_calculations
ORDER BY sales_month ASC
    );
  
  
[0m20:46:47.441689 [debug] [Thread-21 ]: On model.jaffle_shop.top_category: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

ranked_categories AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS sales_rank
    FROM category_sales AS cs
)

SELECT * FROM ranked_categories
ORDER BY sales_rank
    );
  
  
[0m20:46:47.442181 [debug] [Thread-21 ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

ranked_categories AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS sales_rank
    FROM category_sales AS cs
)

SELECT * FROM ranked_categories
ORDER BY sales_rank
    );
  
  
[0m20:46:47.442366 [debug] [Thread-21 ]: DuckDB adapter: Rolling back transaction.
[0m20:46:47.442556 [debug] [Thread-21 ]: On model.jaffle_shop.top_category: ROLLBACK
[0m20:46:47.443062 [debug] [Thread-21 ]: Failed to rollback 'model.jaffle_shop.top_category'
[0m20:46:47.443220 [debug] [Thread-21 ]: On model.jaffle_shop.top_category: Close
[0m20:46:47.444102 [debug] [Thread-21 ]: Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:46:47.444473 [debug] [Thread-21 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890dd80>]}
[0m20:46:47.445119 [debug] [Thread-19 ]: SQL status: OK in 0.003 seconds
[0m20:46:47.444959 [error] [Thread-21 ]: 16 of 16 ERROR creating sql table model main.top_category ...................... [[31mERROR[0m in 0.02s]
[0m20:46:47.446576 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:46:47.446810 [debug] [Thread-16 ]: SQL status: OK in 0.006 seconds
[0m20:46:47.447124 [debug] [Thread-17 ]: SQL status: OK in 0.006 seconds
[0m20:46:47.447379 [debug] [Thread-21 ]: Finished running node model.jaffle_shop.top_category
[0m20:46:47.447534 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp" rename to "monthly_sales_growth"
[0m20:46:47.448795 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:46:47.449898 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:46:47.450166 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value__dbt_tmp" rename to "avg_order_value"
[0m20:46:47.450336 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV__dbt_tmp" rename to "customer_LTV"
[0m20:46:47.450503 [debug] [Thread-19 ]: SQL status: OK in 0.000 seconds
[0m20:46:47.451123 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:46:47.451275 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:46:47.451411 [debug] [Thread-16 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.451564 [debug] [Thread-17 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.451716 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:46:47.452286 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:46:47.452789 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:46:47.452970 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:46:47.453136 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:46:47.453280 [debug] [Thread-19 ]: SQL status: OK in 0.000 seconds
[0m20:46:47.453431 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:46:47.453583 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:46:47.454531 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:46:47.454745 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
drop table if exists "jaffle_shop"."main"."monthly_sales_growth__dbt_backup" cascade
[0m20:46:47.454925 [debug] [Thread-16 ]: SQL status: OK in 0.000 seconds
[0m20:46:47.455850 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:46:47.455987 [debug] [Thread-17 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.456142 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
drop table if exists "jaffle_shop"."main"."avg_order_value__dbt_backup" cascade
[0m20:46:47.456274 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.457233 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:46:47.457811 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: Close
[0m20:46:47.457972 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
drop table if exists "jaffle_shop"."main"."customer_LTV__dbt_backup" cascade
[0m20:46:47.458117 [debug] [Thread-16 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.458344 [debug] [Thread-19 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890d660>]}
[0m20:46:47.458866 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: Close
[0m20:46:47.459012 [debug] [Thread-17 ]: SQL status: OK in 0.001 seconds
[0m20:46:47.459265 [info ] [Thread-19 ]: 15 of 16 OK created sql table model main.monthly_sales_growth .................. [[32mOK[0m in 0.04s]
[0m20:46:47.459490 [debug] [Thread-16 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cb790>]}
[0m20:46:47.459987 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: Close
[0m20:46:47.460201 [debug] [Thread-19 ]: Finished running node model.jaffle_shop.monthly_sales_growth
[0m20:46:47.460441 [info ] [Thread-16 ]: 13 of 16 OK created sql table model main.avg_order_value ....................... [[32mOK[0m in 0.04s]
[0m20:46:47.462813 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b61596-1dd3-4aef-bccc-a62a1f717f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2a290>]}
[0m20:46:47.463134 [debug] [Thread-16 ]: Finished running node model.jaffle_shop.avg_order_value
[0m20:46:47.463389 [info ] [Thread-17 ]: 14 of 16 OK created sql table model main.customer_LTV .......................... [[32mOK[0m in 0.04s]
[0m20:46:47.463672 [debug] [Thread-17 ]: Finished running node model.jaffle_shop.customer_LTV
[0m20:46:47.464366 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:47.464498 [debug] [MainThread]: On master: BEGIN
[0m20:46:47.464606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:47.466753 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:46:47.466909 [debug] [MainThread]: On master: COMMIT
[0m20:46:47.467035 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:47.467143 [debug] [MainThread]: On master: COMMIT
[0m20:46:47.467269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:46:47.467390 [debug] [MainThread]: On master: Close
[0m20:46:47.467882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:47.468022 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:46:47.468133 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m20:46:47.468243 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:46:47.468337 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:46:47.468431 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:46:47.468528 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_products' was properly closed.
[0m20:46:47.468628 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:46:47.468720 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:46:47.468813 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_sales' was properly closed.
[0m20:46:47.468919 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m20:46:47.469013 [debug] [MainThread]: Connection 'model.jaffle_shop.low_stock' was properly closed.
[0m20:46:47.469104 [debug] [MainThread]: Connection 'model.jaffle_shop.avg_order_value' was properly closed.
[0m20:46:47.469203 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_LTV' was properly closed.
[0m20:46:47.469301 [debug] [MainThread]: Connection 'model.jaffle_shop.monthly_sales_growth' was properly closed.
[0m20:46:47.469415 [debug] [MainThread]: Connection 'model.jaffle_shop.top_category' was properly closed.
[0m20:46:47.469632 [info ] [MainThread]: 
[0m20:46:47.469794 [info ] [MainThread]: Finished running 8 view models, 8 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m20:46:47.470868 [debug] [MainThread]: Command end result
[0m20:46:47.514091 [info ] [MainThread]: 
[0m20:46:47.514302 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:46:47.514425 [info ] [MainThread]: 
[0m20:46:47.514578 [error] [MainThread]:   Runtime Error in model low_stock (models/low_stock.sql)
  Binder Error: Referenced table "ci" not found!
  Candidate tables: "low_stock_products"
  LINE 54: ORDER BY ci.quantity ASC
                    ^
[0m20:46:47.514695 [info ] [MainThread]: 
[0m20:46:47.514862 [error] [MainThread]:   Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:46:47.515029 [info ] [MainThread]: 
[0m20:46:47.515163 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=2 SKIP=0 TOTAL=16
[0m20:46:47.516471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7956, "process_user_time": 1.148202, "process_kernel_time": 0.139558, "process_mem_max_rss": "162709504", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:46:47.516694 [debug] [MainThread]: Command `dbt run` failed at 20:46:47.516657 after 0.80 seconds
[0m20:46:47.516852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ae410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089afbe0>]}
[0m20:46:47.516994 [debug] [MainThread]: Flushing usage events
[0m20:47:24.517527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104822950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106274130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106275360>]}


============================== 20:47:24.521540 | 47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e ==============================
[0m20:47:24.521540 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:47:24.521820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:47:24.644517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623aaa0>]}
[0m20:47:24.665325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106345270>]}
[0m20:47:24.665771 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:47:24.673573 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:47:24.743274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:24.743608 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/low_stock.sql
[0m20:47:24.847152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b87ee0>]}
[0m20:47:24.901866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9ac80>]}
[0m20:47:24.902143 [info ] [MainThread]: Found 8 seeds, 16 models, 5 data tests, 423 macros
[0m20:47:24.902314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9ac50>]}
[0m20:47:24.903217 [info ] [MainThread]: 
[0m20:47:24.903507 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:47:24.906253 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:47:24.929968 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:47:24.930169 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:47:24.930299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:24.939035 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:47:24.939667 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:47:24.940723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:47:24.940965 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:47:24.943801 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:47:24.943961 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:47:24.944093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:24.946361 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:47:24.946884 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:47:24.947003 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:47:24.947136 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:47:24.947247 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:47:24.947367 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:47:24.947566 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:47:24.947890 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:47:24.948016 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:47:24.948122 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:47:24.948252 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:47:24.948374 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:47:24.949786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:47:24.952114 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:47:24.952241 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:47:24.952346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:24.954202 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:47:24.954320 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:47:24.954440 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:47:24.963275 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:47:24.965470 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:47:24.965985 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:47:24.966105 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:47:24.967838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688d3c0>]}
[0m20:47:24.968057 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:24.968188 [debug] [MainThread]: On master: BEGIN
[0m20:47:24.968307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:24.970149 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:47:24.970288 [debug] [MainThread]: On master: COMMIT
[0m20:47:24.970408 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:24.970522 [debug] [MainThread]: On master: COMMIT
[0m20:47:24.970651 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:47:24.970770 [debug] [MainThread]: On master: Close
[0m20:47:24.971241 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:47:24.971396 [info ] [MainThread]: 
[0m20:47:24.973107 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:47:24.973286 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:47:24.973469 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:47:24.973624 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:47:24.973963 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:47:24.973829 [info ] [Thread-1 (]: 1 of 16 START sql view model main.stg_customers ................................ [RUN]
[0m20:47:24.974142 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:47:24.974290 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:47:24.974462 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:47:24.974653 [info ] [Thread-2 (]: 2 of 16 START sql view model main.stg_inventory ................................ [RUN]
[0m20:47:24.974874 [info ] [Thread-3 (]: 3 of 16 START sql view model main.stg_inventory_transactions ................... [RUN]
[0m20:47:24.975080 [info ] [Thread-4 (]: 4 of 16 START sql view model main.stg_order_details ............................ [RUN]
[0m20:47:24.975279 [info ] [Thread-5 (]: 5 of 16 START sql view model main.stg_orders ................................... [RUN]
[0m20:47:24.975475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:47:24.975678 [info ] [Thread-6 (]: 6 of 16 START sql view model main.stg_products ................................. [RUN]
[0m20:47:24.975895 [info ] [Thread-7 (]: 7 of 16 START sql view model main.stg_supplier_products ........................ [RUN]
[0m20:47:24.976103 [info ] [Thread-8 (]: 8 of 16 START sql view model main.stg_suppliers ................................ [RUN]
[0m20:47:24.976357 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:47:24.976588 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:47:24.976803 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:47:24.976989 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:47:24.977166 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:47:24.977375 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:47:24.977588 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:47:24.977782 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:47:24.977936 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:47:24.978086 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:47:24.978230 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:47:24.978377 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:47:24.983748 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:47:24.983942 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:47:24.984102 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:47:24.984253 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:47:25.006692 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:47:25.007781 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:47:25.008802 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:47:25.010144 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:47:25.011856 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:47:25.012912 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:47:25.013943 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:47:25.014166 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:47:25.014458 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:47:25.014744 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:47:25.014933 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:47:25.015088 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:47:25.015260 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:47:25.015427 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:47:25.029352 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:47:25.029533 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:47:25.031011 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:47:25.032516 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:47:25.034088 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:47:25.035598 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:47:25.037316 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:47:25.038663 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:47:25.040078 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:47:25.040353 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:47:25.040573 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:47:25.040844 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:47:25.040987 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:47:25.041260 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:47:25.041455 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:47:25.041624 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:47:25.041754 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:47:25.041899 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:47:25.042060 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:47:25.042200 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:47:25.042348 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:47:25.042483 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:47:25.042617 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:47:25.042754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:47:25.042892 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:47:25.043022 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:47:25.043155 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:47:25.043286 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:47:25.043448 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:47:25.043616 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:47:25.043761 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:47:25.046051 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:47:25.046211 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:47:25.046398 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:47:25.046578 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:47:25.046752 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:47:25.046950 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:47:25.047109 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m20:47:25.047287 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m20:47:25.047438 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:47:25.047586 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m20:47:25.047748 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:47:25.047883 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:47:25.048036 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:47:25.048187 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:47:25.048334 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:47:25.048485 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:47:25.048645 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(first_name), 1, 1)), LOWER(SUBSTRING(TRIM(first_name), 2)))
 AS first_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(last_name), 1, 1)), LOWER(SUBSTRING(TRIM(last_name), 2)))
 AS last_name,
  LOWER(TRIM(email)) AS email,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:47:25.048807 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:47:25.048963 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:47:25.049120 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:47:25.049277 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:47:25.049458 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:47:25.049636 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:47:25.049817 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  
  TRY_CAST(product_id AS INTEGER)
 AS product_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))
 AS product_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))
 AS category,
  
  TRY_CAST(price AS DECIMAL(10,2))
 AS price,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:47:25.050016 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:47:25.050213 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:47:25.050394 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.050538 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.050684 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.050976 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.051115 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.053913 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:47:25.054106 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m20:47:25.054237 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m20:47:25.055429 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:47:25.055568 [debug] [Thread-8 (]: SQL status: OK in 0.005 seconds
[0m20:47:25.056770 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:47:25.057993 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:47:25.059511 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:47:25.059675 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:47:25.060829 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:47:25.062005 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:47:25.062173 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:47:25.063348 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:47:25.063513 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m20:47:25.063679 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions" rename to "stg_inventory_transactions__dbt_backup"
[0m20:47:25.063835 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:47:25.064033 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m20:47:25.064209 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:47:25.064406 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:47:25.064585 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:47:25.064728 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.064909 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.065092 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.065264 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.065428 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.066637 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:47:25.066777 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:47:25.066905 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:47:25.068002 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:47:25.069096 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:47:25.070525 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:47:25.071622 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:47:25.072725 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:47:25.072889 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:47:25.073997 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:47:25.075059 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:47:25.075223 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:47:25.075389 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:47:25.075554 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m20:47:25.075707 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:47:25.075870 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:47:25.076070 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:47:25.076208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.076360 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:47:25.076575 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.076763 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.076913 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.077043 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.083785 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:47:25.083919 [debug] [Thread-7 (]: SQL status: OK in 0.007 seconds
[0m20:47:25.084046 [debug] [Thread-6 (]: SQL status: OK in 0.007 seconds
[0m20:47:25.084595 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:47:25.085068 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:47:25.085192 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:47:25.085746 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:47:25.086201 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:47:25.086348 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:47:25.086815 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:47:25.087263 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:47:25.087407 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:47:25.087546 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:47:25.087986 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:47:25.088125 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:47:25.088279 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:47:25.088421 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:47:25.088555 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:47:25.088692 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:47:25.088823 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:47:25.088958 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:47:25.089087 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:47:25.089223 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:47:25.089357 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:47:25.089525 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:47:25.089682 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:47:25.089868 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.090044 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:47:25.090234 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.090371 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:47:25.090642 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.090806 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.090940 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.093065 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:47:25.093226 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m20:47:25.094662 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:47:25.094816 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:47:25.095687 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:47:25.096601 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:47:25.097531 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:47:25.099396 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:47:25.099560 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m20:47:25.100602 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:47:25.100772 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m20:47:25.101829 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:47:25.101995 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:47:25.102154 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:47:25.102314 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:47:25.102473 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:47:25.102663 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
drop view if exists "jaffle_shop"."main"."stg_products__dbt_backup" cascade
[0m20:47:25.102862 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m20:47:25.103006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.103193 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.103642 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.103862 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:47:25.104000 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:47:25.104623 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:47:25.105652 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:47:25.105795 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:47:25.105935 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m20:47:25.106468 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:47:25.106956 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:47:25.107421 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:47:25.107878 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:47:25.108349 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:47:25.109061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107190ca0>]}
[0m20:47:25.109562 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:47:25.110061 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:47:25.110260 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f1810>]}
[0m20:47:25.110469 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f2c50>]}
[0m20:47:25.110675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107191660>]}
[0m20:47:25.110867 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107191840>]}
[0m20:47:25.111060 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107191600>]}
[0m20:47:25.111331 [info ] [Thread-1 (]: 1 of 16 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.13s]
[0m20:47:25.111541 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071917b0>]}
[0m20:47:25.114031 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071918d0>]}
[0m20:47:25.114307 [info ] [Thread-3 (]: 3 of 16 OK created sql view model main.stg_inventory_transactions .............. [[32mOK[0m in 0.13s]
[0m20:47:25.114526 [info ] [Thread-4 (]: 4 of 16 OK created sql view model main.stg_order_details ....................... [[32mOK[0m in 0.13s]
[0m20:47:25.114802 [info ] [Thread-2 (]: 2 of 16 OK created sql view model main.stg_inventory ........................... [[32mOK[0m in 0.13s]
[0m20:47:25.115068 [info ] [Thread-7 (]: 7 of 16 OK created sql view model main.stg_supplier_products ................... [[32mOK[0m in 0.13s]
[0m20:47:25.115383 [info ] [Thread-5 (]: 5 of 16 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.13s]
[0m20:47:25.115640 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:47:25.115864 [info ] [Thread-8 (]: 8 of 16 OK created sql view model main.stg_suppliers ........................... [[32mOK[0m in 0.13s]
[0m20:47:25.116136 [info ] [Thread-6 (]: 6 of 16 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.14s]
[0m20:47:25.116389 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:47:25.116608 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:47:25.116827 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:47:25.117036 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:47:25.117243 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:47:25.117517 [debug] [Thread-10 ]: Began running node model.jaffle_shop.dim_customers
[0m20:47:25.117672 [debug] [Thread-11 ]: Began running node model.jaffle_shop.dim_products
[0m20:47:25.117887 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:47:25.118101 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:47:25.118480 [debug] [Thread-13 ]: Began running node model.jaffle_shop.fact_sales
[0m20:47:25.118669 [info ] [Thread-10 ]: 9 of 16 START sql table model main.dim_customers ............................... [RUN]
[0m20:47:25.118887 [info ] [Thread-11 ]: 10 of 16 START sql table model main.dim_products ............................... [RUN]
[0m20:47:25.119172 [debug] [Thread-15 ]: Began running node model.jaffle_shop.low_stock
[0m20:47:25.119353 [info ] [Thread-13 ]: 11 of 16 START sql table model main.fact_sales ................................. [RUN]
[0m20:47:25.119595 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m20:47:25.119800 [debug] [Thread-11 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_products'
[0m20:47:25.119987 [info ] [Thread-15 ]: 12 of 16 START sql table model main.low_stock .................................. [RUN]
[0m20:47:25.120195 [debug] [Thread-13 ]: Acquiring new duckdb connection 'model.jaffle_shop.fact_sales'
[0m20:47:25.120348 [debug] [Thread-10 ]: Began compiling node model.jaffle_shop.dim_customers
[0m20:47:25.120493 [debug] [Thread-11 ]: Began compiling node model.jaffle_shop.dim_products
[0m20:47:25.120693 [debug] [Thread-15 ]: Acquiring new duckdb connection 'model.jaffle_shop.low_stock'
[0m20:47:25.120841 [debug] [Thread-13 ]: Began compiling node model.jaffle_shop.fact_sales
[0m20:47:25.122151 [debug] [Thread-10 ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:47:25.123919 [debug] [Thread-11 ]: Writing injected SQL for node "model.jaffle_shop.dim_products"
[0m20:47:25.124073 [debug] [Thread-15 ]: Began compiling node model.jaffle_shop.low_stock
[0m20:47:25.125224 [debug] [Thread-13 ]: Writing injected SQL for node "model.jaffle_shop.fact_sales"
[0m20:47:25.126650 [debug] [Thread-15 ]: Writing injected SQL for node "model.jaffle_shop.low_stock"
[0m20:47:25.126930 [debug] [Thread-11 ]: Began executing node model.jaffle_shop.dim_products
[0m20:47:25.133370 [debug] [Thread-10 ]: Began executing node model.jaffle_shop.dim_customers
[0m20:47:25.136036 [debug] [Thread-11 ]: Writing runtime sql for node "model.jaffle_shop.dim_products"
[0m20:47:25.137697 [debug] [Thread-10 ]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m20:47:25.137913 [debug] [Thread-13 ]: Began executing node model.jaffle_shop.fact_sales
[0m20:47:25.138065 [debug] [Thread-15 ]: Began executing node model.jaffle_shop.low_stock
[0m20:47:25.139498 [debug] [Thread-13 ]: Writing runtime sql for node "model.jaffle_shop.fact_sales"
[0m20:47:25.139652 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:47:25.141494 [debug] [Thread-15 ]: Writing runtime sql for node "model.jaffle_shop.low_stock"
[0m20:47:25.141691 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:47:25.141857 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: BEGIN
[0m20:47:25.142044 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:47:25.142192 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: BEGIN
[0m20:47:25.142364 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m20:47:25.142580 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:47:25.142724 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: BEGIN
[0m20:47:25.142867 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m20:47:25.145109 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: BEGIN
[0m20:47:25.145257 [debug] [Thread-11 ]: SQL status: OK in 0.003 seconds
[0m20:47:25.145415 [debug] [Thread-13 ]: Opening a new connection, currently in state init
[0m20:47:25.145612 [debug] [Thread-15 ]: Opening a new connection, currently in state init
[0m20:47:25.145748 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m20:47:25.145888 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:47:25.146114 [debug] [Thread-13 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.146259 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:47:25.146404 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.146560 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_products__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:47:25.146715 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:47:25.146873 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:47:25.147037 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:47:25.147219 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fact_sales__dbt_tmp"
  
    as (
      SELECT
  od.order_id,
  o.order_date,
  od.product_id,
  od.quantity,
  od.unit_price,
  od.line_total,
  o.customer_id
FROM "jaffle_shop"."main"."stg_order_details" AS od
JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
    );
  
  
[0m20:47:25.147433 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */

  
    
    

    create  table
      "jaffle_shop"."main"."low_stock__dbt_tmp"
  
    as (
      WITH dim_products AS (
    SELECT
      product_id,
      product_name,
      category,
      price,
      created_at AS product_created_date
    FROM "jaffle_shop"."main"."stg_products"
),

inventory_status AS (
    SELECT
      i.product_id,
      p.product_name,
      i.quantity,
      i.last_updated
    FROM "jaffle_shop"."main"."stg_inventory" AS i
    JOIN "jaffle_shop"."main"."stg_products" AS p ON i.product_id = p.product_id
),

current_inventory AS (
    SELECT
        i.product_id,
        p.product_name,
        p.category,
        i.quantity,
        i.last_updated
    FROM inventory_status AS i
    JOIN dim_products AS p ON i.product_id = p.product_id
),

low_stock_products AS (
    SELECT
        ci.product_id,
        ci.product_name,
        ci.category,
        ci.quantity,
        ci.last_updated
    FROM current_inventory AS ci
    WHERE ci.quantity < 20
)

SELECT * FROM low_stock_products
ORDER BY quantity ASC
    );
  
  
[0m20:47:25.149190 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m20:47:25.149344 [debug] [Thread-11 ]: SQL status: OK in 0.002 seconds
[0m20:47:25.149514 [debug] [Thread-13 ]: SQL status: OK in 0.002 seconds
[0m20:47:25.150886 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:47:25.151085 [debug] [Thread-15 ]: SQL status: OK in 0.003 seconds
[0m20:47:25.152206 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:47:25.153270 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:47:25.153426 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m20:47:25.154677 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:47:25.154846 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m20:47:25.155019 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m20:47:25.155224 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock__dbt_tmp" rename to "low_stock"
[0m20:47:25.155444 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.155579 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.155731 [debug] [Thread-13 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.156930 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:47:25.157069 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.158224 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:47:25.159343 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:47:25.160014 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:47:25.161940 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: COMMIT
[0m20:47:25.162094 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m20:47:25.162234 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m20:47:25.162406 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:47:25.162581 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.162756 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.162908 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: COMMIT
[0m20:47:25.163465 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:47:25.163602 [debug] [Thread-13 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.164093 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: COMMIT
[0m20:47:25.164268 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:47:25.164779 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:47:25.164924 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.165283 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:47:25.165451 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:47:25.165681 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:47:25.166686 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:47:25.166857 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: COMMIT
[0m20:47:25.167046 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:47:25.167212 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
drop table if exists "jaffle_shop"."main"."low_stock__dbt_backup" cascade
[0m20:47:25.167354 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.168609 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:47:25.168784 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m20:47:25.168917 [debug] [Thread-11 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.169065 [debug] [Thread-13 ]: SQL status: OK in 0.002 seconds
[0m20:47:25.169230 [debug] [Thread-15 ]: SQL status: OK in 0.002 seconds
[0m20:47:25.170196 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:47:25.171178 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:47:25.171323 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m20:47:25.171913 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: Close
[0m20:47:25.172075 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
drop table if exists "jaffle_shop"."main"."dim_products__dbt_backup" cascade
[0m20:47:25.172241 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
drop table if exists "jaffle_shop"."main"."fact_sales__dbt_backup" cascade
[0m20:47:25.172755 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: Close
[0m20:47:25.173042 [debug] [Thread-15 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b2500>]}
[0m20:47:25.173475 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664f0d0>]}
[0m20:47:25.173916 [debug] [Thread-11 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.174054 [debug] [Thread-13 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.173779 [info ] [Thread-15 ]: 12 of 16 OK created sql table model main.low_stock ............................. [[32mOK[0m in 0.05s]
[0m20:47:25.174318 [info ] [Thread-10 ]: 9 of 16 OK created sql table model main.dim_customers .......................... [[32mOK[0m in 0.05s]
[0m20:47:25.174830 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: Close
[0m20:47:25.175288 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: Close
[0m20:47:25.175501 [debug] [Thread-15 ]: Finished running node model.jaffle_shop.low_stock
[0m20:47:25.175699 [debug] [Thread-10 ]: Finished running node model.jaffle_shop.dim_customers
[0m20:47:25.175900 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b3a90>]}
[0m20:47:25.179818 [debug] [Thread-13 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664c9a0>]}
[0m20:47:25.180203 [debug] [Thread-17 ]: Began running node model.jaffle_shop.avg_order_value
[0m20:47:25.180379 [debug] [Thread-18 ]: Began running node model.jaffle_shop.customer_LTV
[0m20:47:25.180677 [info ] [Thread-11 ]: 10 of 16 OK created sql table model main.dim_products .......................... [[32mOK[0m in 0.06s]
[0m20:47:25.180950 [info ] [Thread-13 ]: 11 of 16 OK created sql table model main.fact_sales ............................ [[32mOK[0m in 0.06s]
[0m20:47:25.181120 [info ] [Thread-17 ]: 13 of 16 START sql table model main.avg_order_value ............................ [RUN]
[0m20:47:25.181385 [info ] [Thread-18 ]: 14 of 16 START sql table model main.customer_LTV ............................... [RUN]
[0m20:47:25.181637 [debug] [Thread-11 ]: Finished running node model.jaffle_shop.dim_products
[0m20:47:25.181859 [debug] [Thread-13 ]: Finished running node model.jaffle_shop.fact_sales
[0m20:47:25.182087 [debug] [Thread-17 ]: Acquiring new duckdb connection 'model.jaffle_shop.avg_order_value'
[0m20:47:25.182294 [debug] [Thread-18 ]: Acquiring new duckdb connection 'model.jaffle_shop.customer_LTV'
[0m20:47:25.182546 [debug] [Thread-20 ]: Began running node model.jaffle_shop.top_category
[0m20:47:25.182801 [debug] [Thread-17 ]: Began compiling node model.jaffle_shop.avg_order_value
[0m20:47:25.182976 [debug] [Thread-22 ]: Began running node model.jaffle_shop.monthly_sales_growth
[0m20:47:25.183124 [debug] [Thread-18 ]: Began compiling node model.jaffle_shop.customer_LTV
[0m20:47:25.183327 [info ] [Thread-20 ]: 15 of 16 START sql table model main.top_category ............................... [RUN]
[0m20:47:25.184975 [debug] [Thread-17 ]: Writing injected SQL for node "model.jaffle_shop.avg_order_value"
[0m20:47:25.185175 [info ] [Thread-22 ]: 16 of 16 START sql table model main.monthly_sales_growth ....................... [RUN]
[0m20:47:25.186626 [debug] [Thread-18 ]: Writing injected SQL for node "model.jaffle_shop.customer_LTV"
[0m20:47:25.186832 [debug] [Thread-20 ]: Acquiring new duckdb connection 'model.jaffle_shop.top_category'
[0m20:47:25.187081 [debug] [Thread-22 ]: Acquiring new duckdb connection 'model.jaffle_shop.monthly_sales_growth'
[0m20:47:25.187299 [debug] [Thread-20 ]: Began compiling node model.jaffle_shop.top_category
[0m20:47:25.187438 [debug] [Thread-17 ]: Began executing node model.jaffle_shop.avg_order_value
[0m20:47:25.187631 [debug] [Thread-22 ]: Began compiling node model.jaffle_shop.monthly_sales_growth
[0m20:47:25.189044 [debug] [Thread-20 ]: Writing injected SQL for node "model.jaffle_shop.top_category"
[0m20:47:25.189209 [debug] [Thread-18 ]: Began executing node model.jaffle_shop.customer_LTV
[0m20:47:25.191443 [debug] [Thread-17 ]: Writing runtime sql for node "model.jaffle_shop.avg_order_value"
[0m20:47:25.192824 [debug] [Thread-22 ]: Writing injected SQL for node "model.jaffle_shop.monthly_sales_growth"
[0m20:47:25.194495 [debug] [Thread-18 ]: Writing runtime sql for node "model.jaffle_shop.customer_LTV"
[0m20:47:25.194794 [debug] [Thread-20 ]: Began executing node model.jaffle_shop.top_category
[0m20:47:25.196313 [debug] [Thread-20 ]: Writing runtime sql for node "model.jaffle_shop.top_category"
[0m20:47:25.196549 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:47:25.196691 [debug] [Thread-22 ]: Began executing node model.jaffle_shop.monthly_sales_growth
[0m20:47:25.196840 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:47:25.197003 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: BEGIN
[0m20:47:25.197148 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:47:25.198554 [debug] [Thread-22 ]: Writing runtime sql for node "model.jaffle_shop.monthly_sales_growth"
[0m20:47:25.198699 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: BEGIN
[0m20:47:25.198950 [debug] [Thread-18 ]: Opening a new connection, currently in state init
[0m20:47:25.199106 [debug] [Thread-20 ]: On model.jaffle_shop.top_category: BEGIN
[0m20:47:25.199302 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m20:47:25.201796 [debug] [Thread-20 ]: Opening a new connection, currently in state init
[0m20:47:25.201946 [debug] [Thread-18 ]: SQL status: OK in 0.003 seconds
[0m20:47:25.202145 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:47:25.202319 [debug] [Thread-17 ]: SQL status: OK in 0.003 seconds
[0m20:47:25.202475 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:47:25.202614 [debug] [Thread-20 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.202759 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: BEGIN
[0m20:47:25.202930 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:47:25.203120 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */

  
    
    

    create  table
      "jaffle_shop"."main"."customer_LTV__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_revenue AS (
    SELECT
        fs.customer_id,
        SUM(fs.line_total) AS total_revenue,
        MIN(fs.order_date) AS first_purchase_date,
        MAX(fs.order_date) AS last_purchase_date,
        COUNT(DISTINCT fs.order_id) AS total_orders
    FROM fact_sales AS fs
    GROUP BY fs.customer_id
),

customer_ltv AS (
    SELECT
        cr.customer_id,
        dc.first_name,
        dc.last_name,
        cr.total_revenue,
        cr.total_orders,
        DATE_PART('day', cr.last_purchase_date - cr.first_purchase_date) AS customer_lifespan_days,
        ROUND(cr.total_revenue / NULLIF(cr.total_orders, 0), 2) AS avg_order_value,
        ROUND(cr.total_revenue / NULLIF(DATE_PART('day', CURRENT_DATE - cr.first_purchase_date) / 30, 0), 2) AS monthly_ltv
    FROM customer_revenue AS cr
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cr.customer_id = dc.customer_id
)

SELECT * FROM customer_ltv
ORDER BY total_revenue DESC
    );
  
  
[0m20:47:25.203312 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:47:25.203458 [debug] [Thread-22 ]: Opening a new connection, currently in state init
[0m20:47:25.203641 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */

  
    
    

    create  table
      "jaffle_shop"."main"."avg_order_value__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_order_totals AS (
    SELECT
        customer_id,
        COUNT(DISTINCT order_id) AS total_orders,
        SUM(line_total) AS total_spent
    FROM fact_sales
    GROUP BY customer_id
    HAVING COUNT(DISTINCT order_id) > 3
),

average_order_value AS (
    SELECT
        cot.customer_id,
        dc.first_name,
        dc.last_name,
        cot.total_orders,
        cot.total_spent,
        ROUND(cot.total_spent / cot.total_orders, 1) AS avg_order_value
    FROM customer_order_totals AS cot
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cot.customer_id = dc.customer_id
)

SELECT * FROM average_order_value
ORDER BY avg_order_value DESC
    );
  
  
[0m20:47:25.203872 [debug] [Thread-20 ]: On model.jaffle_shop.top_category: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

ranked_categories AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS sales_rank
    FROM category_sales AS cs
)

SELECT * FROM ranked_categories
ORDER BY sales_rank
    );
  
  
[0m20:47:25.204108 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.204380 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:47:25.204580 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */

  
    
    

    create  table
      "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

monthly_sales AS (
    SELECT
        DATE_TRUNC('month', order_date) AS sales_month,
        SUM(line_total) AS total_revenue,
        SUM(quantity) AS total_quantity_sold
    FROM "jaffle_shop"."main"."fact_sales"
    GROUP BY sales_month
),

sales_growth AS (
    SELECT
        ms.sales_month,
        ms.total_revenue,
        ms.total_quantity_sold,
        LAG(ms.total_revenue) OVER (ORDER BY ms.sales_month) AS previous_revenue,
        LAG(ms.total_quantity_sold) OVER (ORDER BY ms.sales_month) AS previous_quantity
    FROM monthly_sales AS ms
),

growth_calculations AS (
    SELECT
        sg.sales_month,
        sg.total_revenue,
        sg.total_quantity_sold,
        ROUND(((sg.total_revenue - sg.previous_revenue) / sg.previous_revenue) * 100, 2) AS revenue_growth_percentage,
        ROUND(((sg.total_quantity_sold - sg.previous_quantity) / sg.previous_quantity) * 100, 2) AS quantity_growth_percentage
    FROM sales_growth AS sg
    WHERE sg.previous_revenue IS NOT NULL
)

SELECT * FROM growth_calculations
ORDER BY sales_month ASC
    );
  
  
[0m20:47:25.206950 [debug] [Thread-20 ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

ranked_categories AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS sales_rank
    FROM category_sales AS cs
)

SELECT * FROM ranked_categories
ORDER BY sales_rank
    );
  
  
[0m20:47:25.207199 [debug] [Thread-20 ]: DuckDB adapter: Rolling back transaction.
[0m20:47:25.207420 [debug] [Thread-17 ]: SQL status: OK in 0.003 seconds
[0m20:47:25.207661 [debug] [Thread-20 ]: On model.jaffle_shop.top_category: ROLLBACK
[0m20:47:25.207827 [debug] [Thread-22 ]: SQL status: OK in 0.003 seconds
[0m20:47:25.208141 [debug] [Thread-18 ]: SQL status: OK in 0.004 seconds
[0m20:47:25.209557 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:47:25.211361 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:47:25.212500 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:47:25.212712 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value" rename to "avg_order_value__dbt_backup"
[0m20:47:25.212906 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth" rename to "monthly_sales_growth__dbt_backup"
[0m20:47:25.213119 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV" rename to "customer_LTV__dbt_backup"
[0m20:47:25.213498 [debug] [Thread-22 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.213639 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.214977 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:47:25.215119 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.216308 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:47:25.216474 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp" rename to "monthly_sales_growth"
[0m20:47:25.217630 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:47:25.217856 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value__dbt_tmp" rename to "avg_order_value"
[0m20:47:25.218277 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV__dbt_tmp" rename to "customer_LTV"
[0m20:47:25.218494 [debug] [Thread-22 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.218690 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.219295 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:47:25.219461 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.220129 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:47:25.220376 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:47:25.220909 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:47:25.221078 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:47:25.221224 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:47:25.221422 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:47:25.221581 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:47:25.221807 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:47:25.222017 [debug] [Thread-22 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.223059 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:47:25.223256 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
drop table if exists "jaffle_shop"."main"."monthly_sales_growth__dbt_backup" cascade
[0m20:47:25.223462 [debug] [Thread-17 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.223594 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.224644 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:47:25.226213 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:47:25.226602 [debug] [Thread-20 ]: Failed to rollback 'model.jaffle_shop.top_category'
[0m20:47:25.226738 [debug] [Thread-22 ]: SQL status: OK in 0.003 seconds
[0m20:47:25.226886 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
drop table if exists "jaffle_shop"."main"."avg_order_value__dbt_backup" cascade
[0m20:47:25.227044 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
drop table if exists "jaffle_shop"."main"."customer_LTV__dbt_backup" cascade
[0m20:47:25.227193 [debug] [Thread-20 ]: On model.jaffle_shop.top_category: Close
[0m20:47:25.227770 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: Close
[0m20:47:25.228237 [debug] [Thread-22 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664ee60>]}
[0m20:47:25.228389 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m20:47:25.228530 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m20:47:25.229225 [debug] [Thread-20 ]: Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:47:25.228854 [info ] [Thread-22 ]: 16 of 16 OK created sql table model main.monthly_sales_growth .................. [[32mOK[0m in 0.04s]
[0m20:47:25.229808 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: Close
[0m20:47:25.230262 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: Close
[0m20:47:25.230424 [debug] [Thread-20 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074817e0>]}
[0m20:47:25.230669 [debug] [Thread-22 ]: Finished running node model.jaffle_shop.monthly_sales_growth
[0m20:47:25.230881 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ef790>]}
[0m20:47:25.233797 [debug] [Thread-18 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47b97ecc-8dfe-4617-a2e8-9a1b1824aa7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107477910>]}
[0m20:47:25.234081 [error] [Thread-20 ]: 15 of 16 ERROR creating sql table model main.top_category ...................... [[31mERROR[0m in 0.04s]
[0m20:47:25.234442 [info ] [Thread-17 ]: 13 of 16 OK created sql table model main.avg_order_value ....................... [[32mOK[0m in 0.05s]
[0m20:47:25.234722 [info ] [Thread-18 ]: 14 of 16 OK created sql table model main.customer_LTV .......................... [[32mOK[0m in 0.05s]
[0m20:47:25.234999 [debug] [Thread-20 ]: Finished running node model.jaffle_shop.top_category
[0m20:47:25.235218 [debug] [Thread-17 ]: Finished running node model.jaffle_shop.avg_order_value
[0m20:47:25.235443 [debug] [Thread-18 ]: Finished running node model.jaffle_shop.customer_LTV
[0m20:47:25.236492 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:25.236641 [debug] [MainThread]: On master: BEGIN
[0m20:47:25.236765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:47:25.238850 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:47:25.238994 [debug] [MainThread]: On master: COMMIT
[0m20:47:25.239115 [debug] [MainThread]: Using duckdb connection "master"
[0m20:47:25.239222 [debug] [MainThread]: On master: COMMIT
[0m20:47:25.239353 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:47:25.239477 [debug] [MainThread]: On master: Close
[0m20:47:25.239933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:25.240054 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:47:25.240153 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m20:47:25.240252 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:47:25.240358 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:47:25.240460 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:47:25.240569 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m20:47:25.240677 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:47:25.240796 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:47:25.240905 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m20:47:25.241010 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_products' was properly closed.
[0m20:47:25.241114 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_sales' was properly closed.
[0m20:47:25.241229 [debug] [MainThread]: Connection 'model.jaffle_shop.low_stock' was properly closed.
[0m20:47:25.241333 [debug] [MainThread]: Connection 'model.jaffle_shop.avg_order_value' was properly closed.
[0m20:47:25.241442 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_LTV' was properly closed.
[0m20:47:25.241545 [debug] [MainThread]: Connection 'model.jaffle_shop.top_category' was properly closed.
[0m20:47:25.241646 [debug] [MainThread]: Connection 'model.jaffle_shop.monthly_sales_growth' was properly closed.
[0m20:47:25.241842 [info ] [MainThread]: 
[0m20:47:25.241984 [info ] [MainThread]: Finished running 8 view models, 8 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m20:47:25.243015 [debug] [MainThread]: Command end result
[0m20:47:25.287496 [info ] [MainThread]: 
[0m20:47:25.287729 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:47:25.287861 [info ] [MainThread]: 
[0m20:47:25.288044 [error] [MainThread]:   Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:47:25.288239 [info ] [MainThread]: 
[0m20:47:25.288387 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m20:47:25.289736 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80094355, "process_user_time": 1.148707, "process_kernel_time": 0.137101, "process_mem_max_rss": "169132032", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:47:25.289950 [debug] [MainThread]: Command `dbt run` failed at 20:47:25.289913 after 0.80 seconds
[0m20:47:25.290110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104822950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107628430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762a290>]}
[0m20:47:25.290252 [debug] [MainThread]: Flushing usage events
[0m20:48:06.246472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102336950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b5bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b5b8b0>]}


============================== 20:48:06.249613 | 65b612d4-8d90-480b-8b89-6df77a1086c9 ==============================
[0m20:48:06.249613 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:48:06.249874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:48:06.373310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b1aad0>]}
[0m20:48:06.394221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f63430>]}
[0m20:48:06.394666 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:48:06.402467 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:48:06.472115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:48:06.472429 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/top_category.sql
[0m20:48:06.576604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a7ee0>]}
[0m20:48:06.632632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041bace0>]}
[0m20:48:06.632907 [info ] [MainThread]: Found 8 seeds, 16 models, 5 data tests, 423 macros
[0m20:48:06.633067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041bac80>]}
[0m20:48:06.633972 [info ] [MainThread]: 
[0m20:48:06.634227 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:48:06.636884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:48:06.661612 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:48:06.661852 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:48:06.661994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:06.671248 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:48:06.671849 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:48:06.672918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:48:06.673124 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:48:06.676092 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:48:06.676244 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:48:06.676368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:06.678476 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:48:06.678980 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:48:06.679114 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:48:06.679257 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:48:06.679371 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:48:06.679491 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:48:06.679688 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:48:06.680120 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:48:06.680246 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:48:06.680365 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:48:06.680504 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:48:06.680623 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:48:06.682063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:48:06.684547 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:48:06.684695 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:48:06.684822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:06.686994 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:48:06.687126 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:48:06.687246 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:48:06.696681 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:48:06.699011 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:48:06.699429 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:48:06.699550 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:48:06.701322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da3c10>]}
[0m20:48:06.701553 [debug] [MainThread]: Using duckdb connection "master"
[0m20:48:06.701689 [debug] [MainThread]: On master: BEGIN
[0m20:48:06.701807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:06.703887 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:48:06.704026 [debug] [MainThread]: On master: COMMIT
[0m20:48:06.704149 [debug] [MainThread]: Using duckdb connection "master"
[0m20:48:06.704267 [debug] [MainThread]: On master: COMMIT
[0m20:48:06.704406 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:48:06.704525 [debug] [MainThread]: On master: Close
[0m20:48:06.704994 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:48:06.705146 [info ] [MainThread]: 
[0m20:48:06.706899 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:48:06.707074 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:48:06.707271 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:48:06.707441 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:48:06.707820 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:48:06.707664 [info ] [Thread-1 (]: 1 of 16 START sql view model main.stg_customers ................................ [RUN]
[0m20:48:06.708022 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:48:06.708169 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:48:06.708356 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:48:06.708557 [info ] [Thread-2 (]: 2 of 16 START sql view model main.stg_inventory ................................ [RUN]
[0m20:48:06.708796 [info ] [Thread-3 (]: 3 of 16 START sql view model main.stg_inventory_transactions ................... [RUN]
[0m20:48:06.709019 [info ] [Thread-4 (]: 4 of 16 START sql view model main.stg_order_details ............................ [RUN]
[0m20:48:06.709246 [info ] [Thread-5 (]: 5 of 16 START sql view model main.stg_orders ................................... [RUN]
[0m20:48:06.709474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:48:06.709671 [info ] [Thread-6 (]: 6 of 16 START sql view model main.stg_products ................................. [RUN]
[0m20:48:06.709885 [info ] [Thread-7 (]: 7 of 16 START sql view model main.stg_supplier_products ........................ [RUN]
[0m20:48:06.710109 [info ] [Thread-8 (]: 8 of 16 START sql view model main.stg_suppliers ................................ [RUN]
[0m20:48:06.710336 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:48:06.710545 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:48:06.710755 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:48:06.710944 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:48:06.711097 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:48:06.711284 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:48:06.711473 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:48:06.711657 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:48:06.711797 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:48:06.711951 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:48:06.712099 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:48:06.712243 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:48:06.717698 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:48:06.717869 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:48:06.718025 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:48:06.718161 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:48:06.742254 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:48:06.743445 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:48:06.744470 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:48:06.745798 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:48:06.747452 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:48:06.748711 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:48:06.748874 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:48:06.750033 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:48:06.750383 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:48:06.750634 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:48:06.750776 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:48:06.750939 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:48:06.764970 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:48:06.765132 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:48:06.766662 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:48:06.766799 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:48:06.768265 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:48:06.768409 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:48:06.770033 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:48:06.771503 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:48:06.773245 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:48:06.774717 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:48:06.774904 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:48:06.775121 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:48:06.776547 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:48:06.776807 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:48:06.777024 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:48:06.777261 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:48:06.777413 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:48:06.777567 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:48:06.777741 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:48:06.777896 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:48:06.778080 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:48:06.778245 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:48:06.778401 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:48:06.778545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:06.778690 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:48:06.778829 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:48:06.778976 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:48:06.779123 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:48:06.779260 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:48:06.779398 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:48:06.779549 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:48:06.781739 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:48:06.781900 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:48:06.782059 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:48:06.782244 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:48:06.782395 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:48:06.782600 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:48:06.782734 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m20:48:06.782883 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:48:06.783079 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:48:06.783222 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.783435 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:48:06.783575 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:48:06.783708 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.783901 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.784037 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:48:06.784196 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:48:06.784374 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(first_name), 1, 1)), LOWER(SUBSTRING(TRIM(first_name), 2)))
 AS first_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(last_name), 1, 1)), LOWER(SUBSTRING(TRIM(last_name), 2)))
 AS last_name,
  LOWER(TRIM(email)) AS email,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:48:06.784544 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:48:06.784706 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:48:06.784874 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:48:06.785029 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:48:06.785176 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:48:06.785329 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:48:06.785523 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:48:06.785744 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  
  TRY_CAST(product_id AS INTEGER)
 AS product_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))
 AS product_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))
 AS category,
  
  TRY_CAST(price AS DECIMAL(10,2))
 AS price,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:48:06.785969 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:48:06.786134 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.786280 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.786435 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:48:06.786607 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:48:06.789458 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:48:06.790794 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:48:06.790946 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:48:06.791077 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m20:48:06.791213 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:48:06.791371 [debug] [Thread-6 (]: SQL status: OK in 0.005 seconds
[0m20:48:06.791575 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:48:06.791752 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:48:06.791892 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.792032 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.793335 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:48:06.794548 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:48:06.796068 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:48:06.797165 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:48:06.798530 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:48:06.798669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.798794 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.799953 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:48:06.800104 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m20:48:06.800243 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:48:06.800390 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions" rename to "stg_inventory_transactions__dbt_backup"
[0m20:48:06.800527 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:48:06.800668 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m20:48:06.801729 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:48:06.802985 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:48:06.803147 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:48:06.803414 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.803548 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.803689 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.803904 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:48:06.804038 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.804164 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.804309 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:48:06.805482 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:48:06.806937 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:48:06.807068 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m20:48:06.808141 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:48:06.809314 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:48:06.810429 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:48:06.810563 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:48:06.810759 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:48:06.810925 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:48:06.811047 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.812083 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:48:06.812237 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m20:48:06.812382 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:48:06.812527 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:48:06.819306 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:48:06.819869 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:48:06.820015 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.820158 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:48:06.820313 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.820477 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.820648 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.820786 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:48:06.820917 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.821048 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:48:06.821520 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:48:06.822105 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:48:06.822604 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:48:06.822746 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.823294 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:48:06.823455 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:48:06.823961 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:48:06.824106 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:48:06.824246 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:48:06.824380 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:48:06.824515 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:48:06.824967 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:48:06.825113 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:48:06.825285 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:48:06.825487 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:48:06.825636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.825766 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.825908 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:48:06.826055 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:48:06.826191 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:48:06.826325 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:48:06.826464 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:48:06.828552 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:48:06.828698 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:48:06.829671 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:48:06.829883 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:48:06.830025 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.830667 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.830868 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m20:48:06.831016 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.831964 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:48:06.832090 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.832234 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:48:06.833213 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:48:06.833347 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.834240 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:48:06.835243 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:48:06.835410 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:48:06.836417 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:48:06.836555 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:48:06.836732 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:48:06.837769 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:48:06.837918 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.838070 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m20:48:06.838226 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
drop view if exists "jaffle_shop"."main"."stg_products__dbt_backup" cascade
[0m20:48:06.838411 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:48:06.839421 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:48:06.839563 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.839741 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m20:48:06.840269 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:48:06.840408 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.840627 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:48:06.841279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b4e80>]}
[0m20:48:06.841428 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.841942 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:48:06.842081 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.842296 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b5840>]}
[0m20:48:06.842814 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:48:06.842960 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:48:06.843421 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:48:06.843685 [info ] [Thread-1 (]: 1 of 16 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.13s]
[0m20:48:06.844206 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:48:06.844401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048270a0>]}
[0m20:48:06.844904 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:48:06.845132 [info ] [Thread-2 (]: 2 of 16 OK created sql view model main.stg_inventory ........................... [[32mOK[0m in 0.13s]
[0m20:48:06.845351 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b57e0>]}
[0m20:48:06.845851 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:48:06.846037 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b52d0>]}
[0m20:48:06.846273 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:48:06.846463 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b5ab0>]}
[0m20:48:06.846718 [info ] [Thread-4 (]: 4 of 16 OK created sql view model main.stg_order_details ....................... [[32mOK[0m in 0.13s]
[0m20:48:06.846941 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046dbfd0>]}
[0m20:48:06.847169 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:48:06.847389 [info ] [Thread-5 (]: 5 of 16 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.13s]
[0m20:48:06.849432 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e7cd0>]}
[0m20:48:06.849701 [info ] [Thread-3 (]: 3 of 16 OK created sql view model main.stg_inventory_transactions .............. [[32mOK[0m in 0.14s]
[0m20:48:06.850027 [debug] [Thread-10 ]: Began running node model.jaffle_shop.dim_customers
[0m20:48:06.850397 [debug] [Thread-11 ]: Began running node model.jaffle_shop.dim_products
[0m20:48:06.850252 [info ] [Thread-6 (]: 6 of 16 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.14s]
[0m20:48:06.850647 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:48:06.850888 [info ] [Thread-7 (]: 7 of 16 OK created sql view model main.stg_supplier_products ................... [[32mOK[0m in 0.14s]
[0m20:48:06.851193 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:48:06.851424 [info ] [Thread-8 (]: 8 of 16 OK created sql view model main.stg_suppliers ........................... [[32mOK[0m in 0.14s]
[0m20:48:06.851668 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:48:06.851868 [info ] [Thread-10 ]: 9 of 16 START sql table model main.dim_customers ............................... [RUN]
[0m20:48:06.852085 [info ] [Thread-11 ]: 10 of 16 START sql table model main.dim_products ............................... [RUN]
[0m20:48:06.852318 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:48:06.852584 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:48:06.852820 [debug] [Thread-13 ]: Began running node model.jaffle_shop.fact_sales
[0m20:48:06.853047 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:48:06.853320 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m20:48:06.853532 [debug] [Thread-11 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_products'
[0m20:48:06.853783 [debug] [Thread-15 ]: Began running node model.jaffle_shop.low_stock
[0m20:48:06.854040 [info ] [Thread-13 ]: 11 of 16 START sql table model main.fact_sales ................................. [RUN]
[0m20:48:06.854255 [debug] [Thread-10 ]: Began compiling node model.jaffle_shop.dim_customers
[0m20:48:06.854405 [debug] [Thread-11 ]: Began compiling node model.jaffle_shop.dim_products
[0m20:48:06.854600 [info ] [Thread-15 ]: 12 of 16 START sql table model main.low_stock .................................. [RUN]
[0m20:48:06.855469 [debug] [Thread-13 ]: Acquiring new duckdb connection 'model.jaffle_shop.fact_sales'
[0m20:48:06.856954 [debug] [Thread-10 ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:48:06.858899 [debug] [Thread-11 ]: Writing injected SQL for node "model.jaffle_shop.dim_products"
[0m20:48:06.859126 [debug] [Thread-15 ]: Acquiring new duckdb connection 'model.jaffle_shop.low_stock'
[0m20:48:06.859287 [debug] [Thread-13 ]: Began compiling node model.jaffle_shop.fact_sales
[0m20:48:06.859746 [debug] [Thread-15 ]: Began compiling node model.jaffle_shop.low_stock
[0m20:48:06.861256 [debug] [Thread-13 ]: Writing injected SQL for node "model.jaffle_shop.fact_sales"
[0m20:48:06.862667 [debug] [Thread-15 ]: Writing injected SQL for node "model.jaffle_shop.low_stock"
[0m20:48:06.862820 [debug] [Thread-11 ]: Began executing node model.jaffle_shop.dim_products
[0m20:48:06.862959 [debug] [Thread-10 ]: Began executing node model.jaffle_shop.dim_customers
[0m20:48:06.872220 [debug] [Thread-11 ]: Writing runtime sql for node "model.jaffle_shop.dim_products"
[0m20:48:06.874173 [debug] [Thread-10 ]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m20:48:06.874356 [debug] [Thread-13 ]: Began executing node model.jaffle_shop.fact_sales
[0m20:48:06.874558 [debug] [Thread-15 ]: Began executing node model.jaffle_shop.low_stock
[0m20:48:06.876231 [debug] [Thread-13 ]: Writing runtime sql for node "model.jaffle_shop.fact_sales"
[0m20:48:06.878448 [debug] [Thread-15 ]: Writing runtime sql for node "model.jaffle_shop.low_stock"
[0m20:48:06.878725 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:48:06.878888 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:48:06.879107 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: BEGIN
[0m20:48:06.879257 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:48:06.879430 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: BEGIN
[0m20:48:06.879585 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:48:06.879734 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m20:48:06.879884 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: BEGIN
[0m20:48:06.880036 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m20:48:06.880193 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: BEGIN
[0m20:48:06.882623 [debug] [Thread-13 ]: Opening a new connection, currently in state init
[0m20:48:06.882795 [debug] [Thread-11 ]: SQL status: OK in 0.003 seconds
[0m20:48:06.882963 [debug] [Thread-15 ]: Opening a new connection, currently in state init
[0m20:48:06.883139 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m20:48:06.883311 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:48:06.883449 [debug] [Thread-13 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.883633 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:48:06.883782 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.883934 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_products__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:48:06.884103 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:48:06.884266 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:48:06.884430 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:48:06.884636 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fact_sales__dbt_tmp"
  
    as (
      SELECT
  od.order_id,
  o.order_date,
  od.product_id,
  od.quantity,
  od.unit_price,
  od.line_total,
  o.customer_id
FROM "jaffle_shop"."main"."stg_order_details" AS od
JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
    );
  
  
[0m20:48:06.884856 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */

  
    
    

    create  table
      "jaffle_shop"."main"."low_stock__dbt_tmp"
  
    as (
      WITH dim_products AS (
    SELECT
      product_id,
      product_name,
      category,
      price,
      created_at AS product_created_date
    FROM "jaffle_shop"."main"."stg_products"
),

inventory_status AS (
    SELECT
      i.product_id,
      p.product_name,
      i.quantity,
      i.last_updated
    FROM "jaffle_shop"."main"."stg_inventory" AS i
    JOIN "jaffle_shop"."main"."stg_products" AS p ON i.product_id = p.product_id
),

current_inventory AS (
    SELECT
        i.product_id,
        p.product_name,
        p.category,
        i.quantity,
        i.last_updated
    FROM inventory_status AS i
    JOIN dim_products AS p ON i.product_id = p.product_id
),

low_stock_products AS (
    SELECT
        ci.product_id,
        ci.product_name,
        ci.category,
        ci.quantity,
        ci.last_updated
    FROM current_inventory AS ci
    WHERE ci.quantity < 20
)

SELECT * FROM low_stock_products
ORDER BY quantity ASC
    );
  
  
[0m20:48:06.886750 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m20:48:06.888284 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:48:06.888457 [debug] [Thread-11 ]: SQL status: OK in 0.004 seconds
[0m20:48:06.888604 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m20:48:06.888771 [debug] [Thread-13 ]: SQL status: OK in 0.004 seconds
[0m20:48:06.888958 [debug] [Thread-15 ]: SQL status: OK in 0.004 seconds
[0m20:48:06.890278 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:48:06.891494 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:48:06.892685 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:48:06.892852 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m20:48:06.892997 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m20:48:06.893157 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m20:48:06.893306 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock" rename to "low_stock__dbt_backup"
[0m20:48:06.894542 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:48:06.894846 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:48:06.895008 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.895161 [debug] [Thread-13 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.895293 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.896469 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:48:06.896621 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.897742 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:48:06.899450 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:48:06.899617 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m20:48:06.901779 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:48:06.901952 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m20:48:06.902104 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock__dbt_tmp" rename to "low_stock"
[0m20:48:06.902299 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:48:06.902542 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.902686 [debug] [Thread-15 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.902833 [debug] [Thread-13 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.902970 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:48:06.903652 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: COMMIT
[0m20:48:06.904193 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: COMMIT
[0m20:48:06.904707 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:48:06.904891 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:48:06.905069 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:48:06.905210 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.905348 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:48:06.905481 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: COMMIT
[0m20:48:06.905618 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: COMMIT
[0m20:48:06.906762 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:48:06.906914 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:48:06.907138 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m20:48:06.907287 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.907435 [debug] [Thread-15 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.908471 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:48:06.908614 [debug] [Thread-13 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.909577 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:48:06.909735 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
drop table if exists "jaffle_shop"."main"."dim_products__dbt_backup" cascade
[0m20:48:06.909876 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m20:48:06.910940 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:48:06.911115 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
drop table if exists "jaffle_shop"."main"."low_stock__dbt_backup" cascade
[0m20:48:06.911763 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: Close
[0m20:48:06.911934 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
drop table if exists "jaffle_shop"."main"."fact_sales__dbt_backup" cascade
[0m20:48:06.912080 [debug] [Thread-11 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.912345 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e7ca0>]}
[0m20:48:06.912924 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: Close
[0m20:48:06.913428 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041731c0>]}
[0m20:48:06.913577 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.913217 [info ] [Thread-10 ]: 9 of 16 OK created sql table model main.dim_customers .......................... [[32mOK[0m in 0.06s]
[0m20:48:06.913752 [debug] [Thread-13 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.913999 [info ] [Thread-11 ]: 10 of 16 OK created sql table model main.dim_products .......................... [[32mOK[0m in 0.06s]
[0m20:48:06.914546 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: Close
[0m20:48:06.914778 [debug] [Thread-10 ]: Finished running node model.jaffle_shop.dim_customers
[0m20:48:06.915276 [debug] [Thread-13 ]: On model.jaffle_shop.fact_sales: Close
[0m20:48:06.915492 [debug] [Thread-11 ]: Finished running node model.jaffle_shop.dim_products
[0m20:48:06.915701 [debug] [Thread-15 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ca3e0>]}
[0m20:48:06.919933 [debug] [Thread-13 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048270a0>]}
[0m20:48:06.920118 [debug] [Thread-17 ]: Began running node model.jaffle_shop.avg_order_value
[0m20:48:06.920296 [debug] [Thread-18 ]: Began running node model.jaffle_shop.customer_LTV
[0m20:48:06.920572 [debug] [Thread-20 ]: Began running node model.jaffle_shop.top_category
[0m20:48:06.920811 [info ] [Thread-15 ]: 12 of 16 OK created sql table model main.low_stock ............................. [[32mOK[0m in 0.06s]
[0m20:48:06.921089 [info ] [Thread-13 ]: 11 of 16 OK created sql table model main.fact_sales ............................ [[32mOK[0m in 0.06s]
[0m20:48:06.921302 [info ] [Thread-17 ]: 13 of 16 START sql table model main.avg_order_value ............................ [RUN]
[0m20:48:06.921516 [info ] [Thread-18 ]: 14 of 16 START sql table model main.customer_LTV ............................... [RUN]
[0m20:48:06.921738 [info ] [Thread-20 ]: 15 of 16 START sql table model main.top_category ............................... [RUN]
[0m20:48:06.921974 [debug] [Thread-15 ]: Finished running node model.jaffle_shop.low_stock
[0m20:48:06.922180 [debug] [Thread-13 ]: Finished running node model.jaffle_shop.fact_sales
[0m20:48:06.922388 [debug] [Thread-17 ]: Acquiring new duckdb connection 'model.jaffle_shop.avg_order_value'
[0m20:48:06.922582 [debug] [Thread-18 ]: Acquiring new duckdb connection 'model.jaffle_shop.customer_LTV'
[0m20:48:06.922768 [debug] [Thread-20 ]: Acquiring new duckdb connection 'model.jaffle_shop.top_category'
[0m20:48:06.923053 [debug] [Thread-22 ]: Began running node model.jaffle_shop.monthly_sales_growth
[0m20:48:06.923195 [debug] [Thread-17 ]: Began compiling node model.jaffle_shop.avg_order_value
[0m20:48:06.923347 [debug] [Thread-18 ]: Began compiling node model.jaffle_shop.customer_LTV
[0m20:48:06.923490 [debug] [Thread-20 ]: Began compiling node model.jaffle_shop.top_category
[0m20:48:06.923677 [info ] [Thread-22 ]: 16 of 16 START sql table model main.monthly_sales_growth ....................... [RUN]
[0m20:48:06.925255 [debug] [Thread-17 ]: Writing injected SQL for node "model.jaffle_shop.avg_order_value"
[0m20:48:06.926599 [debug] [Thread-18 ]: Writing injected SQL for node "model.jaffle_shop.customer_LTV"
[0m20:48:06.928606 [debug] [Thread-20 ]: Writing injected SQL for node "model.jaffle_shop.top_category"
[0m20:48:06.928810 [debug] [Thread-22 ]: Acquiring new duckdb connection 'model.jaffle_shop.monthly_sales_growth'
[0m20:48:06.929081 [debug] [Thread-22 ]: Began compiling node model.jaffle_shop.monthly_sales_growth
[0m20:48:06.930495 [debug] [Thread-22 ]: Writing injected SQL for node "model.jaffle_shop.monthly_sales_growth"
[0m20:48:06.930659 [debug] [Thread-17 ]: Began executing node model.jaffle_shop.avg_order_value
[0m20:48:06.930804 [debug] [Thread-20 ]: Began executing node model.jaffle_shop.top_category
[0m20:48:06.930934 [debug] [Thread-18 ]: Began executing node model.jaffle_shop.customer_LTV
[0m20:48:06.932390 [debug] [Thread-17 ]: Writing runtime sql for node "model.jaffle_shop.avg_order_value"
[0m20:48:06.933948 [debug] [Thread-20 ]: Writing runtime sql for node "model.jaffle_shop.top_category"
[0m20:48:06.935483 [debug] [Thread-18 ]: Writing runtime sql for node "model.jaffle_shop.customer_LTV"
[0m20:48:06.935630 [debug] [Thread-22 ]: Began executing node model.jaffle_shop.monthly_sales_growth
[0m20:48:06.937178 [debug] [Thread-22 ]: Writing runtime sql for node "model.jaffle_shop.monthly_sales_growth"
[0m20:48:06.937447 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:48:06.937609 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:48:06.937773 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:48:06.937934 [debug] [Thread-20 ]: On model.jaffle_shop.top_category: BEGIN
[0m20:48:06.938083 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:48:06.938226 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: BEGIN
[0m20:48:06.938370 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: BEGIN
[0m20:48:06.938513 [debug] [Thread-20 ]: Opening a new connection, currently in state init
[0m20:48:06.938663 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: BEGIN
[0m20:48:06.938798 [debug] [Thread-18 ]: Opening a new connection, currently in state init
[0m20:48:06.938936 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m20:48:06.941075 [debug] [Thread-22 ]: Opening a new connection, currently in state init
[0m20:48:06.941254 [debug] [Thread-20 ]: SQL status: OK in 0.003 seconds
[0m20:48:06.941432 [debug] [Thread-18 ]: SQL status: OK in 0.003 seconds
[0m20:48:06.941605 [debug] [Thread-17 ]: SQL status: OK in 0.003 seconds
[0m20:48:06.941759 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:48:06.941893 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.942036 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:48:06.942183 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:48:06.942362 [debug] [Thread-20 ]: On model.jaffle_shop.top_category: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

top_category AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank
    FROM category_sales AS cs
)

SELECT * FROM top_category
    );
  
  
[0m20:48:06.942536 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:48:06.942715 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */

  
    
    

    create  table
      "jaffle_shop"."main"."customer_LTV__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_revenue AS (
    SELECT
        fs.customer_id,
        SUM(fs.line_total) AS total_revenue,
        MIN(fs.order_date) AS first_purchase_date,
        MAX(fs.order_date) AS last_purchase_date,
        COUNT(DISTINCT fs.order_id) AS total_orders
    FROM fact_sales AS fs
    GROUP BY fs.customer_id
),

customer_ltv AS (
    SELECT
        cr.customer_id,
        dc.first_name,
        dc.last_name,
        cr.total_revenue,
        cr.total_orders,
        DATE_PART('day', cr.last_purchase_date - cr.first_purchase_date) AS customer_lifespan_days,
        ROUND(cr.total_revenue / NULLIF(cr.total_orders, 0), 2) AS avg_order_value,
        ROUND(cr.total_revenue / NULLIF(DATE_PART('day', CURRENT_DATE - cr.first_purchase_date) / 30, 0), 2) AS monthly_ltv
    FROM customer_revenue AS cr
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cr.customer_id = dc.customer_id
)

SELECT * FROM customer_ltv
ORDER BY total_revenue DESC
    );
  
  
[0m20:48:06.942934 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */

  
    
    

    create  table
      "jaffle_shop"."main"."avg_order_value__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_order_totals AS (
    SELECT
        customer_id,
        COUNT(DISTINCT order_id) AS total_orders,
        SUM(line_total) AS total_spent
    FROM fact_sales
    GROUP BY customer_id
    HAVING COUNT(DISTINCT order_id) > 3
),

average_order_value AS (
    SELECT
        cot.customer_id,
        dc.first_name,
        dc.last_name,
        cot.total_orders,
        cot.total_spent,
        ROUND(cot.total_spent / cot.total_orders, 1) AS avg_order_value
    FROM customer_order_totals AS cot
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cot.customer_id = dc.customer_id
)

SELECT * FROM average_order_value
ORDER BY avg_order_value DESC
    );
  
  
[0m20:48:06.943175 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */

  
    
    

    create  table
      "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

monthly_sales AS (
    SELECT
        DATE_TRUNC('month', order_date) AS sales_month,
        SUM(line_total) AS total_revenue,
        SUM(quantity) AS total_quantity_sold
    FROM "jaffle_shop"."main"."fact_sales"
    GROUP BY sales_month
),

sales_growth AS (
    SELECT
        ms.sales_month,
        ms.total_revenue,
        ms.total_quantity_sold,
        LAG(ms.total_revenue) OVER (ORDER BY ms.sales_month) AS previous_revenue,
        LAG(ms.total_quantity_sold) OVER (ORDER BY ms.sales_month) AS previous_quantity
    FROM monthly_sales AS ms
),

growth_calculations AS (
    SELECT
        sg.sales_month,
        sg.total_revenue,
        sg.total_quantity_sold,
        ROUND(((sg.total_revenue - sg.previous_revenue) / sg.previous_revenue) * 100, 2) AS revenue_growth_percentage,
        ROUND(((sg.total_quantity_sold - sg.previous_quantity) / sg.previous_quantity) * 100, 2) AS quantity_growth_percentage
    FROM sales_growth AS sg
    WHERE sg.previous_revenue IS NOT NULL
)

SELECT * FROM growth_calculations
ORDER BY sales_month ASC
    );
  
  
[0m20:48:06.945291 [debug] [Thread-20 ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

top_category AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank
    FROM category_sales AS cs
)

SELECT * FROM top_category
    );
  
  
[0m20:48:06.945489 [debug] [Thread-20 ]: DuckDB adapter: Rolling back transaction.
[0m20:48:06.945733 [debug] [Thread-20 ]: On model.jaffle_shop.top_category: ROLLBACK
[0m20:48:06.946791 [debug] [Thread-17 ]: SQL status: OK in 0.003 seconds
[0m20:48:06.946959 [debug] [Thread-22 ]: SQL status: OK in 0.004 seconds
[0m20:48:06.948429 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:48:06.948719 [debug] [Thread-18 ]: SQL status: OK in 0.005 seconds
[0m20:48:06.950459 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:48:06.950657 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value" rename to "avg_order_value__dbt_backup"
[0m20:48:06.951782 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:48:06.951944 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth" rename to "monthly_sales_growth__dbt_backup"
[0m20:48:06.952126 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV" rename to "customer_LTV__dbt_backup"
[0m20:48:06.952334 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.952559 [debug] [Thread-22 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.953706 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:48:06.953841 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.955006 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:48:06.955197 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value__dbt_tmp" rename to "avg_order_value"
[0m20:48:06.956379 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:48:06.956543 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp" rename to "monthly_sales_growth"
[0m20:48:06.956755 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV__dbt_tmp" rename to "customer_LTV"
[0m20:48:06.956916 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.957146 [debug] [Thread-22 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.957702 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:48:06.957833 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.958533 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:48:06.958723 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:48:06.959290 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:48:06.959456 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:48:06.959605 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:48:06.959802 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:48:06.959958 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:48:06.960176 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:48:06.960333 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m20:48:06.961466 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:48:06.961619 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
drop table if exists "jaffle_shop"."main"."avg_order_value__dbt_backup" cascade
[0m20:48:06.961790 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.961926 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.962894 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:48:06.963039 [debug] [Thread-17 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.964492 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:48:06.964658 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
drop table if exists "jaffle_shop"."main"."customer_LTV__dbt_backup" cascade
[0m20:48:06.987472 [debug] [Thread-20 ]: Failed to rollback 'model.jaffle_shop.top_category'
[0m20:48:06.988013 [debug] [Thread-17 ]: On model.jaffle_shop.avg_order_value: Close
[0m20:48:06.988174 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
drop table if exists "jaffle_shop"."main"."monthly_sales_growth__dbt_backup" cascade
[0m20:48:06.988384 [debug] [Thread-20 ]: On model.jaffle_shop.top_category: Close
[0m20:48:06.988626 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcf2b0>]}
[0m20:48:06.989036 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.989517 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m20:48:06.989374 [info ] [Thread-17 ]: 13 of 16 OK created sql table model main.avg_order_value ....................... [[32mOK[0m in 0.07s]
[0m20:48:06.990070 [debug] [Thread-18 ]: On model.jaffle_shop.customer_LTV: Close
[0m20:48:06.990551 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: Close
[0m20:48:06.990834 [debug] [Thread-17 ]: Finished running node model.jaffle_shop.avg_order_value
[0m20:48:06.991202 [debug] [Thread-20 ]: Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
          od.order_id,
          o.order_date,
          od.product_id,
          od.quantity,
          od.unit_price,
          od.line_total,
          o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:48:06.991442 [debug] [Thread-18 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcbf10>]}
[0m20:48:06.994062 [debug] [Thread-22 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106818400>]}
[0m20:48:06.994317 [debug] [Thread-20 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b612d4-8d90-480b-8b89-6df77a1086c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048809a0>]}
[0m20:48:06.994588 [info ] [Thread-18 ]: 14 of 16 OK created sql table model main.customer_LTV .......................... [[32mOK[0m in 0.07s]
[0m20:48:06.994858 [info ] [Thread-22 ]: 16 of 16 OK created sql table model main.monthly_sales_growth .................. [[32mOK[0m in 0.07s]
[0m20:48:06.995118 [error] [Thread-20 ]: 15 of 16 ERROR creating sql table model main.top_category ...................... [[31mERROR[0m in 0.07s]
[0m20:48:06.995371 [debug] [Thread-18 ]: Finished running node model.jaffle_shop.customer_LTV
[0m20:48:06.995598 [debug] [Thread-22 ]: Finished running node model.jaffle_shop.monthly_sales_growth
[0m20:48:06.995854 [debug] [Thread-20 ]: Finished running node model.jaffle_shop.top_category
[0m20:48:06.996650 [debug] [MainThread]: Using duckdb connection "master"
[0m20:48:06.996785 [debug] [MainThread]: On master: BEGIN
[0m20:48:06.996900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:06.999178 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:48:06.999318 [debug] [MainThread]: On master: COMMIT
[0m20:48:06.999437 [debug] [MainThread]: Using duckdb connection "master"
[0m20:48:06.999540 [debug] [MainThread]: On master: COMMIT
[0m20:48:06.999667 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:48:06.999787 [debug] [MainThread]: On master: Close
[0m20:48:07.000225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:07.000365 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:48:07.000483 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m20:48:07.000592 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:48:07.000686 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:48:07.000787 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:48:07.000889 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m20:48:07.000994 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:48:07.001097 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:48:07.001194 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m20:48:07.001300 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_products' was properly closed.
[0m20:48:07.001403 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_sales' was properly closed.
[0m20:48:07.001504 [debug] [MainThread]: Connection 'model.jaffle_shop.low_stock' was properly closed.
[0m20:48:07.001600 [debug] [MainThread]: Connection 'model.jaffle_shop.avg_order_value' was properly closed.
[0m20:48:07.001691 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_LTV' was properly closed.
[0m20:48:07.001780 [debug] [MainThread]: Connection 'model.jaffle_shop.top_category' was properly closed.
[0m20:48:07.001871 [debug] [MainThread]: Connection 'model.jaffle_shop.monthly_sales_growth' was properly closed.
[0m20:48:07.002045 [info ] [MainThread]: 
[0m20:48:07.002191 [info ] [MainThread]: Finished running 8 view models, 8 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m20:48:07.003228 [debug] [MainThread]: Command end result
[0m20:48:07.021053 [info ] [MainThread]: 
[0m20:48:07.021259 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:48:07.021380 [info ] [MainThread]: 
[0m20:48:07.021548 [error] [MainThread]:   Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
          od.order_id,
          o.order_date,
          od.product_id,
          od.quantity,
          od.unit_price,
          od.line_total,
          o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:48:07.021744 [info ] [MainThread]: 
[0m20:48:07.021891 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m20:48:07.023407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8096467, "process_user_time": 1.157027, "process_kernel_time": 0.137118, "process_mem_max_rss": "167542784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:48:07.023628 [debug] [MainThread]: Command `dbt run` failed at 20:48:07.023589 after 0.81 seconds
[0m20:48:07.023794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102336950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104836c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104834d00>]}
[0m20:48:07.023949 [debug] [MainThread]: Flushing usage events
[0m20:49:37.355431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070228f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111277f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111277850>]}


============================== 20:49:37.358640 | 8552db14-19c3-4096-96b7-be63ce986504 ==============================
[0m20:49:37.358640 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:49:37.358908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:49:37.480947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113832e0>]}
[0m20:49:37.501653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113442e0>]}
[0m20:49:37.502794 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:49:37.510721 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:49:37.583835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:49:37.584046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:49:37.608489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121060b0>]}
[0m20:49:37.662529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112111390>]}
[0m20:49:37.662770 [info ] [MainThread]: Found 8 seeds, 16 models, 5 data tests, 423 macros
[0m20:49:37.662924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121113c0>]}
[0m20:49:37.663771 [info ] [MainThread]: 
[0m20:49:37.663999 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:49:37.666472 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:49:37.690261 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:49:37.690467 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:49:37.690600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:37.699760 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:49:37.700361 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:49:37.701431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:49:37.701632 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:49:37.704492 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:49:37.704632 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:49:37.704743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:37.706902 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:37.707395 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:49:37.707510 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:49:37.707642 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:49:37.707757 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:49:37.707877 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:49:37.708070 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:49:37.708388 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:49:37.708503 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:49:37.708606 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:49:37.708730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:49:37.708849 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:49:37.710208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:49:37.712464 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:49:37.712590 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:49:37.712694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:37.714528 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:49:37.714648 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:49:37.714763 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:49:37.723918 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:49:37.726133 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:49:37.726625 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:49:37.726743 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:49:37.728525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112116920>]}
[0m20:49:37.728732 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:37.728853 [debug] [MainThread]: On master: BEGIN
[0m20:49:37.728956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:37.730759 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:37.730890 [debug] [MainThread]: On master: COMMIT
[0m20:49:37.731007 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:37.731117 [debug] [MainThread]: On master: COMMIT
[0m20:49:37.731242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:49:37.731356 [debug] [MainThread]: On master: Close
[0m20:49:37.731805 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:49:37.731960 [info ] [MainThread]: 
[0m20:49:37.733619 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:49:37.733801 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:49:37.733976 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:49:37.734147 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:49:37.734289 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:49:37.734631 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:49:37.734499 [info ] [Thread-1 (]: 1 of 16 START sql view model main.stg_customers ................................ [RUN]
[0m20:49:37.734806 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:49:37.734973 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:49:37.735165 [info ] [Thread-2 (]: 2 of 16 START sql view model main.stg_inventory ................................ [RUN]
[0m20:49:37.735392 [info ] [Thread-3 (]: 3 of 16 START sql view model main.stg_inventory_transactions ................... [RUN]
[0m20:49:37.735616 [info ] [Thread-4 (]: 4 of 16 START sql view model main.stg_order_details ............................ [RUN]
[0m20:49:37.735826 [info ] [Thread-5 (]: 5 of 16 START sql view model main.stg_orders ................................... [RUN]
[0m20:49:37.736032 [info ] [Thread-6 (]: 6 of 16 START sql view model main.stg_products ................................. [RUN]
[0m20:49:37.736226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:49:37.736425 [info ] [Thread-7 (]: 7 of 16 START sql view model main.stg_supplier_products ........................ [RUN]
[0m20:49:37.736633 [info ] [Thread-8 (]: 8 of 16 START sql view model main.stg_suppliers ................................ [RUN]
[0m20:49:37.736857 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:49:37.737057 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:49:37.737261 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:49:37.737429 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:49:37.737593 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:49:37.737739 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:49:37.737932 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:49:37.738118 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:49:37.738265 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:49:37.738418 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:49:37.738569 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:49:37.738707 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:49:37.738831 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:49:37.743976 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:49:37.744150 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:49:37.744307 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:49:37.745377 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:49:37.746409 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:49:37.747389 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:49:37.748869 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:49:37.750277 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:49:37.751483 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:49:37.752504 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:49:37.752718 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:49:37.752941 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:49:37.753315 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:49:37.753485 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:49:37.753616 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:49:37.753818 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:49:37.753988 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:49:37.767724 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:49:37.767908 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:49:37.769447 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:49:37.770903 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:49:37.772269 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:49:37.773670 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:49:37.793342 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:49:37.794912 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:49:37.796451 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:49:37.796907 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:49:37.797052 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:49:37.797283 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:49:37.797453 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:49:37.797652 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:49:37.797832 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:49:37.798021 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:49:37.798188 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:49:37.798376 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:49:37.798529 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:49:37.798683 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:49:37.798846 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:49:37.799001 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:49:37.799162 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:49:37.799314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:37.799460 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:49:37.799604 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:49:37.799749 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:49:37.799895 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:49:37.800036 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:49:37.800183 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:49:37.800332 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:49:37.802544 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:49:37.802701 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.802908 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:49:37.803052 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.803261 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.803471 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.803604 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.803784 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.803936 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:49:37.804068 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m20:49:37.804248 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:49:37.804386 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.804533 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:49:37.804682 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:49:37.804832 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:49:37.804977 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:49:37.805137 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(first_name), 1, 1)), LOWER(SUBSTRING(TRIM(first_name), 2)))
 AS first_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(last_name), 1, 1)), LOWER(SUBSTRING(TRIM(last_name), 2)))
 AS last_name,
  LOWER(TRIM(email)) AS email,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:49:37.805291 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:49:37.805446 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:49:37.805605 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:49:37.805770 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:49:37.805945 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:49:37.806114 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:49:37.806289 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  
  TRY_CAST(product_id AS INTEGER)
 AS product_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))
 AS product_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))
 AS category,
  
  TRY_CAST(price AS DECIMAL(10,2))
 AS price,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:49:37.806486 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:49:37.806675 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:49:37.806841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.806995 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.807369 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.807520 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.807680 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.810391 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:49:37.810539 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.810686 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.810826 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m20:49:37.812040 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:49:37.813254 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:49:37.814398 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:49:37.815868 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:49:37.816013 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:49:37.817140 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:49:37.818369 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:49:37.819516 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:49:37.819679 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:49:37.819831 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions" rename to "stg_inventory_transactions__dbt_backup"
[0m20:49:37.819978 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:49:37.820123 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:49:37.820302 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m20:49:37.820482 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:49:37.820643 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m20:49:37.820767 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.821038 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.821166 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.821289 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.821494 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.822672 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:49:37.822821 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.824009 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:49:37.824135 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m20:49:37.824249 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.825307 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:49:37.826668 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:49:37.827701 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:49:37.827841 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:49:37.828877 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:49:37.829039 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m20:49:37.830156 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:49:37.831169 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:49:37.831309 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:49:37.831447 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:49:37.831581 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:49:37.831752 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:49:37.831915 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.832077 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:49:37.832228 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:49:37.832350 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.832583 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.832740 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.832880 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.839513 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:49:37.839645 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:49:37.840217 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:49:37.840350 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.840491 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.840938 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:49:37.841459 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:49:37.841896 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:49:37.842034 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:49:37.842465 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:49:37.842602 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:49:37.843025 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:49:37.843456 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:49:37.843590 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:49:37.843719 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:49:37.843846 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:49:37.843972 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:49:37.844102 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:49:37.844232 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:49:37.844359 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:49:37.844490 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:49:37.844614 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:49:37.844737 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:49:37.844860 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:49:37.845050 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:49:37.845239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.845389 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:49:37.845547 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.845686 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:49:37.847935 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:49:37.848075 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m20:49:37.848199 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m20:49:37.848322 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:49:37.848469 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.849939 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:49:37.850074 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.850249 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m20:49:37.850395 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.851303 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:49:37.852308 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:49:37.853216 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:49:37.854153 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:49:37.854320 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m20:49:37.855260 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:49:37.856225 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:49:37.856385 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:49:37.856559 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
drop view if exists "jaffle_shop"."main"."stg_products__dbt_backup" cascade
[0m20:49:37.856705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.856853 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:49:37.857018 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:49:37.857202 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m20:49:37.857367 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:49:37.857553 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.858544 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:49:37.858742 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.858884 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.859089 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.859646 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:49:37.860281 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.860419 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.860679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270b460>]}
[0m20:49:37.860841 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:49:37.861321 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:49:37.861791 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:49:37.862255 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:49:37.862442 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270b640>]}
[0m20:49:37.862913 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:49:37.863400 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:49:37.863668 [info ] [Thread-1 (]: 1 of 16 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.12s]
[0m20:49:37.864202 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:49:37.864391 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270bb50>]}
[0m20:49:37.864587 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270a830>]}
[0m20:49:37.864810 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270ba30>]}
[0m20:49:37.865066 [info ] [Thread-3 (]: 3 of 16 OK created sql view model main.stg_inventory_transactions .............. [[32mOK[0m in 0.13s]
[0m20:49:37.865283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270bac0>]}
[0m20:49:37.865482 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270be20>]}
[0m20:49:37.865724 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:49:37.868134 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270bd90>]}
[0m20:49:37.868402 [info ] [Thread-5 (]: 5 of 16 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.13s]
[0m20:49:37.868652 [info ] [Thread-6 (]: 6 of 16 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.13s]
[0m20:49:37.868931 [info ] [Thread-4 (]: 4 of 16 OK created sql view model main.stg_order_details ....................... [[32mOK[0m in 0.13s]
[0m20:49:37.869179 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:49:37.869407 [info ] [Thread-2 (]: 2 of 16 OK created sql view model main.stg_inventory ........................... [[32mOK[0m in 0.13s]
[0m20:49:37.869657 [info ] [Thread-7 (]: 7 of 16 OK created sql view model main.stg_supplier_products ................... [[32mOK[0m in 0.13s]
[0m20:49:37.869955 [debug] [Thread-10 ]: Began running node model.jaffle_shop.dim_customers
[0m20:49:37.870114 [debug] [Thread-11 ]: Began running node model.jaffle_shop.dim_products
[0m20:49:37.870345 [info ] [Thread-8 (]: 8 of 16 OK created sql view model main.stg_suppliers ........................... [[32mOK[0m in 0.13s]
[0m20:49:37.870590 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:49:37.870811 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:49:37.871017 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:49:37.871279 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:49:37.871502 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:49:37.871706 [info ] [Thread-10 ]: 9 of 16 START sql table model main.dim_customers ............................... [RUN]
[0m20:49:37.871926 [info ] [Thread-11 ]: 10 of 16 START sql table model main.dim_products ............................... [RUN]
[0m20:49:37.872167 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:49:37.872506 [debug] [Thread-2 (]: Began running node model.jaffle_shop.fact_sales
[0m20:49:37.872705 [debug] [Thread-14 ]: Began running node model.jaffle_shop.low_stock
[0m20:49:37.872949 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m20:49:37.873157 [debug] [Thread-11 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_products'
[0m20:49:37.873411 [info ] [Thread-2 (]: 11 of 16 START sql table model main.fact_sales ................................. [RUN]
[0m20:49:37.873621 [info ] [Thread-14 ]: 12 of 16 START sql table model main.low_stock .................................. [RUN]
[0m20:49:37.873790 [debug] [Thread-10 ]: Began compiling node model.jaffle_shop.dim_customers
[0m20:49:37.873943 [debug] [Thread-11 ]: Began compiling node model.jaffle_shop.dim_products
[0m20:49:37.874112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_inventory, now model.jaffle_shop.fact_sales)
[0m20:49:37.874313 [debug] [Thread-14 ]: Acquiring new duckdb connection 'model.jaffle_shop.low_stock'
[0m20:49:37.875588 [debug] [Thread-10 ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:49:37.877292 [debug] [Thread-11 ]: Writing injected SQL for node "model.jaffle_shop.dim_products"
[0m20:49:37.877444 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.fact_sales
[0m20:49:37.877596 [debug] [Thread-14 ]: Began compiling node model.jaffle_shop.low_stock
[0m20:49:37.878871 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.fact_sales"
[0m20:49:37.880139 [debug] [Thread-14 ]: Writing injected SQL for node "model.jaffle_shop.low_stock"
[0m20:49:37.880341 [debug] [Thread-10 ]: Began executing node model.jaffle_shop.dim_customers
[0m20:49:37.880528 [debug] [Thread-11 ]: Began executing node model.jaffle_shop.dim_products
[0m20:49:37.889188 [debug] [Thread-10 ]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m20:49:37.889442 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.fact_sales
[0m20:49:37.891012 [debug] [Thread-11 ]: Writing runtime sql for node "model.jaffle_shop.dim_products"
[0m20:49:37.891143 [debug] [Thread-14 ]: Began executing node model.jaffle_shop.low_stock
[0m20:49:37.892604 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.fact_sales"
[0m20:49:37.894520 [debug] [Thread-14 ]: Writing runtime sql for node "model.jaffle_shop.low_stock"
[0m20:49:37.894691 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:49:37.894908 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:49:37.895089 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: BEGIN
[0m20:49:37.895237 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: BEGIN
[0m20:49:37.895396 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m20:49:37.895561 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:49:37.895777 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:49:37.895927 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m20:49:37.898152 [debug] [Thread-2 (]: On model.jaffle_shop.fact_sales: BEGIN
[0m20:49:37.898302 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m20:49:37.898451 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: BEGIN
[0m20:49:37.898632 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:49:37.898781 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:49:37.898912 [debug] [Thread-11 ]: SQL status: OK in 0.003 seconds
[0m20:49:37.899051 [debug] [Thread-14 ]: Opening a new connection, currently in state init
[0m20:49:37.899252 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:49:37.899400 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.899555 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:49:37.899762 [debug] [Thread-14 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.899903 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:49:37.900059 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_products__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:49:37.900215 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:49:37.900372 [debug] [Thread-2 (]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fact_sales__dbt_tmp"
  
    as (
      SELECT
  od.order_id,
  o.order_date,
  od.product_id,
  od.quantity,
  od.unit_price,
  od.line_total,
  o.customer_id
FROM "jaffle_shop"."main"."stg_order_details" AS od
JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
    );
  
  
[0m20:49:37.900613 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */

  
    
    

    create  table
      "jaffle_shop"."main"."low_stock__dbt_tmp"
  
    as (
      WITH dim_products AS (
    SELECT
      product_id,
      product_name,
      category,
      price,
      created_at AS product_created_date
    FROM "jaffle_shop"."main"."stg_products"
),

inventory_status AS (
    SELECT
      i.product_id,
      p.product_name,
      i.quantity,
      i.last_updated
    FROM "jaffle_shop"."main"."stg_inventory" AS i
    JOIN "jaffle_shop"."main"."stg_products" AS p ON i.product_id = p.product_id
),

current_inventory AS (
    SELECT
        i.product_id,
        p.product_name,
        p.category,
        i.quantity,
        i.last_updated
    FROM inventory_status AS i
    JOIN dim_products AS p ON i.product_id = p.product_id
),

low_stock_products AS (
    SELECT
        ci.product_id,
        ci.product_name,
        ci.category,
        ci.quantity,
        ci.last_updated
    FROM current_inventory AS ci
    WHERE ci.quantity < 20
)

SELECT * FROM low_stock_products
ORDER BY quantity ASC
    );
  
  
[0m20:49:37.901758 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m20:49:37.901932 [debug] [Thread-11 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.903251 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:49:37.903444 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:49:37.904729 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:49:37.904937 [debug] [Thread-14 ]: SQL status: OK in 0.004 seconds
[0m20:49:37.905076 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m20:49:37.906268 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:49:37.906420 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m20:49:37.907522 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:49:37.907697 [debug] [Thread-2 (]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m20:49:37.907883 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock" rename to "low_stock__dbt_backup"
[0m20:49:37.908014 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.908212 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.908357 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.909474 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:49:37.909596 [debug] [Thread-14 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.910723 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:49:37.912282 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:49:37.912426 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:49:37.913489 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:49:37.913636 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m20:49:37.913792 [debug] [Thread-2 (]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m20:49:37.913971 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock__dbt_tmp" rename to "low_stock"
[0m20:49:37.914126 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.914316 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.916227 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:49:37.916358 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:49:37.916938 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: COMMIT
[0m20:49:37.917067 [debug] [Thread-14 ]: SQL status: OK in 0.003 seconds
[0m20:49:37.917213 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:49:37.917734 [debug] [Thread-2 (]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:49:37.917871 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:49:37.918365 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: COMMIT
[0m20:49:37.918506 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:49:37.918652 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:49:37.918795 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: COMMIT
[0m20:49:37.918940 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:49:37.919111 [debug] [Thread-2 (]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:49:37.919306 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: COMMIT
[0m20:49:37.919562 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.919700 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.919835 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:49:37.920898 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:49:37.921017 [debug] [Thread-14 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.921943 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:49:37.922895 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:49:37.923038 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m20:49:37.923967 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:49:37.924125 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
drop table if exists "jaffle_shop"."main"."dim_products__dbt_backup" cascade
[0m20:49:37.924267 [debug] [Thread-2 (]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
drop table if exists "jaffle_shop"."main"."fact_sales__dbt_backup" cascade
[0m20:49:37.924445 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
drop table if exists "jaffle_shop"."main"."low_stock__dbt_backup" cascade
[0m20:49:37.924658 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.925178 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: Close
[0m20:49:37.925320 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:49:37.925550 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112104c10>]}
[0m20:49:37.925707 [debug] [Thread-11 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.925863 [debug] [Thread-14 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.926324 [debug] [Thread-2 (]: On model.jaffle_shop.fact_sales: Close
[0m20:49:37.926587 [info ] [Thread-10 ]: 9 of 16 OK created sql table model main.dim_customers .......................... [[32mOK[0m in 0.05s]
[0m20:49:37.927145 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: Close
[0m20:49:37.927611 [debug] [Thread-14 ]: On model.jaffle_shop.low_stock: Close
[0m20:49:37.927803 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f8850>]}
[0m20:49:37.928026 [debug] [Thread-10 ]: Finished running node model.jaffle_shop.dim_customers
[0m20:49:37.928206 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112709f30>]}
[0m20:49:37.932421 [debug] [Thread-14 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270a590>]}
[0m20:49:37.932676 [info ] [Thread-2 (]: 11 of 16 OK created sql table model main.fact_sales ............................ [[32mOK[0m in 0.05s]
[0m20:49:37.932997 [debug] [Thread-16 ]: Began running node model.jaffle_shop.avg_order_value
[0m20:49:37.933171 [debug] [Thread-17 ]: Began running node model.jaffle_shop.customer_LTV
[0m20:49:37.933411 [info ] [Thread-11 ]: 10 of 16 OK created sql table model main.dim_products .......................... [[32mOK[0m in 0.06s]
[0m20:49:37.933687 [info ] [Thread-14 ]: 12 of 16 OK created sql table model main.low_stock ............................. [[32mOK[0m in 0.06s]
[0m20:49:37.933936 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.fact_sales
[0m20:49:37.934139 [info ] [Thread-16 ]: 13 of 16 START sql table model main.avg_order_value ............................ [RUN]
[0m20:49:37.934362 [info ] [Thread-17 ]: 14 of 16 START sql table model main.customer_LTV ............................... [RUN]
[0m20:49:37.934611 [debug] [Thread-11 ]: Finished running node model.jaffle_shop.dim_products
[0m20:49:37.934824 [debug] [Thread-14 ]: Finished running node model.jaffle_shop.low_stock
[0m20:49:37.935106 [debug] [Thread-16 ]: Acquiring new duckdb connection 'model.jaffle_shop.avg_order_value'
[0m20:49:37.935273 [debug] [Thread-19 ]: Began running node model.jaffle_shop.monthly_sales_growth
[0m20:49:37.935476 [debug] [Thread-17 ]: Acquiring new duckdb connection 'model.jaffle_shop.customer_LTV'
[0m20:49:37.935713 [debug] [Thread-21 ]: Began running node model.jaffle_shop.top_category
[0m20:49:37.935913 [debug] [Thread-16 ]: Began compiling node model.jaffle_shop.avg_order_value
[0m20:49:37.936108 [info ] [Thread-19 ]: 15 of 16 START sql table model main.monthly_sales_growth ....................... [RUN]
[0m20:49:37.936277 [debug] [Thread-17 ]: Began compiling node model.jaffle_shop.customer_LTV
[0m20:49:37.936469 [info ] [Thread-21 ]: 16 of 16 START sql table model main.top_category ............................... [RUN]
[0m20:49:37.937953 [debug] [Thread-16 ]: Writing injected SQL for node "model.jaffle_shop.avg_order_value"
[0m20:49:37.938154 [debug] [Thread-19 ]: Acquiring new duckdb connection 'model.jaffle_shop.monthly_sales_growth'
[0m20:49:37.940318 [debug] [Thread-17 ]: Writing injected SQL for node "model.jaffle_shop.customer_LTV"
[0m20:49:37.940526 [debug] [Thread-21 ]: Acquiring new duckdb connection 'model.jaffle_shop.top_category'
[0m20:49:37.940717 [debug] [Thread-19 ]: Began compiling node model.jaffle_shop.monthly_sales_growth
[0m20:49:37.940923 [debug] [Thread-21 ]: Began compiling node model.jaffle_shop.top_category
[0m20:49:37.941066 [debug] [Thread-16 ]: Began executing node model.jaffle_shop.avg_order_value
[0m20:49:37.942456 [debug] [Thread-19 ]: Writing injected SQL for node "model.jaffle_shop.monthly_sales_growth"
[0m20:49:37.943764 [debug] [Thread-21 ]: Writing injected SQL for node "model.jaffle_shop.top_category"
[0m20:49:37.943917 [debug] [Thread-17 ]: Began executing node model.jaffle_shop.customer_LTV
[0m20:49:37.945499 [debug] [Thread-16 ]: Writing runtime sql for node "model.jaffle_shop.avg_order_value"
[0m20:49:37.947204 [debug] [Thread-17 ]: Writing runtime sql for node "model.jaffle_shop.customer_LTV"
[0m20:49:37.947482 [debug] [Thread-19 ]: Began executing node model.jaffle_shop.monthly_sales_growth
[0m20:49:37.947633 [debug] [Thread-21 ]: Began executing node model.jaffle_shop.top_category
[0m20:49:37.949203 [debug] [Thread-19 ]: Writing runtime sql for node "model.jaffle_shop.monthly_sales_growth"
[0m20:49:37.949382 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:49:37.950880 [debug] [Thread-21 ]: Writing runtime sql for node "model.jaffle_shop.top_category"
[0m20:49:37.951027 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:49:37.952570 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: BEGIN
[0m20:49:37.952787 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: BEGIN
[0m20:49:37.952936 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:49:37.953110 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m20:49:37.953261 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m20:49:37.953411 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: BEGIN
[0m20:49:37.953560 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:49:37.955924 [debug] [Thread-16 ]: SQL status: OK in 0.003 seconds
[0m20:49:37.956104 [debug] [Thread-17 ]: SQL status: OK in 0.003 seconds
[0m20:49:37.956247 [debug] [Thread-19 ]: Opening a new connection, currently in state init
[0m20:49:37.956403 [debug] [Thread-21 ]: On model.jaffle_shop.top_category: BEGIN
[0m20:49:37.956556 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:49:37.956704 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:49:37.956884 [debug] [Thread-21 ]: Opening a new connection, currently in state init
[0m20:49:37.957025 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.957218 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */

  
    
    

    create  table
      "jaffle_shop"."main"."avg_order_value__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_order_totals AS (
    SELECT
        customer_id,
        COUNT(DISTINCT order_id) AS total_orders,
        SUM(line_total) AS total_spent
    FROM fact_sales
    GROUP BY customer_id
    HAVING COUNT(DISTINCT order_id) > 3
),

average_order_value AS (
    SELECT
        cot.customer_id,
        dc.first_name,
        dc.last_name,
        cot.total_orders,
        cot.total_spent,
        ROUND(cot.total_spent / cot.total_orders, 1) AS avg_order_value
    FROM customer_order_totals AS cot
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cot.customer_id = dc.customer_id
)

SELECT * FROM average_order_value
ORDER BY avg_order_value DESC
    );
  
  
[0m20:49:37.957454 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */

  
    
    

    create  table
      "jaffle_shop"."main"."customer_LTV__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_revenue AS (
    SELECT
        fs.customer_id,
        SUM(fs.line_total) AS total_revenue,
        MIN(fs.order_date) AS first_purchase_date,
        MAX(fs.order_date) AS last_purchase_date,
        COUNT(DISTINCT fs.order_id) AS total_orders
    FROM fact_sales AS fs
    GROUP BY fs.customer_id
),

customer_ltv AS (
    SELECT
        cr.customer_id,
        dc.first_name,
        dc.last_name,
        cr.total_revenue,
        cr.total_orders,
        DATE_PART('day', cr.last_purchase_date - cr.first_purchase_date) AS customer_lifespan_days,
        ROUND(cr.total_revenue / NULLIF(cr.total_orders, 0), 2) AS avg_order_value,
        ROUND(cr.total_revenue / NULLIF(DATE_PART('day', CURRENT_DATE - cr.first_purchase_date) / 30, 0), 2) AS monthly_ltv
    FROM customer_revenue AS cr
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cr.customer_id = dc.customer_id
)

SELECT * FROM customer_ltv
ORDER BY total_revenue DESC
    );
  
  
[0m20:49:37.957694 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:49:37.957840 [debug] [Thread-21 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.958248 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */

  
    
    

    create  table
      "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

monthly_sales AS (
    SELECT
        DATE_TRUNC('month', order_date) AS sales_month,
        SUM(line_total) AS total_revenue,
        SUM(quantity) AS total_quantity_sold
    FROM "jaffle_shop"."main"."fact_sales"
    GROUP BY sales_month
),

sales_growth AS (
    SELECT
        ms.sales_month,
        ms.total_revenue,
        ms.total_quantity_sold,
        LAG(ms.total_revenue) OVER (ORDER BY ms.sales_month) AS previous_revenue,
        LAG(ms.total_quantity_sold) OVER (ORDER BY ms.sales_month) AS previous_quantity
    FROM monthly_sales AS ms
),

growth_calculations AS (
    SELECT
        sg.sales_month,
        sg.total_revenue,
        sg.total_quantity_sold,
        ROUND(((sg.total_revenue - sg.previous_revenue) / sg.previous_revenue) * 100, 2) AS revenue_growth_percentage,
        ROUND(((sg.total_quantity_sold - sg.previous_quantity) / sg.previous_quantity) * 100, 2) AS quantity_growth_percentage
    FROM sales_growth AS sg
    WHERE sg.previous_revenue IS NOT NULL
)

SELECT * FROM growth_calculations
ORDER BY sales_month ASC
    );
  
  
[0m20:49:37.958478 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:49:37.959513 [debug] [Thread-21 ]: On model.jaffle_shop.top_category: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

top_category AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank
    FROM category_sales AS cs
)

SELECT * FROM top_category
    );
  
  
[0m20:49:37.961697 [debug] [Thread-16 ]: SQL status: OK in 0.004 seconds
[0m20:49:37.963652 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:49:37.963947 [debug] [Thread-21 ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

top_category AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank
    FROM category_sales AS cs
)

SELECT * FROM top_category
    );
  
  
[0m20:49:37.964148 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value" rename to "avg_order_value__dbt_backup"
[0m20:49:37.964334 [debug] [Thread-19 ]: SQL status: OK in 0.005 seconds
[0m20:49:37.964624 [debug] [Thread-17 ]: SQL status: OK in 0.006 seconds
[0m20:49:37.964792 [debug] [Thread-21 ]: DuckDB adapter: Rolling back transaction.
[0m20:49:37.966038 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:49:37.967210 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:49:37.967355 [debug] [Thread-16 ]: SQL status: OK in 0.002 seconds
[0m20:49:37.967559 [debug] [Thread-21 ]: On model.jaffle_shop.top_category: ROLLBACK
[0m20:49:37.967718 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth" rename to "monthly_sales_growth__dbt_backup"
[0m20:49:37.967866 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV" rename to "customer_LTV__dbt_backup"
[0m20:49:37.969018 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:49:37.969345 [debug] [Thread-19 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.969501 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value__dbt_tmp" rename to "avg_order_value"
[0m20:49:37.969692 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.970856 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:49:37.972130 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:49:37.972280 [debug] [Thread-16 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.972443 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp" rename to "monthly_sales_growth"
[0m20:49:37.972610 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV__dbt_tmp" rename to "customer_LTV"
[0m20:49:37.973173 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:49:37.973429 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:49:37.973574 [debug] [Thread-19 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.973726 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.973885 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:49:37.974526 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:49:37.975102 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:49:37.975312 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:49:37.975495 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:49:37.975641 [debug] [Thread-16 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.975832 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:49:37.976201 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:49:37.977265 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:49:37.977576 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
drop table if exists "jaffle_shop"."main"."avg_order_value__dbt_backup" cascade
[0m20:49:37.977799 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.977946 [debug] [Thread-19 ]: SQL status: OK in 0.000 seconds
[0m20:49:37.979541 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:49:37.979733 [debug] [Thread-16 ]: SQL status: OK in 0.002 seconds
[0m20:49:37.980652 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:49:37.980828 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
drop table if exists "jaffle_shop"."main"."customer_LTV__dbt_backup" cascade
[0m20:49:37.981396 [debug] [Thread-16 ]: On model.jaffle_shop.avg_order_value: Close
[0m20:49:37.981559 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
drop table if exists "jaffle_shop"."main"."monthly_sales_growth__dbt_backup" cascade
[0m20:49:37.981850 [debug] [Thread-16 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a717b0>]}
[0m20:49:37.982375 [debug] [Thread-17 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.982248 [info ] [Thread-16 ]: 13 of 16 OK created sql table model main.avg_order_value ....................... [[32mOK[0m in 0.05s]
[0m20:49:37.982819 [debug] [Thread-21 ]: Failed to rollback 'model.jaffle_shop.top_category'
[0m20:49:37.982960 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m20:49:37.983423 [debug] [Thread-17 ]: On model.jaffle_shop.customer_LTV: Close
[0m20:49:37.983652 [debug] [Thread-16 ]: Finished running node model.jaffle_shop.avg_order_value
[0m20:49:37.983797 [debug] [Thread-21 ]: On model.jaffle_shop.top_category: Close
[0m20:49:37.984311 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: Close
[0m20:49:37.984506 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aba770>]}
[0m20:49:37.987325 [debug] [Thread-19 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112709e40>]}
[0m20:49:37.987646 [info ] [Thread-17 ]: 14 of 16 OK created sql table model main.customer_LTV .......................... [[32mOK[0m in 0.05s]
[0m20:49:37.988002 [info ] [Thread-19 ]: 15 of 16 OK created sql table model main.monthly_sales_growth .................. [[32mOK[0m in 0.05s]
[0m20:49:37.988250 [debug] [Thread-17 ]: Finished running node model.jaffle_shop.customer_LTV
[0m20:49:37.988672 [debug] [Thread-21 ]: Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
          od.order_id,
          o.order_date,
          od.product_id,
          od.quantity,
          od.unit_price,
          od.line_total,
          o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:49:37.988913 [debug] [Thread-19 ]: Finished running node model.jaffle_shop.monthly_sales_growth
[0m20:49:37.989165 [debug] [Thread-21 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8552db14-19c3-4096-96b7-be63ce986504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b51e40>]}
[0m20:49:37.989467 [error] [Thread-21 ]: 16 of 16 ERROR creating sql table model main.top_category ...................... [[31mERROR[0m in 0.05s]
[0m20:49:37.989736 [debug] [Thread-21 ]: Finished running node model.jaffle_shop.top_category
[0m20:49:37.990514 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:37.990655 [debug] [MainThread]: On master: BEGIN
[0m20:49:37.990776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:37.993097 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:49:37.993231 [debug] [MainThread]: On master: COMMIT
[0m20:49:37.993347 [debug] [MainThread]: Using duckdb connection "master"
[0m20:49:37.993451 [debug] [MainThread]: On master: COMMIT
[0m20:49:37.993576 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:49:37.993699 [debug] [MainThread]: On master: Close
[0m20:49:37.994144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:37.994262 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:49:37.994368 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_sales' was properly closed.
[0m20:49:37.994461 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:49:37.994550 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:49:37.994640 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:49:37.994730 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m20:49:37.994818 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:49:37.994910 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:49:37.994997 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m20:49:37.995086 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_products' was properly closed.
[0m20:49:37.995174 [debug] [MainThread]: Connection 'model.jaffle_shop.low_stock' was properly closed.
[0m20:49:37.995264 [debug] [MainThread]: Connection 'model.jaffle_shop.avg_order_value' was properly closed.
[0m20:49:37.995351 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_LTV' was properly closed.
[0m20:49:37.995440 [debug] [MainThread]: Connection 'model.jaffle_shop.monthly_sales_growth' was properly closed.
[0m20:49:37.995529 [debug] [MainThread]: Connection 'model.jaffle_shop.top_category' was properly closed.
[0m20:49:37.995706 [info ] [MainThread]: 
[0m20:49:37.995836 [info ] [MainThread]: Finished running 8 view models, 8 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m20:49:37.996831 [debug] [MainThread]: Command end result
[0m20:49:38.015508 [info ] [MainThread]: 
[0m20:49:38.015729 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:38.015848 [info ] [MainThread]: 
[0m20:49:38.016020 [error] [MainThread]:   Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
          od.order_id,
          o.order_date,
          od.product_id,
          od.quantity,
          od.unit_price,
          od.line_total,
          o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:49:38.016172 [info ] [MainThread]: 
[0m20:49:38.016294 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m20:49:38.017552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6902993, "process_user_time": 1.025843, "process_kernel_time": 0.130924, "process_mem_max_rss": "162742272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:49:38.017758 [debug] [MainThread]: Command `dbt run` failed at 20:49:38.017724 after 0.69 seconds
[0m20:49:38.017908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070228f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aff5b0>]}
[0m20:49:38.018048 [debug] [MainThread]: Flushing usage events
[0m20:51:29.182597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105026920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3b880>]}


============================== 20:51:29.185678 | 49c41901-553d-49f4-913d-55edebeb76ec ==============================
[0m20:51:29.185678 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:51:29.185922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:29.328462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c082e0>]}
[0m20:51:29.349468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c080a0>]}
[0m20:51:29.349891 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:51:29.357966 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:51:29.428112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:29.428323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:29.452338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070060e0>]}
[0m20:51:29.506002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070313c0>]}
[0m20:51:29.506243 [info ] [MainThread]: Found 8 seeds, 16 models, 5 data tests, 423 macros
[0m20:51:29.506395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070313f0>]}
[0m20:51:29.507280 [info ] [MainThread]: 
[0m20:51:29.507539 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:51:29.510226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m20:51:29.535374 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m20:51:29.535575 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m20:51:29.535705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:29.550792 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:51:29.551892 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m20:51:29.552757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m20:51:29.552975 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m20:51:29.555799 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:51:29.555935 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m20:51:29.556050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.558428 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:51:29.558962 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:51:29.559097 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m20:51:29.559235 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:51:29.559350 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:51:29.559469 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m20:51:29.560355 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:51:29.560677 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:51:29.560801 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m20:51:29.560915 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m20:51:29.561049 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:51:29.561170 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m20:51:29.562604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m20:51:29.564860 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:51:29.564986 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m20:51:29.565090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:29.567005 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:51:29.567137 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m20:51:29.567268 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m20:51:29.578636 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:51:29.581339 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m20:51:29.581829 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m20:51:29.581953 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m20:51:29.583774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d06950>]}
[0m20:51:29.583984 [debug] [MainThread]: Using duckdb connection "master"
[0m20:51:29.584112 [debug] [MainThread]: On master: BEGIN
[0m20:51:29.584222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:29.586152 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:51:29.586287 [debug] [MainThread]: On master: COMMIT
[0m20:51:29.586414 [debug] [MainThread]: Using duckdb connection "master"
[0m20:51:29.586533 [debug] [MainThread]: On master: COMMIT
[0m20:51:29.586666 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:51:29.586786 [debug] [MainThread]: On master: Close
[0m20:51:29.587247 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:51:29.587404 [info ] [MainThread]: 
[0m20:51:29.589113 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:51:29.589297 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m20:51:29.589481 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m20:51:29.589647 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m20:51:29.589798 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m20:51:29.589939 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m20:51:29.590146 [info ] [Thread-1 (]: 1 of 16 START sql view model main.stg_customers ................................ [RUN]
[0m20:51:29.590321 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m20:51:29.590499 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m20:51:29.590701 [info ] [Thread-2 (]: 2 of 16 START sql view model main.stg_inventory ................................ [RUN]
[0m20:51:29.590927 [info ] [Thread-3 (]: 3 of 16 START sql view model main.stg_inventory_transactions ................... [RUN]
[0m20:51:29.591137 [info ] [Thread-4 (]: 4 of 16 START sql view model main.stg_order_details ............................ [RUN]
[0m20:51:29.591344 [info ] [Thread-5 (]: 5 of 16 START sql view model main.stg_orders ................................... [RUN]
[0m20:51:29.591579 [info ] [Thread-6 (]: 6 of 16 START sql view model main.stg_products ................................. [RUN]
[0m20:51:29.591791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m20:51:29.591989 [info ] [Thread-7 (]: 7 of 16 START sql view model main.stg_supplier_products ........................ [RUN]
[0m20:51:29.592201 [info ] [Thread-8 (]: 8 of 16 START sql view model main.stg_suppliers ................................ [RUN]
[0m20:51:29.592426 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m20:51:29.592626 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m20:51:29.592809 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m20:51:29.592987 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m20:51:29.593192 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m20:51:29.593346 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:51:29.593529 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m20:51:29.593710 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m20:51:29.593862 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m20:51:29.594012 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m20:51:29.594160 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m20:51:29.594298 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:51:29.594438 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:51:29.599409 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:51:29.599578 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m20:51:29.599725 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m20:51:29.600924 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m20:51:29.602085 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:51:29.603130 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m20:51:29.604794 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:51:29.606279 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:51:29.607413 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m20:51:29.608443 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m20:51:29.608590 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:51:29.608912 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m20:51:29.609124 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m20:51:29.609251 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m20:51:29.609461 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:51:29.609624 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m20:51:29.609832 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m20:51:29.621366 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m20:51:29.623509 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:51:29.625109 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m20:51:29.626580 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m20:51:29.628018 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m20:51:29.629445 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:51:29.649321 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:51:29.650856 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m20:51:29.652240 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m20:51:29.652777 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:51:29.652979 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:51:29.653163 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:51:29.653350 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:51:29.653505 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:51:29.653689 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:51:29.653927 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:51:29.654102 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:51:29.654263 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m20:51:29.654420 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:51:29.654572 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m20:51:29.654730 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m20:51:29.654883 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m20:51:29.655034 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m20:51:29.655184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:29.655327 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m20:51:29.655475 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:51:29.655623 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m20:51:29.655771 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:51:29.655917 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:51:29.656061 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:51:29.656202 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m20:51:29.658517 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m20:51:29.658685 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:51:29.658867 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:51:29.659054 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:51:29.659235 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:51:29.659404 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m20:51:29.659585 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:51:29.659785 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m20:51:29.659920 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:51:29.660051 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m20:51:29.660235 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:51:29.660373 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:51:29.660524 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:51:29.660673 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:51:29.660824 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:51:29.660976 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:51:29.661150 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(first_name), 1, 1)), LOWER(SUBSTRING(TRIM(first_name), 2)))
 AS first_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(last_name), 1, 1)), LOWER(SUBSTRING(TRIM(last_name), 2)))
 AS last_name,
  LOWER(TRIM(email)) AS email,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m20:51:29.661313 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:51:29.661480 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m20:51:29.661643 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:51:29.661799 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m20:51:29.661974 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  
  TRY_CAST(product_id AS INTEGER)
 AS product_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))
 AS product_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))
 AS category,
  
  TRY_CAST(price AS DECIMAL(10,2))
 AS price,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m20:51:29.662155 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m20:51:29.662329 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m20:51:29.662529 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m20:51:29.662730 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m20:51:29.663056 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.663211 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.663372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.663531 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.663681 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.663832 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.666696 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:51:29.667979 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:51:29.668142 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m20:51:29.669497 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:51:29.669643 [debug] [Thread-8 (]: SQL status: OK in 0.006 seconds
[0m20:51:29.670839 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:51:29.672379 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:51:29.673506 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:51:29.673654 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions" rename to "stg_inventory_transactions__dbt_backup"
[0m20:51:29.673795 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:51:29.674903 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:51:29.675047 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:51:29.676156 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:51:29.676296 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m20:51:29.676433 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m20:51:29.676574 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:51:29.676776 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m20:51:29.676995 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:51:29.677336 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.677486 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.677619 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.677734 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.677865 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.678065 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.679174 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:51:29.679314 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.679455 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.680571 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:51:29.681621 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:51:29.683036 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:51:29.684131 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:51:29.685242 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:51:29.685395 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:51:29.686509 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:51:29.687554 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:51:29.687701 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m20:51:29.687845 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m20:51:29.687988 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:51:29.688132 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:51:29.688285 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:51:29.688469 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m20:51:29.688641 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:51:29.688777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.688979 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.689124 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.689341 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.689472 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.689632 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.696448 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:51:29.696618 [debug] [Thread-7 (]: SQL status: OK in 0.007 seconds
[0m20:51:29.697155 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:51:29.697294 [debug] [Thread-8 (]: SQL status: OK in 0.008 seconds
[0m20:51:29.697845 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:51:29.698330 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:51:29.698807 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:51:29.699275 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:51:29.699421 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:51:29.699887 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:51:29.700040 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:51:29.700507 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:51:29.700652 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:51:29.700797 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:51:29.700938 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:51:29.701079 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:51:29.701212 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m20:51:29.701351 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:51:29.701486 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m20:51:29.701624 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:51:29.701762 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m20:51:29.701917 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m20:51:29.702071 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m20:51:29.702206 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m20:51:29.702385 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m20:51:29.702601 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m20:51:29.702957 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.703136 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.703294 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.703426 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.703685 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.703837 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.705885 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m20:51:29.706031 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m20:51:29.706171 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m20:51:29.707645 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m20:51:29.708561 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m20:51:29.709531 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m20:51:29.710414 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m20:51:29.711308 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m20:51:29.711466 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m20:51:29.712454 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m20:51:29.713359 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m20:51:29.713507 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
drop view if exists "jaffle_shop"."main"."stg_products__dbt_backup" cascade
[0m20:51:29.713654 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m20:51:29.713800 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m20:51:29.713942 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m20:51:29.714083 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m20:51:29.714265 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m20:51:29.714430 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m20:51:29.714664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.714902 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.715055 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:51:29.715235 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.716216 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:51:29.716356 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:51:29.716502 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m20:51:29.716640 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m20:51:29.717166 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m20:51:29.717304 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:51:29.717805 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m20:51:29.718275 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m20:51:29.718943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607700>]}
[0m20:51:29.719432 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m20:51:29.719885 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m20:51:29.720322 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m20:51:29.720515 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607a60>]}
[0m20:51:29.720991 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m20:51:29.721177 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076076d0>]}
[0m20:51:29.721385 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107606860>]}
[0m20:51:29.721815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607be0>]}
[0m20:51:29.721663 [info ] [Thread-1 (]: 1 of 16 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.13s]
[0m20:51:29.722065 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607b80>]}
[0m20:51:29.722267 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607e50>]}
[0m20:51:29.722557 [info ] [Thread-4 (]: 4 of 16 OK created sql view model main.stg_order_details ....................... [[32mOK[0m in 0.13s]
[0m20:51:29.725700 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607dc0>]}
[0m20:51:29.725956 [info ] [Thread-3 (]: 3 of 16 OK created sql view model main.stg_inventory_transactions .............. [[32mOK[0m in 0.13s]
[0m20:51:29.726234 [info ] [Thread-6 (]: 6 of 16 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.13s]
[0m20:51:29.726497 [info ] [Thread-2 (]: 2 of 16 OK created sql view model main.stg_inventory ........................... [[32mOK[0m in 0.13s]
[0m20:51:29.726770 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:51:29.726998 [info ] [Thread-5 (]: 5 of 16 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.13s]
[0m20:51:29.727251 [info ] [Thread-7 (]: 7 of 16 OK created sql view model main.stg_supplier_products ................... [[32mOK[0m in 0.13s]
[0m20:51:29.727506 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m20:51:29.727767 [info ] [Thread-8 (]: 8 of 16 OK created sql view model main.stg_suppliers ........................... [[32mOK[0m in 0.13s]
[0m20:51:29.728021 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m20:51:29.728244 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m20:51:29.728477 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m20:51:29.728778 [debug] [Thread-10 ]: Began running node model.jaffle_shop.dim_customers
[0m20:51:29.728952 [debug] [Thread-11 ]: Began running node model.jaffle_shop.dim_products
[0m20:51:29.729175 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:51:29.729410 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m20:51:29.729706 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m20:51:29.730070 [debug] [Thread-13 ]: Began running node model.jaffle_shop.low_stock
[0m20:51:29.730285 [info ] [Thread-10 ]: 9 of 16 START sql table model main.dim_customers ............................... [RUN]
[0m20:51:29.730509 [info ] [Thread-11 ]: 10 of 16 START sql table model main.dim_products ............................... [RUN]
[0m20:51:29.730777 [debug] [Thread-15 ]: Began running node model.jaffle_shop.fact_sales
[0m20:51:29.731061 [info ] [Thread-13 ]: 11 of 16 START sql table model main.low_stock .................................. [RUN]
[0m20:51:29.731309 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m20:51:29.731515 [debug] [Thread-11 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_products'
[0m20:51:29.731714 [info ] [Thread-15 ]: 12 of 16 START sql table model main.fact_sales ................................. [RUN]
[0m20:51:29.731944 [debug] [Thread-13 ]: Acquiring new duckdb connection 'model.jaffle_shop.low_stock'
[0m20:51:29.732111 [debug] [Thread-10 ]: Began compiling node model.jaffle_shop.dim_customers
[0m20:51:29.732263 [debug] [Thread-11 ]: Began compiling node model.jaffle_shop.dim_products
[0m20:51:29.732465 [debug] [Thread-15 ]: Acquiring new duckdb connection 'model.jaffle_shop.fact_sales'
[0m20:51:29.732632 [debug] [Thread-13 ]: Began compiling node model.jaffle_shop.low_stock
[0m20:51:29.733946 [debug] [Thread-10 ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:51:29.735782 [debug] [Thread-11 ]: Writing injected SQL for node "model.jaffle_shop.dim_products"
[0m20:51:29.735939 [debug] [Thread-15 ]: Began compiling node model.jaffle_shop.fact_sales
[0m20:51:29.737338 [debug] [Thread-13 ]: Writing injected SQL for node "model.jaffle_shop.low_stock"
[0m20:51:29.738574 [debug] [Thread-15 ]: Writing injected SQL for node "model.jaffle_shop.fact_sales"
[0m20:51:29.738833 [debug] [Thread-10 ]: Began executing node model.jaffle_shop.dim_customers
[0m20:51:29.738979 [debug] [Thread-11 ]: Began executing node model.jaffle_shop.dim_products
[0m20:51:29.747713 [debug] [Thread-10 ]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m20:51:29.747885 [debug] [Thread-13 ]: Began executing node model.jaffle_shop.low_stock
[0m20:51:29.749489 [debug] [Thread-11 ]: Writing runtime sql for node "model.jaffle_shop.dim_products"
[0m20:51:29.749651 [debug] [Thread-15 ]: Began executing node model.jaffle_shop.fact_sales
[0m20:51:29.751193 [debug] [Thread-13 ]: Writing runtime sql for node "model.jaffle_shop.low_stock"
[0m20:51:29.751432 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:51:29.753330 [debug] [Thread-15 ]: Writing runtime sql for node "model.jaffle_shop.fact_sales"
[0m20:51:29.753541 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: BEGIN
[0m20:51:29.753728 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:51:29.753907 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:51:29.754061 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m20:51:29.754219 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: BEGIN
[0m20:51:29.754422 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:51:29.754583 [debug] [Thread-13 ]: On model.jaffle_shop.low_stock: BEGIN
[0m20:51:29.756709 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m20:51:29.756862 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m20:51:29.757023 [debug] [Thread-15 ]: On model.jaffle_shop.fact_sales: BEGIN
[0m20:51:29.757173 [debug] [Thread-13 ]: Opening a new connection, currently in state init
[0m20:51:29.757360 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:51:29.757518 [debug] [Thread-11 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.757652 [debug] [Thread-15 ]: Opening a new connection, currently in state init
[0m20:51:29.757850 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:51:29.757996 [debug] [Thread-13 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.758139 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:51:29.758346 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.758485 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:51:29.758642 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_products__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m20:51:29.758803 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:51:29.758986 [debug] [Thread-13 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */

  
    
    

    create  table
      "jaffle_shop"."main"."low_stock__dbt_tmp"
  
    as (
      WITH dim_products AS (
    SELECT
      product_id,
      product_name,
      category,
      price,
      created_at AS product_created_date
    FROM "jaffle_shop"."main"."stg_products"
),

inventory_status AS (
    SELECT
      i.product_id,
      p.product_name,
      i.quantity,
      i.last_updated
    FROM "jaffle_shop"."main"."stg_inventory" AS i
    JOIN "jaffle_shop"."main"."stg_products" AS p ON i.product_id = p.product_id
),

current_inventory AS (
    SELECT
        i.product_id,
        p.product_name,
        p.category,
        i.quantity,
        i.last_updated
    FROM inventory_status AS i
    JOIN dim_products AS p ON i.product_id = p.product_id
),

low_stock_products AS (
    SELECT
        ci.product_id,
        ci.product_name,
        ci.category,
        ci.quantity,
        ci.last_updated
    FROM current_inventory AS ci
    WHERE ci.quantity < 20
)

SELECT * FROM low_stock_products
ORDER BY quantity ASC
    );
  
  
[0m20:51:29.759204 [debug] [Thread-15 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fact_sales__dbt_tmp"
  
    as (
      SELECT
  od.order_id,
  o.order_date,
  od.product_id,
  od.quantity,
  od.unit_price,
  od.line_total,
  o.customer_id
FROM "jaffle_shop"."main"."stg_order_details" AS od
JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
    );
  
  
[0m20:51:29.760940 [debug] [Thread-11 ]: SQL status: OK in 0.002 seconds
[0m20:51:29.761117 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m20:51:29.762489 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:51:29.763719 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:51:29.763909 [debug] [Thread-13 ]: SQL status: OK in 0.005 seconds
[0m20:51:29.764067 [debug] [Thread-15 ]: SQL status: OK in 0.005 seconds
[0m20:51:29.764228 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m20:51:29.764381 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m20:51:29.765501 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:51:29.766675 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:51:29.766874 [debug] [Thread-13 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock" rename to "low_stock__dbt_backup"
[0m20:51:29.767040 [debug] [Thread-15 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m20:51:29.767258 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:51:29.767401 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.768592 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:51:29.768726 [debug] [Thread-13 ]: SQL status: OK in 0.002 seconds
[0m20:51:29.768856 [debug] [Thread-15 ]: SQL status: OK in 0.002 seconds
[0m20:51:29.769951 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:51:29.770103 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m20:51:29.771692 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:51:29.772709 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:51:29.772850 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:51:29.773016 [debug] [Thread-13 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock__dbt_tmp" rename to "low_stock"
[0m20:51:29.773200 [debug] [Thread-15 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m20:51:29.773343 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:51:29.773541 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:51:29.775567 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: COMMIT
[0m20:51:29.775706 [debug] [Thread-13 ]: SQL status: OK in 0.002 seconds
[0m20:51:29.775838 [debug] [Thread-15 ]: SQL status: OK in 0.002 seconds
[0m20:51:29.776429 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:51:29.776578 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:51:29.777092 [debug] [Thread-13 ]: On model.jaffle_shop.low_stock: COMMIT
[0m20:51:29.777586 [debug] [Thread-15 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:51:29.777722 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:51:29.777855 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: COMMIT
[0m20:51:29.777993 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:51:29.778140 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:51:29.778287 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m20:51:29.778455 [debug] [Thread-13 ]: On model.jaffle_shop.low_stock: COMMIT
[0m20:51:29.778614 [debug] [Thread-15 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m20:51:29.778753 [debug] [Thread-11 ]: SQL status: OK in 0.000 seconds
[0m20:51:29.779894 [debug] [Thread-11 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m20:51:29.780063 [debug] [Thread-13 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.780195 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.780384 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
drop table if exists "jaffle_shop"."main"."dim_products__dbt_backup" cascade
[0m20:51:29.780528 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m20:51:29.781484 [debug] [Thread-13 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m20:51:29.782480 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m20:51:29.783475 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m20:51:29.783666 [debug] [Thread-13 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
drop table if exists "jaffle_shop"."main"."low_stock__dbt_backup" cascade
[0m20:51:29.783826 [debug] [Thread-15 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
drop table if exists "jaffle_shop"."main"."fact_sales__dbt_backup" cascade
[0m20:51:29.783967 [debug] [Thread-11 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.784122 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m20:51:29.784708 [debug] [Thread-11 ]: On model.jaffle_shop.dim_products: Close
[0m20:51:29.784970 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107606b30>]}
[0m20:51:29.785119 [debug] [Thread-13 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.785253 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.785533 [info ] [Thread-11 ]: 10 of 16 OK created sql table model main.dim_products .......................... [[32mOK[0m in 0.05s]
[0m20:51:29.785720 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.786233 [debug] [Thread-13 ]: On model.jaffle_shop.low_stock: Close
[0m20:51:29.786699 [debug] [Thread-15 ]: On model.jaffle_shop.fact_sales: Close
[0m20:51:29.786926 [debug] [Thread-11 ]: Finished running node model.jaffle_shop.dim_products
[0m20:51:29.787391 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: Close
[0m20:51:29.787582 [debug] [Thread-13 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3c340>]}
[0m20:51:29.787785 [debug] [Thread-15 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107606aa0>]}
[0m20:51:29.788087 [debug] [Thread-17 ]: Began running node model.jaffle_shop.top_category
[0m20:51:29.793732 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766fbe0>]}
[0m20:51:29.794057 [info ] [Thread-13 ]: 11 of 16 OK created sql table model main.low_stock ............................. [[32mOK[0m in 0.06s]
[0m20:51:29.794342 [info ] [Thread-15 ]: 12 of 16 OK created sql table model main.fact_sales ............................ [[32mOK[0m in 0.06s]
[0m20:51:29.794557 [info ] [Thread-17 ]: 13 of 16 START sql table model main.top_category ............................... [RUN]
[0m20:51:29.794807 [info ] [Thread-10 ]: 9 of 16 OK created sql table model main.dim_customers .......................... [[32mOK[0m in 0.06s]
[0m20:51:29.795074 [debug] [Thread-13 ]: Finished running node model.jaffle_shop.low_stock
[0m20:51:29.795303 [debug] [Thread-15 ]: Finished running node model.jaffle_shop.fact_sales
[0m20:51:29.795516 [debug] [Thread-17 ]: Acquiring new duckdb connection 'model.jaffle_shop.top_category'
[0m20:51:29.795749 [debug] [Thread-10 ]: Finished running node model.jaffle_shop.dim_customers
[0m20:51:29.796071 [debug] [Thread-19 ]: Began running node model.jaffle_shop.monthly_sales_growth
[0m20:51:29.796217 [debug] [Thread-17 ]: Began compiling node model.jaffle_shop.top_category
[0m20:51:29.796473 [debug] [Thread-21 ]: Began running node model.jaffle_shop.avg_order_value
[0m20:51:29.796785 [debug] [Thread-22 ]: Began running node model.jaffle_shop.customer_LTV
[0m20:51:29.796656 [info ] [Thread-19 ]: 14 of 16 START sql table model main.monthly_sales_growth ....................... [RUN]
[0m20:51:29.798343 [debug] [Thread-17 ]: Writing injected SQL for node "model.jaffle_shop.top_category"
[0m20:51:29.798543 [info ] [Thread-21 ]: 15 of 16 START sql table model main.avg_order_value ............................ [RUN]
[0m20:51:29.798764 [info ] [Thread-22 ]: 16 of 16 START sql table model main.customer_LTV ............................... [RUN]
[0m20:51:29.798986 [debug] [Thread-19 ]: Acquiring new duckdb connection 'model.jaffle_shop.monthly_sales_growth'
[0m20:51:29.799220 [debug] [Thread-21 ]: Acquiring new duckdb connection 'model.jaffle_shop.avg_order_value'
[0m20:51:29.799436 [debug] [Thread-22 ]: Acquiring new duckdb connection 'model.jaffle_shop.customer_LTV'
[0m20:51:29.799592 [debug] [Thread-19 ]: Began compiling node model.jaffle_shop.monthly_sales_growth
[0m20:51:29.799732 [debug] [Thread-17 ]: Began executing node model.jaffle_shop.top_category
[0m20:51:29.799884 [debug] [Thread-21 ]: Began compiling node model.jaffle_shop.avg_order_value
[0m20:51:29.800024 [debug] [Thread-22 ]: Began compiling node model.jaffle_shop.customer_LTV
[0m20:51:29.802154 [debug] [Thread-19 ]: Writing injected SQL for node "model.jaffle_shop.monthly_sales_growth"
[0m20:51:29.803691 [debug] [Thread-17 ]: Writing runtime sql for node "model.jaffle_shop.top_category"
[0m20:51:29.804978 [debug] [Thread-21 ]: Writing injected SQL for node "model.jaffle_shop.avg_order_value"
[0m20:51:29.806304 [debug] [Thread-22 ]: Writing injected SQL for node "model.jaffle_shop.customer_LTV"
[0m20:51:29.806631 [debug] [Thread-19 ]: Began executing node model.jaffle_shop.monthly_sales_growth
[0m20:51:29.808060 [debug] [Thread-19 ]: Writing runtime sql for node "model.jaffle_shop.monthly_sales_growth"
[0m20:51:29.808217 [debug] [Thread-21 ]: Began executing node model.jaffle_shop.avg_order_value
[0m20:51:29.808375 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:51:29.808548 [debug] [Thread-22 ]: Began executing node model.jaffle_shop.customer_LTV
[0m20:51:29.809972 [debug] [Thread-21 ]: Writing runtime sql for node "model.jaffle_shop.avg_order_value"
[0m20:51:29.810147 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: BEGIN
[0m20:51:29.810309 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:51:29.811732 [debug] [Thread-22 ]: Writing runtime sql for node "model.jaffle_shop.customer_LTV"
[0m20:51:29.811915 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m20:51:29.812090 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: BEGIN
[0m20:51:29.812243 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:51:29.814571 [debug] [Thread-19 ]: Opening a new connection, currently in state init
[0m20:51:29.814723 [debug] [Thread-17 ]: SQL status: OK in 0.003 seconds
[0m20:51:29.814894 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:51:29.815050 [debug] [Thread-21 ]: On model.jaffle_shop.avg_order_value: BEGIN
[0m20:51:29.815235 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m20:51:29.815388 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.815523 [debug] [Thread-22 ]: On model.jaffle_shop.customer_LTV: BEGIN
[0m20:51:29.815661 [debug] [Thread-21 ]: Opening a new connection, currently in state init
[0m20:51:29.815835 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

top_category AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank
    FROM category_sales AS cs
)

SELECT * FROM top_category
    );
  
  
[0m20:51:29.816006 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:51:29.816142 [debug] [Thread-22 ]: Opening a new connection, currently in state init
[0m20:51:29.816358 [debug] [Thread-21 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.816549 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */

  
    
    

    create  table
      "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

monthly_sales AS (
    SELECT
        DATE_TRUNC('month', order_date) AS sales_month,
        SUM(line_total) AS total_revenue,
        SUM(quantity) AS total_quantity_sold
    FROM "jaffle_shop"."main"."fact_sales"
    GROUP BY sales_month
),

sales_growth AS (
    SELECT
        ms.sales_month,
        ms.total_revenue,
        ms.total_quantity_sold,
        LAG(ms.total_revenue) OVER (ORDER BY ms.sales_month) AS previous_revenue,
        LAG(ms.total_quantity_sold) OVER (ORDER BY ms.sales_month) AS previous_quantity
    FROM monthly_sales AS ms
),

growth_calculations AS (
    SELECT
        sg.sales_month,
        sg.total_revenue,
        sg.total_quantity_sold,
        ROUND(((sg.total_revenue - sg.previous_revenue) / sg.previous_revenue) * 100, 2) AS revenue_growth_percentage,
        ROUND(((sg.total_quantity_sold - sg.previous_quantity) / sg.previous_quantity) * 100, 2) AS quantity_growth_percentage
    FROM sales_growth AS sg
    WHERE sg.previous_revenue IS NOT NULL
)

SELECT * FROM growth_calculations
ORDER BY sales_month ASC
    );
  
  
[0m20:51:29.816787 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:51:29.816927 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.817132 [debug] [Thread-21 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */

  
    
    

    create  table
      "jaffle_shop"."main"."avg_order_value__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_order_totals AS (
    SELECT
        customer_id,
        COUNT(DISTINCT order_id) AS total_orders,
        SUM(line_total) AS total_spent
    FROM fact_sales
    GROUP BY customer_id
    HAVING COUNT(DISTINCT order_id) > 3
),

average_order_value AS (
    SELECT
        cot.customer_id,
        dc.first_name,
        dc.last_name,
        cot.total_orders,
        cot.total_spent,
        ROUND(cot.total_spent / cot.total_orders, 1) AS avg_order_value
    FROM customer_order_totals AS cot
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cot.customer_id = dc.customer_id
)

SELECT * FROM average_order_value
ORDER BY avg_order_value DESC
    );
  
  
[0m20:51:29.817319 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:51:29.817520 [debug] [Thread-22 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */

  
    
    

    create  table
      "jaffle_shop"."main"."customer_LTV__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_revenue AS (
    SELECT
        fs.customer_id,
        SUM(fs.line_total) AS total_revenue,
        MIN(fs.order_date) AS first_purchase_date,
        MAX(fs.order_date) AS last_purchase_date,
        COUNT(DISTINCT fs.order_id) AS total_orders
    FROM fact_sales AS fs
    GROUP BY fs.customer_id
),

customer_ltv AS (
    SELECT
        cr.customer_id,
        dc.first_name,
        dc.last_name,
        cr.total_revenue,
        cr.total_orders,
        DATE_PART('day', cr.last_purchase_date - cr.first_purchase_date) AS customer_lifespan_days,
        ROUND(cr.total_revenue / NULLIF(cr.total_orders, 0), 2) AS avg_order_value,
        ROUND(cr.total_revenue / NULLIF(DATE_PART('day', CURRENT_DATE - cr.first_purchase_date) / 30, 0), 2) AS monthly_ltv
    FROM customer_revenue AS cr
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cr.customer_id = dc.customer_id
)

SELECT * FROM customer_ltv
ORDER BY total_revenue DESC
    );
  
  
[0m20:51:29.818405 [debug] [Thread-17 ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

top_category AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank
    FROM category_sales AS cs
)

SELECT * FROM top_category
    );
  
  
[0m20:51:29.818593 [debug] [Thread-17 ]: DuckDB adapter: Rolling back transaction.
[0m20:51:29.818825 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: ROLLBACK
[0m20:51:29.821253 [debug] [Thread-21 ]: SQL status: OK in 0.004 seconds
[0m20:51:29.823300 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:51:29.823509 [debug] [Thread-19 ]: SQL status: OK in 0.006 seconds
[0m20:51:29.823691 [debug] [Thread-21 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value" rename to "avg_order_value__dbt_backup"
[0m20:51:29.823990 [debug] [Thread-22 ]: SQL status: OK in 0.006 seconds
[0m20:51:29.825218 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:51:29.826350 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:51:29.826549 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth" rename to "monthly_sales_growth__dbt_backup"
[0m20:51:29.826714 [debug] [Thread-21 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.826865 [debug] [Thread-22 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV" rename to "customer_LTV__dbt_backup"
[0m20:51:29.828066 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:51:29.828226 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.829585 [debug] [Thread-17 ]: Failed to rollback 'model.jaffle_shop.top_category'
[0m20:51:29.833630 [debug] [Thread-21 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value__dbt_tmp" rename to "avg_order_value"
[0m20:51:29.834808 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:51:29.834949 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.835106 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: Close
[0m20:51:29.835293 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp" rename to "monthly_sales_growth"
[0m20:51:29.835435 [debug] [Thread-21 ]: SQL status: OK in 0.000 seconds
[0m20:51:29.836627 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:51:29.837371 [debug] [Thread-21 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:51:29.837547 [debug] [Thread-22 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV__dbt_tmp" rename to "customer_LTV"
[0m20:51:29.837739 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.838110 [debug] [Thread-17 ]: Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
          od.order_id,
          o.order_date,
          od.product_id,
          od.quantity,
          od.unit_price,
          od.line_total,
          o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:51:29.838285 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:51:29.838854 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:51:29.839076 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079dfa90>]}
[0m20:51:29.839220 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.839368 [debug] [Thread-21 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m20:51:29.839525 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:51:29.840425 [debug] [Thread-22 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:51:29.839817 [error] [Thread-17 ]: 13 of 16 ERROR creating sql table model main.top_category ...................... [[31mERROR[0m in 0.04s]
[0m20:51:29.840649 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m20:51:29.840827 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:51:29.840976 [debug] [Thread-21 ]: SQL status: OK in 0.000 seconds
[0m20:51:29.841242 [debug] [Thread-17 ]: Finished running node model.jaffle_shop.top_category
[0m20:51:29.841427 [debug] [Thread-22 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m20:51:29.841590 [debug] [Thread-19 ]: SQL status: OK in 0.000 seconds
[0m20:51:29.842561 [debug] [Thread-21 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m20:51:29.846852 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m20:51:29.846993 [debug] [Thread-22 ]: SQL status: OK in 0.002 seconds
[0m20:51:29.847162 [debug] [Thread-21 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
drop table if exists "jaffle_shop"."main"."avg_order_value__dbt_backup" cascade
[0m20:51:29.847333 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
drop table if exists "jaffle_shop"."main"."monthly_sales_growth__dbt_backup" cascade
[0m20:51:29.848262 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m20:51:29.848494 [debug] [Thread-22 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
drop table if exists "jaffle_shop"."main"."customer_LTV__dbt_backup" cascade
[0m20:51:29.848636 [debug] [Thread-21 ]: SQL status: OK in 0.000 seconds
[0m20:51:29.848775 [debug] [Thread-19 ]: SQL status: OK in 0.000 seconds
[0m20:51:29.849294 [debug] [Thread-21 ]: On model.jaffle_shop.avg_order_value: Close
[0m20:51:29.849806 [debug] [Thread-19 ]: On model.jaffle_shop.monthly_sales_growth: Close
[0m20:51:29.849954 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m20:51:29.850166 [debug] [Thread-21 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b961a0>]}
[0m20:51:29.850387 [debug] [Thread-19 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b96e60>]}
[0m20:51:29.850878 [debug] [Thread-22 ]: On model.jaffle_shop.customer_LTV: Close
[0m20:51:29.851145 [info ] [Thread-21 ]: 15 of 16 OK created sql table model main.avg_order_value ....................... [[32mOK[0m in 0.05s]
[0m20:51:29.851370 [info ] [Thread-19 ]: 14 of 16 OK created sql table model main.monthly_sales_growth .................. [[32mOK[0m in 0.05s]
[0m20:51:29.855049 [debug] [Thread-22 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c41901-553d-49f4-913d-55edebeb76ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b16290>]}
[0m20:51:29.855337 [debug] [Thread-21 ]: Finished running node model.jaffle_shop.avg_order_value
[0m20:51:29.855574 [debug] [Thread-19 ]: Finished running node model.jaffle_shop.monthly_sales_growth
[0m20:51:29.855906 [info ] [Thread-22 ]: 16 of 16 OK created sql table model main.customer_LTV .......................... [[32mOK[0m in 0.06s]
[0m20:51:29.856266 [debug] [Thread-22 ]: Finished running node model.jaffle_shop.customer_LTV
[0m20:51:29.857030 [debug] [MainThread]: Using duckdb connection "master"
[0m20:51:29.857168 [debug] [MainThread]: On master: BEGIN
[0m20:51:29.857276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:29.859500 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:51:29.859634 [debug] [MainThread]: On master: COMMIT
[0m20:51:29.859755 [debug] [MainThread]: Using duckdb connection "master"
[0m20:51:29.859874 [debug] [MainThread]: On master: COMMIT
[0m20:51:29.860013 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:51:29.860141 [debug] [MainThread]: On master: Close
[0m20:51:29.860659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:29.860776 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:51:29.860875 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m20:51:29.860968 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m20:51:29.861063 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m20:51:29.861154 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m20:51:29.861244 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m20:51:29.861337 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m20:51:29.861427 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m20:51:29.861518 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m20:51:29.861608 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_products' was properly closed.
[0m20:51:29.861701 [debug] [MainThread]: Connection 'model.jaffle_shop.low_stock' was properly closed.
[0m20:51:29.861790 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_sales' was properly closed.
[0m20:51:29.861882 [debug] [MainThread]: Connection 'model.jaffle_shop.top_category' was properly closed.
[0m20:51:29.861971 [debug] [MainThread]: Connection 'model.jaffle_shop.monthly_sales_growth' was properly closed.
[0m20:51:29.862061 [debug] [MainThread]: Connection 'model.jaffle_shop.avg_order_value' was properly closed.
[0m20:51:29.862151 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_LTV' was properly closed.
[0m20:51:29.862331 [info ] [MainThread]: 
[0m20:51:29.862465 [info ] [MainThread]: Finished running 8 view models, 8 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m20:51:29.863470 [debug] [MainThread]: Command end result
[0m20:51:29.881936 [info ] [MainThread]: 
[0m20:51:29.882167 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:51:29.882298 [info ] [MainThread]: 
[0m20:51:29.882486 [error] [MainThread]:   Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
          od.order_id,
          o.order_date,
          od.product_id,
          od.quantity,
          od.unit_price,
          od.line_total,
          o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m20:51:29.882658 [info ] [MainThread]: 
[0m20:51:29.882786 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m20:51:29.884164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7362849, "process_user_time": 1.037134, "process_kernel_time": 0.147914, "process_mem_max_rss": "165838848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:51:29.884359 [debug] [MainThread]: Command `dbt run` failed at 20:51:29.884326 after 0.74 seconds
[0m20:51:29.884512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105026920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c67610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b60520>]}
[0m20:51:29.884654 [debug] [MainThread]: Flushing usage events
[0m14:22:58.844930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102462980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c87cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c87610>]}


============================== 14:22:58.855915 | 5c3cf9ee-2e11-4a34-86e7-4645614905ab ==============================
[0m14:22:58.855915 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:22:58.856182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:58.992989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c45e70>]}
[0m14:22:59.014157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c87610>]}
[0m14:22:59.014705 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:22:59.022619 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m14:22:59.099731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:59.099970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:59.124801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104156140>]}
[0m14:22:59.181922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041753f0>]}
[0m14:22:59.182190 [info ] [MainThread]: Found 8 seeds, 16 models, 5 data tests, 423 macros
[0m14:22:59.182346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041753c0>]}
[0m14:22:59.183196 [info ] [MainThread]: 
[0m14:22:59.183451 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:22:59.186091 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m14:22:59.211203 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m14:22:59.211417 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m14:22:59.211542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:59.220467 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:22:59.221060 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:22:59.222110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m14:22:59.222348 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m14:22:59.225212 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:22:59.225353 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m14:22:59.225477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:59.227676 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:22:59.228224 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:22:59.228353 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m14:22:59.228492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:22:59.228604 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:22:59.228724 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m14:22:59.228915 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:22:59.229249 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m14:22:59.229377 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:22:59.229492 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m14:22:59.229636 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:22:59.229758 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m14:22:59.231175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m14:22:59.233560 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m14:22:59.233714 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m14:22:59.233834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:59.235895 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:22:59.236015 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m14:22:59.236137 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m14:22:59.245349 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:22:59.247447 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m14:22:59.247931 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m14:22:59.248056 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m14:22:59.249860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e69450>]}
[0m14:22:59.250072 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:59.250209 [debug] [MainThread]: On master: BEGIN
[0m14:22:59.250328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:59.252275 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:22:59.252409 [debug] [MainThread]: On master: COMMIT
[0m14:22:59.252528 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:59.252641 [debug] [MainThread]: On master: COMMIT
[0m14:22:59.252771 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:22:59.252891 [debug] [MainThread]: On master: Close
[0m14:22:59.253343 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m14:22:59.253489 [info ] [MainThread]: 
[0m14:22:59.255233 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:22:59.255414 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m14:22:59.255590 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m14:22:59.255754 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m14:22:59.255911 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m14:22:59.256064 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m14:22:59.256273 [info ] [Thread-1 (]: 1 of 16 START sql view model main.stg_customers ................................ [RUN]
[0m14:22:59.256449 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m14:22:59.256626 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m14:22:59.256824 [info ] [Thread-2 (]: 2 of 16 START sql view model main.stg_inventory ................................ [RUN]
[0m14:22:59.257039 [info ] [Thread-3 (]: 3 of 16 START sql view model main.stg_inventory_transactions ................... [RUN]
[0m14:22:59.257249 [info ] [Thread-4 (]: 4 of 16 START sql view model main.stg_order_details ............................ [RUN]
[0m14:22:59.257475 [info ] [Thread-5 (]: 5 of 16 START sql view model main.stg_orders ................................... [RUN]
[0m14:22:59.257679 [info ] [Thread-6 (]: 6 of 16 START sql view model main.stg_products ................................. [RUN]
[0m14:22:59.257880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m14:22:59.258128 [info ] [Thread-7 (]: 7 of 16 START sql view model main.stg_supplier_products ........................ [RUN]
[0m14:22:59.258394 [info ] [Thread-8 (]: 8 of 16 START sql view model main.stg_suppliers ................................ [RUN]
[0m14:22:59.258664 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m14:22:59.258905 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m14:22:59.259107 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m14:22:59.259295 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m14:22:59.259481 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m14:22:59.259641 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:22:59.259865 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m14:22:59.260075 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m14:22:59.260226 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m14:22:59.260393 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m14:22:59.260552 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m14:22:59.260693 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:22:59.260847 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m14:22:59.266013 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:22:59.266177 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m14:22:59.266313 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m14:22:59.267395 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m14:22:59.268450 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m14:22:59.269430 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m14:22:59.270821 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:22:59.272328 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m14:22:59.273524 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m14:22:59.274591 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m14:22:59.274931 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:22:59.275091 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m14:22:59.275311 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m14:22:59.275469 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m14:22:59.275711 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:22:59.275892 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m14:22:59.281617 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m14:22:59.288587 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m14:22:59.290563 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:22:59.292115 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m14:22:59.293656 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m14:22:59.295311 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m14:22:59.296761 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:22:59.316754 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m14:22:59.318353 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m14:22:59.319799 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m14:22:59.320322 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:22:59.320562 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:22:59.320900 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:22:59.321054 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:22:59.321223 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:22:59.321399 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:22:59.321600 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:22:59.321750 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m14:22:59.321924 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m14:22:59.322070 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:22:59.322216 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m14:22:59.322375 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m14:22:59.322529 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m14:22:59.322685 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m14:22:59.322859 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m14:22:59.323017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:59.323176 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:22:59.323323 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m14:22:59.323475 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:22:59.323627 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m14:22:59.323774 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:22:59.323921 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:22:59.324070 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m14:22:59.326365 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:22:59.326546 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m14:22:59.326752 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:22:59.326928 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:22:59.327077 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m14:22:59.328255 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m14:22:59.328447 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:22:59.328607 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:22:59.328767 [debug] [Thread-7 (]: SQL status: OK in 0.005 seconds
[0m14:22:59.328932 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:22:59.329073 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m14:22:59.329222 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:22:59.329367 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:22:59.329521 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:22:59.329671 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:22:59.329836 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(first_name), 1, 1)), LOWER(SUBSTRING(TRIM(first_name), 2)))
 AS first_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(last_name), 1, 1)), LOWER(SUBSTRING(TRIM(last_name), 2)))
 AS last_name,
  LOWER(TRIM(email)) AS email,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m14:22:59.330008 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:22:59.330169 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m14:22:59.330332 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:22:59.330490 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m14:22:59.330665 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m14:22:59.330838 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  
  TRY_CAST(product_id AS INTEGER)
 AS product_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))
 AS product_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))
 AS category,
  
  TRY_CAST(price AS DECIMAL(10,2))
 AS price,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m14:22:59.331019 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m14:22:59.331219 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m14:22:59.331419 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m14:22:59.331576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.331721 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.332046 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.332222 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.332369 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.335139 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:22:59.335284 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m14:22:59.335424 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:22:59.335559 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m14:22:59.336891 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:22:59.338126 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:22:59.339385 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:22:59.341073 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:22:59.341241 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:22:59.342508 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:22:59.343774 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:22:59.345011 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:22:59.345181 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m14:22:59.345336 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m14:22:59.345535 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m14:22:59.345723 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:22:59.345941 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m14:22:59.346114 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions" rename to "stg_inventory_transactions__dbt_backup"
[0m14:22:59.346287 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m14:22:59.346432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:22:59.346659 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.346877 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.347001 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.347183 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.347311 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.347498 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.348847 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:22:59.348999 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m14:22:59.350258 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:22:59.351457 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:22:59.353005 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:22:59.354181 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:22:59.355462 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:22:59.356724 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:22:59.356901 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:22:59.358119 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:22:59.358293 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m14:22:59.358461 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m14:22:59.358626 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m14:22:59.358792 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:22:59.358958 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:22:59.359125 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m14:22:59.359340 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m14:22:59.359612 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.359809 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.359993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:22:59.360302 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.360455 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.360641 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m14:22:59.360780 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:22:59.368899 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m14:22:59.369145 [debug] [Thread-8 (]: SQL status: OK in 0.008 seconds
[0m14:22:59.369789 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m14:22:59.370473 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m14:22:59.371014 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m14:22:59.371539 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:22:59.372064 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m14:22:59.372586 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m14:22:59.372759 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:22:59.373273 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m14:22:59.373444 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:22:59.373597 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:22:59.373750 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:22:59.373901 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:22:59.374053 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:22:59.374204 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:22:59.374352 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m14:22:59.374494 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:22:59.374633 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m14:22:59.374789 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m14:22:59.374929 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m14:22:59.375073 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:22:59.375216 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m14:22:59.375359 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m14:22:59.375577 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m14:22:59.375804 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.375957 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.376410 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.376604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.376770 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.377064 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.377213 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.377351 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.379802 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:22:59.381420 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:22:59.382465 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:22:59.383476 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:22:59.384448 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:22:59.385438 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:22:59.386431 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:22:59.387369 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:22:59.387515 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m14:22:59.387662 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m14:22:59.387819 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
drop view if exists "jaffle_shop"."main"."stg_products__dbt_backup" cascade
[0m14:22:59.387968 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m14:22:59.388119 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m14:22:59.388280 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m14:22:59.388439 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m14:22:59.388592 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m14:22:59.388960 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.389109 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.389249 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.389474 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:22:59.389612 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m14:22:59.389749 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m14:22:59.390848 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m14:22:59.390997 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m14:22:59.391137 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:22:59.391641 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m14:22:59.392125 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m14:22:59.392636 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m14:22:59.393183 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m14:22:59.393675 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m14:22:59.394376 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104653c40>]}
[0m14:22:59.394954 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m14:22:59.395462 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m14:22:59.395668 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046528c0>]}
[0m14:22:59.395882 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104653ac0>]}
[0m14:22:59.396105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104653760>]}
[0m14:22:59.396316 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104653be0>]}
[0m14:22:59.396507 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104653eb0>]}
[0m14:22:59.396776 [info ] [Thread-2 (]: 2 of 16 OK created sql view model main.stg_inventory ........................... [[32mOK[0m in 0.14s]
[0m14:22:59.397003 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104653e20>]}
[0m14:22:59.401694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104653730>]}
[0m14:22:59.401976 [info ] [Thread-6 (]: 6 of 16 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.14s]
[0m14:22:59.402259 [info ] [Thread-4 (]: 4 of 16 OK created sql view model main.stg_order_details ....................... [[32mOK[0m in 0.14s]
[0m14:22:59.402514 [info ] [Thread-1 (]: 1 of 16 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.14s]
[0m14:22:59.402773 [info ] [Thread-5 (]: 5 of 16 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.14s]
[0m14:22:59.403029 [info ] [Thread-7 (]: 7 of 16 OK created sql view model main.stg_supplier_products ................... [[32mOK[0m in 0.14s]
[0m14:22:59.403291 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m14:22:59.403518 [info ] [Thread-8 (]: 8 of 16 OK created sql view model main.stg_suppliers ........................... [[32mOK[0m in 0.14s]
[0m14:22:59.403811 [info ] [Thread-3 (]: 3 of 16 OK created sql view model main.stg_inventory_transactions .............. [[32mOK[0m in 0.14s]
[0m14:22:59.404059 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m14:22:59.404292 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m14:22:59.404513 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:22:59.404728 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:22:59.404963 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m14:22:59.405259 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m14:22:59.405481 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m14:22:59.405748 [debug] [Thread-10 ]: Began running node model.jaffle_shop.low_stock
[0m14:22:59.406065 [debug] [Thread-12 ]: Began running node model.jaffle_shop.dim_customers
[0m14:22:59.406219 [debug] [Thread-5 (]: Began running node model.jaffle_shop.dim_products
[0m14:22:59.406517 [debug] [Thread-14 ]: Began running node model.jaffle_shop.fact_sales
[0m14:22:59.406774 [info ] [Thread-10 ]: 9 of 16 START sql table model main.low_stock ................................... [RUN]
[0m14:22:59.407008 [info ] [Thread-12 ]: 10 of 16 START sql table model main.dim_customers .............................. [RUN]
[0m14:22:59.407218 [info ] [Thread-5 (]: 11 of 16 START sql table model main.dim_products ............................... [RUN]
[0m14:22:59.407429 [info ] [Thread-14 ]: 12 of 16 START sql table model main.fact_sales ................................. [RUN]
[0m14:22:59.407685 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.jaffle_shop.low_stock'
[0m14:22:59.407881 [debug] [Thread-12 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m14:22:59.408046 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.dim_products)
[0m14:22:59.408231 [debug] [Thread-14 ]: Acquiring new duckdb connection 'model.jaffle_shop.fact_sales'
[0m14:22:59.408379 [debug] [Thread-10 ]: Began compiling node model.jaffle_shop.low_stock
[0m14:22:59.408523 [debug] [Thread-12 ]: Began compiling node model.jaffle_shop.dim_customers
[0m14:22:59.408662 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.dim_products
[0m14:22:59.408801 [debug] [Thread-14 ]: Began compiling node model.jaffle_shop.fact_sales
[0m14:22:59.410558 [debug] [Thread-10 ]: Writing injected SQL for node "model.jaffle_shop.low_stock"
[0m14:22:59.412377 [debug] [Thread-12 ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m14:22:59.413442 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.dim_products"
[0m14:22:59.414719 [debug] [Thread-14 ]: Writing injected SQL for node "model.jaffle_shop.fact_sales"
[0m14:22:59.415498 [debug] [Thread-10 ]: Began executing node model.jaffle_shop.low_stock
[0m14:22:59.415670 [debug] [Thread-14 ]: Began executing node model.jaffle_shop.fact_sales
[0m14:22:59.415813 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.dim_products
[0m14:22:59.415944 [debug] [Thread-12 ]: Began executing node model.jaffle_shop.dim_customers
[0m14:22:59.424862 [debug] [Thread-10 ]: Writing runtime sql for node "model.jaffle_shop.low_stock"
[0m14:22:59.426620 [debug] [Thread-14 ]: Writing runtime sql for node "model.jaffle_shop.fact_sales"
[0m14:22:59.428148 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.dim_products"
[0m14:22:59.429972 [debug] [Thread-12 ]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m14:22:59.430408 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:22:59.430576 [debug] [Thread-14 ]: On model.jaffle_shop.fact_sales: BEGIN
[0m14:22:59.430759 [debug] [Thread-14 ]: Opening a new connection, currently in state init
[0m14:22:59.430931 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:22:59.431063 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:22:59.433269 [debug] [Thread-14 ]: SQL status: OK in 0.003 seconds
[0m14:22:59.433422 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: BEGIN
[0m14:22:59.433643 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:22:59.433800 [debug] [Thread-10 ]: On model.jaffle_shop.low_stock: BEGIN
[0m14:22:59.433950 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:22:59.434097 [debug] [Thread-12 ]: Opening a new connection, currently in state init
[0m14:22:59.434242 [debug] [Thread-5 (]: On model.jaffle_shop.dim_products: BEGIN
[0m14:22:59.434378 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m14:22:59.434531 [debug] [Thread-14 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fact_sales__dbt_tmp"
  
    as (
      SELECT
  od.order_id,
  o.order_date,
  od.product_id,
  od.quantity,
  od.unit_price,
  od.line_total,
  o.customer_id
FROM "jaffle_shop"."main"."stg_order_details" AS od
JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
    );
  
  
[0m14:22:59.434744 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:22:59.434907 [debug] [Thread-12 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.435095 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.435272 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:22:59.435416 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m14:22:59.435566 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:22:59.435734 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m14:22:59.435897 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:22:59.436087 [debug] [Thread-10 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */

  
    
    

    create  table
      "jaffle_shop"."main"."low_stock__dbt_tmp"
  
    as (
      WITH dim_products AS (
    SELECT
      product_id,
      product_name,
      category,
      price,
      created_at AS product_created_date
    FROM "jaffle_shop"."main"."stg_products"
),

inventory_status AS (
    SELECT
      i.product_id,
      p.product_name,
      i.quantity,
      i.last_updated
    FROM "jaffle_shop"."main"."stg_inventory" AS i
    JOIN "jaffle_shop"."main"."stg_products" AS p ON i.product_id = p.product_id
),

current_inventory AS (
    SELECT
        i.product_id,
        p.product_name,
        p.category,
        i.quantity,
        i.last_updated
    FROM inventory_status AS i
    JOIN dim_products AS p ON i.product_id = p.product_id
),

low_stock_products AS (
    SELECT
        ci.product_id,
        ci.product_name,
        ci.category,
        ci.quantity,
        ci.last_updated
    FROM current_inventory AS ci
    WHERE ci.quantity < 20
)

SELECT * FROM low_stock_products
ORDER BY quantity ASC
    );
  
  
[0m14:22:59.436301 [debug] [Thread-5 (]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_products__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m14:22:59.438492 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m14:22:59.438667 [debug] [Thread-12 ]: SQL status: OK in 0.002 seconds
[0m14:22:59.440026 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:22:59.440198 [debug] [Thread-14 ]: SQL status: OK in 0.005 seconds
[0m14:22:59.440385 [debug] [Thread-10 ]: SQL status: OK in 0.004 seconds
[0m14:22:59.441625 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:22:59.441786 [debug] [Thread-5 (]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m14:22:59.442901 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:22:59.443995 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:22:59.444147 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:22:59.444338 [debug] [Thread-14 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m14:22:59.444507 [debug] [Thread-10 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock" rename to "low_stock__dbt_backup"
[0m14:22:59.444649 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.444874 [debug] [Thread-12 ]: SQL status: OK in 0.000 seconds
[0m14:22:59.445020 [debug] [Thread-14 ]: SQL status: OK in 0.000 seconds
[0m14:22:59.446224 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:22:59.447354 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:22:59.447484 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m14:22:59.449229 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:22:59.449390 [debug] [Thread-5 (]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:22:59.449551 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:22:59.450667 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:22:59.450825 [debug] [Thread-14 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m14:22:59.451025 [debug] [Thread-10 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock__dbt_tmp" rename to "low_stock"
[0m14:22:59.451165 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.451314 [debug] [Thread-12 ]: SQL status: OK in 0.000 seconds
[0m14:22:59.453309 [debug] [Thread-5 (]: On model.jaffle_shop.dim_products: COMMIT
[0m14:22:59.453441 [debug] [Thread-14 ]: SQL status: OK in 0.002 seconds
[0m14:22:59.454014 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m14:22:59.454150 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m14:22:59.454279 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:22:59.454746 [debug] [Thread-14 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m14:22:59.454889 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:22:59.455377 [debug] [Thread-10 ]: On model.jaffle_shop.low_stock: COMMIT
[0m14:22:59.455536 [debug] [Thread-5 (]: On model.jaffle_shop.dim_products: COMMIT
[0m14:22:59.455682 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:22:59.455829 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m14:22:59.455977 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:22:59.456163 [debug] [Thread-14 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m14:22:59.456373 [debug] [Thread-10 ]: On model.jaffle_shop.low_stock: COMMIT
[0m14:22:59.456514 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.456657 [debug] [Thread-12 ]: SQL status: OK in 0.000 seconds
[0m14:22:59.457820 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:22:59.458020 [debug] [Thread-14 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.458159 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.459118 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:22:59.459273 [debug] [Thread-5 (]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
drop table if exists "jaffle_shop"."main"."dim_products__dbt_backup" cascade
[0m14:22:59.460240 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:22:59.461147 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:22:59.461294 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m14:22:59.461468 [debug] [Thread-14 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
drop table if exists "jaffle_shop"."main"."fact_sales__dbt_backup" cascade
[0m14:22:59.461631 [debug] [Thread-10 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
drop table if exists "jaffle_shop"."main"."low_stock__dbt_backup" cascade
[0m14:22:59.461839 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:22:59.462396 [debug] [Thread-5 (]: On model.jaffle_shop.dim_products: Close
[0m14:22:59.462622 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104651f60>]}
[0m14:22:59.462771 [debug] [Thread-12 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.462918 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.463063 [debug] [Thread-14 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.463303 [info ] [Thread-5 (]: 11 of 16 OK created sql table model main.dim_products .......................... [[32mOK[0m in 0.05s]
[0m14:22:59.463806 [debug] [Thread-12 ]: On model.jaffle_shop.dim_customers: Close
[0m14:22:59.464233 [debug] [Thread-10 ]: On model.jaffle_shop.low_stock: Close
[0m14:22:59.464654 [debug] [Thread-14 ]: On model.jaffle_shop.fact_sales: Close
[0m14:22:59.464894 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.dim_products
[0m14:22:59.465112 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104744880>]}
[0m14:22:59.465316 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f6980>]}
[0m14:22:59.469811 [debug] [Thread-14 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047450c0>]}
[0m14:22:59.470196 [debug] [Thread-16 ]: Began running node model.jaffle_shop.top_category
[0m14:22:59.470500 [info ] [Thread-12 ]: 10 of 16 OK created sql table model main.dim_customers ......................... [[32mOK[0m in 0.06s]
[0m14:22:59.470778 [info ] [Thread-10 ]: 9 of 16 OK created sql table model main.low_stock .............................. [[32mOK[0m in 0.06s]
[0m14:22:59.471047 [info ] [Thread-14 ]: 12 of 16 OK created sql table model main.fact_sales ............................ [[32mOK[0m in 0.06s]
[0m14:22:59.471267 [info ] [Thread-16 ]: 13 of 16 START sql table model main.top_category ............................... [RUN]
[0m14:22:59.471515 [debug] [Thread-12 ]: Finished running node model.jaffle_shop.dim_customers
[0m14:22:59.471727 [debug] [Thread-10 ]: Finished running node model.jaffle_shop.low_stock
[0m14:22:59.471939 [debug] [Thread-14 ]: Finished running node model.jaffle_shop.fact_sales
[0m14:22:59.472151 [debug] [Thread-16 ]: Acquiring new duckdb connection 'model.jaffle_shop.top_category'
[0m14:22:59.472414 [debug] [Thread-18 ]: Began running node model.jaffle_shop.avg_order_value
[0m14:22:59.472584 [debug] [Thread-10 ]: Began running node model.jaffle_shop.customer_LTV
[0m14:22:59.472837 [debug] [Thread-16 ]: Began compiling node model.jaffle_shop.top_category
[0m14:22:59.473000 [debug] [Thread-20 ]: Began running node model.jaffle_shop.monthly_sales_growth
[0m14:22:59.473199 [info ] [Thread-18 ]: 14 of 16 START sql table model main.avg_order_value ............................ [RUN]
[0m14:22:59.473424 [info ] [Thread-10 ]: 15 of 16 START sql table model main.customer_LTV ............................... [RUN]
[0m14:22:59.475020 [debug] [Thread-16 ]: Writing injected SQL for node "model.jaffle_shop.top_category"
[0m14:22:59.475231 [info ] [Thread-20 ]: 16 of 16 START sql table model main.monthly_sales_growth ....................... [RUN]
[0m14:22:59.475463 [debug] [Thread-18 ]: Acquiring new duckdb connection 'model.jaffle_shop.avg_order_value'
[0m14:22:59.475635 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.jaffle_shop.low_stock, now model.jaffle_shop.customer_LTV)
[0m14:22:59.475884 [debug] [Thread-20 ]: Acquiring new duckdb connection 'model.jaffle_shop.monthly_sales_growth'
[0m14:22:59.476041 [debug] [Thread-18 ]: Began compiling node model.jaffle_shop.avg_order_value
[0m14:22:59.476201 [debug] [Thread-10 ]: Began compiling node model.jaffle_shop.customer_LTV
[0m14:22:59.476365 [debug] [Thread-20 ]: Began compiling node model.jaffle_shop.monthly_sales_growth
[0m14:22:59.478713 [debug] [Thread-18 ]: Writing injected SQL for node "model.jaffle_shop.avg_order_value"
[0m14:22:59.478881 [debug] [Thread-16 ]: Began executing node model.jaffle_shop.top_category
[0m14:22:59.480347 [debug] [Thread-10 ]: Writing injected SQL for node "model.jaffle_shop.customer_LTV"
[0m14:22:59.481727 [debug] [Thread-20 ]: Writing injected SQL for node "model.jaffle_shop.monthly_sales_growth"
[0m14:22:59.483310 [debug] [Thread-16 ]: Writing runtime sql for node "model.jaffle_shop.top_category"
[0m14:22:59.483543 [debug] [Thread-18 ]: Began executing node model.jaffle_shop.avg_order_value
[0m14:22:59.483769 [debug] [Thread-10 ]: Began executing node model.jaffle_shop.customer_LTV
[0m14:22:59.485214 [debug] [Thread-18 ]: Writing runtime sql for node "model.jaffle_shop.avg_order_value"
[0m14:22:59.486775 [debug] [Thread-10 ]: Writing runtime sql for node "model.jaffle_shop.customer_LTV"
[0m14:22:59.486930 [debug] [Thread-20 ]: Began executing node model.jaffle_shop.monthly_sales_growth
[0m14:22:59.487099 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m14:22:59.488755 [debug] [Thread-20 ]: Writing runtime sql for node "model.jaffle_shop.monthly_sales_growth"
[0m14:22:59.488959 [debug] [Thread-16 ]: On model.jaffle_shop.top_category: BEGIN
[0m14:22:59.489166 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:22:59.489355 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:22:59.489517 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m14:22:59.489675 [debug] [Thread-18 ]: On model.jaffle_shop.avg_order_value: BEGIN
[0m14:22:59.489825 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:22:59.489976 [debug] [Thread-10 ]: On model.jaffle_shop.customer_LTV: BEGIN
[0m14:22:59.492687 [debug] [Thread-18 ]: Opening a new connection, currently in state init
[0m14:22:59.492849 [debug] [Thread-16 ]: SQL status: OK in 0.003 seconds
[0m14:22:59.492986 [debug] [Thread-20 ]: On model.jaffle_shop.monthly_sales_growth: BEGIN
[0m14:22:59.493133 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m14:22:59.493314 [debug] [Thread-16 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m14:22:59.493464 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.493600 [debug] [Thread-20 ]: Opening a new connection, currently in state init
[0m14:22:59.493813 [debug] [Thread-16 ]: On model.jaffle_shop.top_category: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

top_category AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank
    FROM category_sales AS cs
)

SELECT * FROM top_category
    );
  
  
[0m14:22:59.493983 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.494134 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:22:59.494356 [debug] [Thread-20 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.494496 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:22:59.494678 [debug] [Thread-18 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */

  
    
    

    create  table
      "jaffle_shop"."main"."avg_order_value__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_order_totals AS (
    SELECT
        customer_id,
        COUNT(DISTINCT order_id) AS total_orders,
        SUM(line_total) AS total_spent
    FROM fact_sales
    GROUP BY customer_id
    HAVING COUNT(DISTINCT order_id) > 3
),

average_order_value AS (
    SELECT
        cot.customer_id,
        dc.first_name,
        dc.last_name,
        cot.total_orders,
        cot.total_spent,
        ROUND(cot.total_spent / cot.total_orders, 1) AS avg_order_value
    FROM customer_order_totals AS cot
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cot.customer_id = dc.customer_id
)

SELECT * FROM average_order_value
ORDER BY avg_order_value DESC
    );
  
  
[0m14:22:59.494856 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:22:59.495040 [debug] [Thread-10 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */

  
    
    

    create  table
      "jaffle_shop"."main"."customer_LTV__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_revenue AS (
    SELECT
        fs.customer_id,
        SUM(fs.line_total) AS total_revenue,
        MIN(fs.order_date) AS first_purchase_date,
        MAX(fs.order_date) AS last_purchase_date,
        COUNT(DISTINCT fs.order_id) AS total_orders
    FROM fact_sales AS fs
    GROUP BY fs.customer_id
),

customer_ltv AS (
    SELECT
        cr.customer_id,
        dc.first_name,
        dc.last_name,
        cr.total_revenue,
        cr.total_orders,
        DATE_PART('day', cr.last_purchase_date - cr.first_purchase_date) AS customer_lifespan_days,
        ROUND(cr.total_revenue / NULLIF(cr.total_orders, 0), 2) AS avg_order_value,
        ROUND(cr.total_revenue / NULLIF(DATE_PART('day', CURRENT_DATE - cr.first_purchase_date) / 30, 0), 2) AS monthly_ltv
    FROM customer_revenue AS cr
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cr.customer_id = dc.customer_id
)

SELECT * FROM customer_ltv
ORDER BY total_revenue DESC
    );
  
  
[0m14:22:59.495296 [debug] [Thread-20 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */

  
    
    

    create  table
      "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

monthly_sales AS (
    SELECT
        DATE_TRUNC('month', order_date) AS sales_month,
        SUM(line_total) AS total_revenue,
        SUM(quantity) AS total_quantity_sold
    FROM "jaffle_shop"."main"."fact_sales"
    GROUP BY sales_month
),

sales_growth AS (
    SELECT
        ms.sales_month,
        ms.total_revenue,
        ms.total_quantity_sold,
        LAG(ms.total_revenue) OVER (ORDER BY ms.sales_month) AS previous_revenue,
        LAG(ms.total_quantity_sold) OVER (ORDER BY ms.sales_month) AS previous_quantity
    FROM monthly_sales AS ms
),

growth_calculations AS (
    SELECT
        sg.sales_month,
        sg.total_revenue,
        sg.total_quantity_sold,
        ROUND(((sg.total_revenue - sg.previous_revenue) / sg.previous_revenue) * 100, 2) AS revenue_growth_percentage,
        ROUND(((sg.total_quantity_sold - sg.previous_quantity) / sg.previous_quantity) * 100, 2) AS quantity_growth_percentage
    FROM sales_growth AS sg
    WHERE sg.previous_revenue IS NOT NULL
)

SELECT * FROM growth_calculations
ORDER BY sales_month ASC
    );
  
  
[0m14:22:59.497109 [debug] [Thread-16 ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

top_category AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank
    FROM category_sales AS cs
)

SELECT * FROM top_category
    );
  
  
[0m14:22:59.497325 [debug] [Thread-16 ]: DuckDB adapter: Rolling back transaction.
[0m14:22:59.497549 [debug] [Thread-16 ]: On model.jaffle_shop.top_category: ROLLBACK
[0m14:22:59.499422 [debug] [Thread-18 ]: SQL status: OK in 0.004 seconds
[0m14:22:59.501448 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:22:59.501643 [debug] [Thread-18 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value" rename to "avg_order_value__dbt_backup"
[0m14:22:59.501803 [debug] [Thread-20 ]: SQL status: OK in 0.006 seconds
[0m14:22:59.502184 [debug] [Thread-10 ]: SQL status: OK in 0.007 seconds
[0m14:22:59.503548 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:22:59.504682 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:22:59.504931 [debug] [Thread-18 ]: SQL status: OK in 0.003 seconds
[0m14:22:59.505119 [debug] [Thread-20 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth" rename to "monthly_sales_growth__dbt_backup"
[0m14:22:59.505294 [debug] [Thread-10 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV" rename to "customer_LTV__dbt_backup"
[0m14:22:59.506517 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:22:59.506803 [debug] [Thread-20 ]: SQL status: OK in 0.000 seconds
[0m14:22:59.507024 [debug] [Thread-18 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value__dbt_tmp" rename to "avg_order_value"
[0m14:22:59.507236 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m14:22:59.508642 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:22:59.509979 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:22:59.510161 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.510306 [debug] [Thread-20 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp" rename to "monthly_sales_growth"
[0m14:22:59.510512 [debug] [Thread-10 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV__dbt_tmp" rename to "customer_LTV"
[0m14:22:59.511141 [debug] [Thread-18 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m14:22:59.511386 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:22:59.511554 [debug] [Thread-20 ]: SQL status: OK in 0.000 seconds
[0m14:22:59.511707 [debug] [Thread-18 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m14:22:59.511863 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.512449 [debug] [Thread-20 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m14:22:59.513110 [debug] [Thread-10 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m14:22:59.513306 [debug] [Thread-18 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.513449 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:22:59.513631 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:22:59.514639 [debug] [Thread-18 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:22:59.514859 [debug] [Thread-20 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m14:22:59.515014 [debug] [Thread-10 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m14:22:59.515177 [debug] [Thread-18 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
drop table if exists "jaffle_shop"."main"."avg_order_value__dbt_backup" cascade
[0m14:22:59.515493 [debug] [Thread-20 ]: SQL status: OK in 0.000 seconds
[0m14:22:59.517076 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:22:59.517222 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m14:22:59.517387 [debug] [Thread-20 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
drop table if exists "jaffle_shop"."main"."monthly_sales_growth__dbt_backup" cascade
[0m14:22:59.517536 [debug] [Thread-18 ]: SQL status: OK in 0.002 seconds
[0m14:22:59.518587 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:22:59.519261 [debug] [Thread-18 ]: On model.jaffle_shop.avg_order_value: Close
[0m14:22:59.519965 [debug] [Thread-16 ]: Failed to rollback 'model.jaffle_shop.top_category'
[0m14:22:59.520116 [debug] [Thread-10 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
drop table if exists "jaffle_shop"."main"."customer_LTV__dbt_backup" cascade
[0m14:22:59.520267 [debug] [Thread-20 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.520534 [debug] [Thread-18 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d19f30>]}
[0m14:22:59.520700 [debug] [Thread-16 ]: On model.jaffle_shop.top_category: Close
[0m14:22:59.521261 [debug] [Thread-20 ]: On model.jaffle_shop.monthly_sales_growth: Close
[0m14:22:59.521565 [info ] [Thread-18 ]: 14 of 16 OK created sql table model main.avg_order_value ....................... [[32mOK[0m in 0.05s]
[0m14:22:59.521736 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m14:22:59.522090 [debug] [Thread-20 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104744940>]}
[0m14:22:59.522378 [debug] [Thread-18 ]: Finished running node model.jaffle_shop.avg_order_value
[0m14:22:59.522931 [debug] [Thread-10 ]: On model.jaffle_shop.customer_LTV: Close
[0m14:22:59.523323 [debug] [Thread-16 ]: Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
          od.order_id,
          o.order_date,
          od.product_id,
          od.quantity,
          od.unit_price,
          od.line_total,
          o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m14:22:59.523579 [info ] [Thread-20 ]: 16 of 16 OK created sql table model main.monthly_sales_growth .................. [[32mOK[0m in 0.05s]
[0m14:22:59.526612 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104652290>]}
[0m14:22:59.526814 [debug] [Thread-16 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c3cf9ee-2e11-4a34-86e7-4645614905ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d90fd0>]}
[0m14:22:59.527055 [debug] [Thread-20 ]: Finished running node model.jaffle_shop.monthly_sales_growth
[0m14:22:59.527308 [info ] [Thread-10 ]: 15 of 16 OK created sql table model main.customer_LTV .......................... [[32mOK[0m in 0.05s]
[0m14:22:59.527593 [error] [Thread-16 ]: 13 of 16 ERROR creating sql table model main.top_category ...................... [[31mERROR[0m in 0.05s]
[0m14:22:59.527939 [debug] [Thread-10 ]: Finished running node model.jaffle_shop.customer_LTV
[0m14:22:59.528210 [debug] [Thread-16 ]: Finished running node model.jaffle_shop.top_category
[0m14:22:59.529075 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:59.529217 [debug] [MainThread]: On master: BEGIN
[0m14:22:59.529334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:59.531469 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:22:59.531607 [debug] [MainThread]: On master: COMMIT
[0m14:22:59.531730 [debug] [MainThread]: Using duckdb connection "master"
[0m14:22:59.531845 [debug] [MainThread]: On master: COMMIT
[0m14:22:59.531980 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:22:59.532104 [debug] [MainThread]: On master: Close
[0m14:22:59.532561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:59.532685 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m14:22:59.532809 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m14:22:59.532923 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m14:22:59.533034 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m14:22:59.533138 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_products' was properly closed.
[0m14:22:59.533242 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m14:22:59.533336 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m14:22:59.533439 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m14:22:59.533539 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_LTV' was properly closed.
[0m14:22:59.533643 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m14:22:59.533750 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_sales' was properly closed.
[0m14:22:59.533845 [debug] [MainThread]: Connection 'model.jaffle_shop.top_category' was properly closed.
[0m14:22:59.533940 [debug] [MainThread]: Connection 'model.jaffle_shop.avg_order_value' was properly closed.
[0m14:22:59.534034 [debug] [MainThread]: Connection 'model.jaffle_shop.monthly_sales_growth' was properly closed.
[0m14:22:59.534217 [info ] [MainThread]: 
[0m14:22:59.534363 [info ] [MainThread]: Finished running 8 view models, 8 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m14:22:59.535447 [debug] [MainThread]: Command end result
[0m14:22:59.554430 [info ] [MainThread]: 
[0m14:22:59.554657 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:22:59.554794 [info ] [MainThread]: 
[0m14:22:59.554986 [error] [MainThread]:   Runtime Error in model top_category (models/top_category.sql)
  Binder Error: Table "dp" does not have a column named "product_id"
  LINE 29: ...: "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
  
    
      
      
  
      create  table
        "jaffle_shop"."main"."top_category__dbt_tmp"
    
      as (
        WITH fact_sales AS (
      SELECT
          od.order_id,
          o.order_date,
          od.product_id,
          od.quantity,
          od.unit_price,
          od.line_total,
          o.customer_id
      FROM "jaffle_shop"."main"."stg_order_details" AS od
      JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
  ),
  
  category_sales AS (
      SELECT
          dp.category,
          SUM(fs.line_total) AS total_category_sales
      FROM fact_sales AS fs
      JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
                                                     ^
[0m14:22:59.555158 [info ] [MainThread]: 
[0m14:22:59.555294 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m14:22:59.556804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.74491864, "process_user_time": 1.053364, "process_kernel_time": 0.155866, "process_mem_max_rss": "171147264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:22:59.557041 [debug] [MainThread]: Command `dbt run` failed at 14:22:59.557005 after 0.75 seconds
[0m14:22:59.557206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102462980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8beb0>]}
[0m14:22:59.557355 [debug] [MainThread]: Flushing usage events
[0m14:25:13.860423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105182920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d77f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d77880>]}


============================== 14:25:13.869352 | c5d7ad94-55ed-4694-babc-c1166ad21b8f ==============================
[0m14:25:13.869352 [info ] [MainThread]: Running with dbt=1.8.1
[0m14:25:13.869633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/bunjee/Desktop/assignment4_db', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/bunjee/Desktop/assignment4_db/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:14.003652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e872e0>]}
[0m14:25:14.023705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e442e0>]}
[0m14:25:14.024283 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:25:14.032684 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m14:25:14.108238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:14.108607 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/dim_products.sql
[0m14:25:14.213972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073bbeb0>]}
[0m14:25:14.269396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107399360>]}
[0m14:25:14.269665 [info ] [MainThread]: Found 8 seeds, 16 models, 5 data tests, 423 macros
[0m14:25:14.269816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107399390>]}
[0m14:25:14.270736 [info ] [MainThread]: 
[0m14:25:14.270970 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:25:14.273464 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m14:25:14.297509 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m14:25:14.297704 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"jaffle_shop"'
    
  
  
[0m14:25:14.297828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:14.306593 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:25:14.307143 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:25:14.308212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m14:25:14.308451 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m14:25:14.311354 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:25:14.311493 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where database_name='jaffle_shop'
        and type='sqlite'
    
  
[0m14:25:14.311609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:14.313865 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:25:14.314375 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:25:14.314486 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m14:25:14.314615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:25:14.314727 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:25:14.314845 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m14:25:14.315038 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:25:14.315345 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m14:25:14.315457 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:25:14.315559 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m14:25:14.315687 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:25:14.315806 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m14:25:14.317239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_jaffle_shop_main, now list_jaffle_shop_main)
[0m14:25:14.319614 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m14:25:14.319746 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m14:25:14.319856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:14.321878 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:25:14.322005 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m14:25:14.322122 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'jaffle_shop'
  
[0m14:25:14.330932 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:25:14.333047 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m14:25:14.333559 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m14:25:14.333713 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m14:25:14.335478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2bac0>]}
[0m14:25:14.335744 [debug] [MainThread]: Using duckdb connection "master"
[0m14:25:14.335865 [debug] [MainThread]: On master: BEGIN
[0m14:25:14.335966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:14.337966 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:25:14.338099 [debug] [MainThread]: On master: COMMIT
[0m14:25:14.338225 [debug] [MainThread]: Using duckdb connection "master"
[0m14:25:14.338340 [debug] [MainThread]: On master: COMMIT
[0m14:25:14.338474 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:25:14.338589 [debug] [MainThread]: On master: Close
[0m14:25:14.339045 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m14:25:14.339206 [info ] [MainThread]: 
[0m14:25:14.340930 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:25:14.341094 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_inventory
[0m14:25:14.341265 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_inventory_transactions
[0m14:25:14.341436 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_details
[0m14:25:14.341583 [debug] [Thread-5 (]: Began running node model.jaffle_shop.stg_orders
[0m14:25:14.341921 [debug] [Thread-6 (]: Began running node model.jaffle_shop.stg_products
[0m14:25:14.341793 [info ] [Thread-1 (]: 1 of 16 START sql view model main.stg_customers ................................ [RUN]
[0m14:25:14.342095 [debug] [Thread-7 (]: Began running node model.jaffle_shop.stg_supplier_products
[0m14:25:14.342270 [debug] [Thread-8 (]: Began running node model.jaffle_shop.stg_suppliers
[0m14:25:14.342452 [info ] [Thread-2 (]: 2 of 16 START sql view model main.stg_inventory ................................ [RUN]
[0m14:25:14.342675 [info ] [Thread-3 (]: 3 of 16 START sql view model main.stg_inventory_transactions ................... [RUN]
[0m14:25:14.342897 [info ] [Thread-4 (]: 4 of 16 START sql view model main.stg_order_details ............................ [RUN]
[0m14:25:14.343100 [info ] [Thread-5 (]: 5 of 16 START sql view model main.stg_orders ................................... [RUN]
[0m14:25:14.343302 [info ] [Thread-6 (]: 6 of 16 START sql view model main.stg_products ................................. [RUN]
[0m14:25:14.343514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_jaffle_shop_main, now model.jaffle_shop.stg_customers)
[0m14:25:14.343712 [info ] [Thread-7 (]: 7 of 16 START sql view model main.stg_supplier_products ........................ [RUN]
[0m14:25:14.343914 [info ] [Thread-8 (]: 8 of 16 START sql view model main.stg_suppliers ................................ [RUN]
[0m14:25:14.344133 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory'
[0m14:25:14.344336 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_inventory_transactions'
[0m14:25:14.344530 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_order_details'
[0m14:25:14.344717 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m14:25:14.344891 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_products'
[0m14:25:14.345034 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:25:14.345226 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_supplier_products'
[0m14:25:14.345410 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_suppliers'
[0m14:25:14.345555 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_inventory
[0m14:25:14.345702 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_inventory_transactions
[0m14:25:14.345844 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_details
[0m14:25:14.345981 [debug] [Thread-5 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:25:14.346118 [debug] [Thread-6 (]: Began compiling node model.jaffle_shop.stg_products
[0m14:25:14.351375 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:25:14.351556 [debug] [Thread-7 (]: Began compiling node model.jaffle_shop.stg_supplier_products
[0m14:25:14.351690 [debug] [Thread-8 (]: Began compiling node model.jaffle_shop.stg_suppliers
[0m14:25:14.372371 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory"
[0m14:25:14.373475 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_inventory_transactions"
[0m14:25:14.374527 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_details"
[0m14:25:14.375872 [debug] [Thread-5 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:25:14.377284 [debug] [Thread-6 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m14:25:14.378462 [debug] [Thread-7 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplier_products"
[0m14:25:14.379568 [debug] [Thread-8 (]: Writing injected SQL for node "model.jaffle_shop.stg_suppliers"
[0m14:25:14.379827 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:25:14.380100 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_inventory_transactions
[0m14:25:14.380371 [debug] [Thread-5 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:25:14.380525 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_details
[0m14:25:14.380682 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_inventory
[0m14:25:14.380881 [debug] [Thread-6 (]: Began executing node model.jaffle_shop.stg_products
[0m14:25:14.394527 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:25:14.396077 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory_transactions"
[0m14:25:14.397569 [debug] [Thread-5 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:25:14.397702 [debug] [Thread-8 (]: Began executing node model.jaffle_shop.stg_suppliers
[0m14:25:14.397846 [debug] [Thread-7 (]: Began executing node model.jaffle_shop.stg_supplier_products
[0m14:25:14.399292 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_details"
[0m14:25:14.400658 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_inventory"
[0m14:25:14.402295 [debug] [Thread-6 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m14:25:14.403961 [debug] [Thread-8 (]: Writing runtime sql for node "model.jaffle_shop.stg_suppliers"
[0m14:25:14.404136 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:25:14.405607 [debug] [Thread-7 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplier_products"
[0m14:25:14.405763 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:25:14.405918 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:25:14.406235 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m14:25:14.406556 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:25:14.406727 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:25:14.406871 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m14:25:14.407035 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:25:14.407212 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:25:14.407358 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:25:14.407497 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: BEGIN
[0m14:25:14.407656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:14.407812 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: BEGIN
[0m14:25:14.407961 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: BEGIN
[0m14:25:14.408115 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m14:25:14.408271 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: BEGIN
[0m14:25:14.408417 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: BEGIN
[0m14:25:14.408560 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: BEGIN
[0m14:25:14.408710 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:14.410966 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:25:14.411117 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:25:14.411284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:14.411479 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:14.411627 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m14:25:14.411783 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m14:25:14.411925 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m14:25:14.412135 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:25:14.412288 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:25:14.412424 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.412646 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.412792 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.412938 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:25:14.413152 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.413312 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:25:14.413452 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m14:25:14.413625 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    SELECT
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(first_name), 1, 1)), LOWER(SUBSTRING(TRIM(first_name), 2)))
 AS first_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(last_name), 1, 1)), LOWER(SUBSTRING(TRIM(last_name), 2)))
 AS last_name,
  LOWER(TRIM(email)) AS email,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_customers"
  );

[0m14:25:14.413785 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:25:14.413940 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:25:14.414094 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:25:14.414251 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    SELECT
  
  TRY_CAST(order_id AS INTEGER)
 AS order_id,
  
  TRY_CAST(customer_id AS INTEGER)
 AS customer_id,
  
  TRY_CAST(order_date AS TIMESTAMP)
 AS order_date,
  
  TRY_CAST(total_amount AS DECIMAL(10,2))
 AS total_amount
FROM "jaffle_shop"."main"."raw_orders"
  );

[0m14:25:14.414416 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:25:14.414585 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */

  
  create view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" as (
    SELECT
  CAST(transaction_id AS INTEGER) AS transaction_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity_change AS INTEGER) AS quantity_change,
  CAST(transaction_date AS TIMESTAMP) AS transaction_date,
  CONCAT(UPPER(SUBSTRING(TRIM(reason), 1, 1)), LOWER(SUBSTRING(TRIM(reason), 2))) AS reason
FROM "jaffle_shop"."main"."raw_inventory_transactions"
  );

[0m14:25:14.414743 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:25:14.414939 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */

  
  create view "jaffle_shop"."main"."stg_products__dbt_tmp" as (
    SELECT
  
  TRY_CAST(product_id AS INTEGER)
 AS product_id,
  
CONCAT(UPPER(SUBSTRING(TRIM(product_name), 1, 1)), LOWER(SUBSTRING(TRIM(product_name), 2)))
 AS product_name,
  
CONCAT(UPPER(SUBSTRING(TRIM(category), 1, 1)), LOWER(SUBSTRING(TRIM(category), 2)))
 AS category,
  
  TRY_CAST(price AS DECIMAL(10,2))
 AS price,
  
  TRY_CAST(created_at AS TIMESTAMP)
 AS created_at
FROM "jaffle_shop"."main"."raw_products"
  );

[0m14:25:14.415126 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */

  
  create view "jaffle_shop"."main"."stg_inventory__dbt_tmp" as (
    SELECT
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(last_updated AS TIMESTAMP) AS last_updated
FROM "jaffle_shop"."main"."raw_inventory"
  );

[0m14:25:14.415285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.415451 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */

  
  create view "jaffle_shop"."main"."stg_order_details__dbt_tmp" as (
    SELECT
  CAST(order_id AS INTEGER) AS order_id,
  CAST(product_id AS INTEGER) AS product_id,
  CAST(quantity AS INTEGER) AS quantity,
  CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
  CAST(line_total AS DECIMAL(10,2)) AS line_total
FROM "jaffle_shop"."main"."raw_order_details"
  );

[0m14:25:14.415666 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */

  
  create view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CAST(product_id AS INTEGER) AS product_id
FROM "jaffle_shop"."main"."raw_supplier_products"
  );

[0m14:25:14.415857 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.416017 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */

  
  create view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" as (
    SELECT
  CAST(supplier_id AS INTEGER) AS supplier_id,
  CONCAT(UPPER(SUBSTRING(TRIM(supplier_name), 1, 1)), LOWER(SUBSTRING(TRIM(supplier_name), 2))) AS supplier_name,
  LOWER(TRIM(contact_email)) AS contact_email,
  TRIM(phone_number) AS phone_number
FROM "jaffle_shop"."main"."raw_suppliers"
  );

[0m14:25:14.416176 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.418954 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:25:14.419137 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:25:14.419284 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m14:25:14.419430 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.420694 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:25:14.422074 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:25:14.422209 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m14:25:14.422376 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:25:14.423581 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:25:14.423716 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m14:25:14.425201 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:25:14.426305 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:25:14.426446 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:25:14.426588 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions" rename to "stg_inventory_transactions__dbt_backup"
[0m14:25:14.427691 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:25:14.427876 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m14:25:14.429161 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:25:14.429323 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m14:25:14.429445 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:25:14.429581 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m14:25:14.429797 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products" rename to "stg_supplier_products__dbt_backup"
[0m14:25:14.429945 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.430111 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.430295 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m14:25:14.430438 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.431615 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:25:14.431763 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.431954 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.433156 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:25:14.433282 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.434446 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:25:14.435880 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:25:14.436044 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:25:14.436187 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m14:25:14.437317 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:25:14.438425 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:25:14.438564 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:25:14.439621 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:25:14.439765 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
alter view "jaffle_shop"."main"."stg_inventory_transactions__dbt_tmp" rename to "stg_inventory_transactions"
[0m14:25:14.439902 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
alter view "jaffle_shop"."main"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m14:25:14.440963 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:25:14.441115 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
alter view "jaffle_shop"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:25:14.441259 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.441391 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
alter view "jaffle_shop"."main"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m14:25:14.441564 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
alter view "jaffle_shop"."main"."stg_supplier_products__dbt_tmp" rename to "stg_supplier_products"
[0m14:25:14.441726 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.441904 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
alter view "jaffle_shop"."main"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m14:25:14.442041 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.442187 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.448608 [debug] [Thread-6 (]: SQL status: OK in 0.006 seconds
[0m14:25:14.448783 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m14:25:14.449335 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:25:14.449488 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.449643 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.450121 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m14:25:14.450640 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m14:25:14.450759 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.451194 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m14:25:14.451330 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:25:14.451458 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:25:14.451897 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m14:25:14.452350 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m14:25:14.452506 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:25:14.452635 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:25:14.453061 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m14:25:14.453195 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:25:14.453323 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m14:25:14.453447 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:25:14.453573 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:25:14.453699 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:25:14.453826 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: COMMIT
[0m14:25:14.453951 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: COMMIT
[0m14:25:14.454073 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:25:14.454205 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: COMMIT
[0m14:25:14.454419 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: COMMIT
[0m14:25:14.454568 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.454730 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.454857 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: COMMIT
[0m14:25:14.455065 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: COMMIT
[0m14:25:14.455218 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.455386 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.457476 [debug] [Thread-5 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:25:14.457616 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:25:14.457761 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m14:25:14.459192 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:25:14.460188 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_inventory_transactions"
[0m14:25:14.460325 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.460467 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.461455 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_inventory"
[0m14:25:14.461617 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m14:25:14.462508 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.stg_order_details"
[0m14:25:14.463386 [debug] [Thread-6 (]: Using duckdb connection "model.jaffle_shop.stg_products"
[0m14:25:14.463535 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m14:25:14.463692 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory_transactions"} */
drop view if exists "jaffle_shop"."main"."stg_inventory_transactions__dbt_backup" cascade
[0m14:25:14.464675 [debug] [Thread-7 (]: Using duckdb connection "model.jaffle_shop.stg_supplier_products"
[0m14:25:14.465597 [debug] [Thread-8 (]: Using duckdb connection "model.jaffle_shop.stg_suppliers"
[0m14:25:14.465746 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_inventory"} */
drop view if exists "jaffle_shop"."main"."stg_inventory__dbt_backup" cascade
[0m14:25:14.465924 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_details"} */
drop view if exists "jaffle_shop"."main"."stg_order_details__dbt_backup" cascade
[0m14:25:14.466091 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */
drop view if exists "jaffle_shop"."main"."stg_products__dbt_backup" cascade
[0m14:25:14.466289 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplier_products"} */
drop view if exists "jaffle_shop"."main"."stg_supplier_products__dbt_backup" cascade
[0m14:25:14.466436 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.466591 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_suppliers"} */
drop view if exists "jaffle_shop"."main"."stg_suppliers__dbt_backup" cascade
[0m14:25:14.466762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.466901 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.467084 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.467228 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:25:14.468233 [debug] [Thread-5 (]: On model.jaffle_shop.stg_orders: Close
[0m14:25:14.468376 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.468529 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.469033 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m14:25:14.469546 [debug] [Thread-3 (]: On model.jaffle_shop.stg_inventory_transactions: Close
[0m14:25:14.469707 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m14:25:14.470192 [debug] [Thread-2 (]: On model.jaffle_shop.stg_inventory: Close
[0m14:25:14.470663 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_details: Close
[0m14:25:14.471329 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b91780>]}
[0m14:25:14.471860 [debug] [Thread-6 (]: On model.jaffle_shop.stg_products: Close
[0m14:25:14.472305 [debug] [Thread-7 (]: On model.jaffle_shop.stg_supplier_products: Close
[0m14:25:14.472498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b91090>]}
[0m14:25:14.472706 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b91270>]}
[0m14:25:14.473195 [debug] [Thread-8 (]: On model.jaffle_shop.stg_suppliers: Close
[0m14:25:14.473377 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b917e0>]}
[0m14:25:14.473581 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b91660>]}
[0m14:25:14.473857 [info ] [Thread-5 (]: 5 of 16 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.13s]
[0m14:25:14.474094 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b90460>]}
[0m14:25:14.474294 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b91a50>]}
[0m14:25:14.474533 [info ] [Thread-1 (]: 1 of 16 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.13s]
[0m14:25:14.474797 [info ] [Thread-3 (]: 3 of 16 OK created sql view model main.stg_inventory_transactions .............. [[32mOK[0m in 0.13s]
[0m14:25:14.477747 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b919c0>]}
[0m14:25:14.477982 [info ] [Thread-2 (]: 2 of 16 OK created sql view model main.stg_inventory ........................... [[32mOK[0m in 0.13s]
[0m14:25:14.478246 [info ] [Thread-4 (]: 4 of 16 OK created sql view model main.stg_order_details ....................... [[32mOK[0m in 0.13s]
[0m14:25:14.478501 [debug] [Thread-5 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:25:14.478748 [info ] [Thread-6 (]: 6 of 16 OK created sql view model main.stg_products ............................ [[32mOK[0m in 0.13s]
[0m14:25:14.478986 [info ] [Thread-7 (]: 7 of 16 OK created sql view model main.stg_supplier_products ................... [[32mOK[0m in 0.13s]
[0m14:25:14.479223 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:25:14.479444 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_inventory_transactions
[0m14:25:14.479664 [info ] [Thread-8 (]: 8 of 16 OK created sql view model main.stg_suppliers ........................... [[32mOK[0m in 0.13s]
[0m14:25:14.479900 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_inventory
[0m14:25:14.480119 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_details
[0m14:25:14.481244 [debug] [Thread-6 (]: Finished running node model.jaffle_shop.stg_products
[0m14:25:14.481459 [debug] [Thread-7 (]: Finished running node model.jaffle_shop.stg_supplier_products
[0m14:25:14.481772 [debug] [Thread-10 ]: Began running node model.jaffle_shop.dim_customers
[0m14:25:14.482007 [debug] [Thread-8 (]: Finished running node model.jaffle_shop.stg_suppliers
[0m14:25:14.482355 [debug] [Thread-12 ]: Began running node model.jaffle_shop.fact_sales
[0m14:25:14.482544 [debug] [Thread-14 ]: Began running node model.jaffle_shop.dim_products
[0m14:25:14.482692 [debug] [Thread-15 ]: Began running node model.jaffle_shop.low_stock
[0m14:25:14.482887 [info ] [Thread-10 ]: 9 of 16 START sql table model main.dim_customers ............................... [RUN]
[0m14:25:14.483146 [info ] [Thread-12 ]: 10 of 16 START sql table model main.fact_sales ................................. [RUN]
[0m14:25:14.483362 [info ] [Thread-14 ]: 11 of 16 START sql table model main.dim_products ............................... [RUN]
[0m14:25:14.483567 [info ] [Thread-15 ]: 12 of 16 START sql table model main.low_stock .................................. [RUN]
[0m14:25:14.483791 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m14:25:14.483986 [debug] [Thread-12 ]: Acquiring new duckdb connection 'model.jaffle_shop.fact_sales'
[0m14:25:14.484175 [debug] [Thread-14 ]: Acquiring new duckdb connection 'model.jaffle_shop.dim_products'
[0m14:25:14.484359 [debug] [Thread-15 ]: Acquiring new duckdb connection 'model.jaffle_shop.low_stock'
[0m14:25:14.484503 [debug] [Thread-10 ]: Began compiling node model.jaffle_shop.dim_customers
[0m14:25:14.484648 [debug] [Thread-12 ]: Began compiling node model.jaffle_shop.fact_sales
[0m14:25:14.484787 [debug] [Thread-14 ]: Began compiling node model.jaffle_shop.dim_products
[0m14:25:14.484924 [debug] [Thread-15 ]: Began compiling node model.jaffle_shop.low_stock
[0m14:25:14.486282 [debug] [Thread-10 ]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m14:25:14.488189 [debug] [Thread-12 ]: Writing injected SQL for node "model.jaffle_shop.fact_sales"
[0m14:25:14.489220 [debug] [Thread-14 ]: Writing injected SQL for node "model.jaffle_shop.dim_products"
[0m14:25:14.490546 [debug] [Thread-15 ]: Writing injected SQL for node "model.jaffle_shop.low_stock"
[0m14:25:14.491175 [debug] [Thread-14 ]: Began executing node model.jaffle_shop.dim_products
[0m14:25:14.491325 [debug] [Thread-15 ]: Began executing node model.jaffle_shop.low_stock
[0m14:25:14.491464 [debug] [Thread-12 ]: Began executing node model.jaffle_shop.fact_sales
[0m14:25:14.497487 [debug] [Thread-10 ]: Began executing node model.jaffle_shop.dim_customers
[0m14:25:14.500548 [debug] [Thread-14 ]: Writing runtime sql for node "model.jaffle_shop.dim_products"
[0m14:25:14.502128 [debug] [Thread-15 ]: Writing runtime sql for node "model.jaffle_shop.low_stock"
[0m14:25:14.503574 [debug] [Thread-12 ]: Writing runtime sql for node "model.jaffle_shop.fact_sales"
[0m14:25:14.505444 [debug] [Thread-10 ]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m14:25:14.506346 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:25:14.506494 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:25:14.506627 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:25:14.506753 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:25:14.506888 [debug] [Thread-12 ]: On model.jaffle_shop.fact_sales: BEGIN
[0m14:25:14.507020 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: BEGIN
[0m14:25:14.507201 [debug] [Thread-14 ]: On model.jaffle_shop.dim_products: BEGIN
[0m14:25:14.507332 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: BEGIN
[0m14:25:14.507460 [debug] [Thread-12 ]: Opening a new connection, currently in state init
[0m14:25:14.507601 [debug] [Thread-15 ]: Opening a new connection, currently in state init
[0m14:25:14.507728 [debug] [Thread-14 ]: Opening a new connection, currently in state init
[0m14:25:14.507851 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m14:25:14.510002 [debug] [Thread-12 ]: SQL status: OK in 0.003 seconds
[0m14:25:14.510235 [debug] [Thread-15 ]: SQL status: OK in 0.003 seconds
[0m14:25:14.510391 [debug] [Thread-14 ]: SQL status: OK in 0.003 seconds
[0m14:25:14.510538 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:25:14.510686 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m14:25:14.510836 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:25:14.510988 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:25:14.511152 [debug] [Thread-12 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fact_sales__dbt_tmp"
  
    as (
      SELECT
  od.order_id,
  o.order_date,
  od.product_id,
  od.quantity,
  od.unit_price,
  od.line_total,
  o.customer_id
FROM "jaffle_shop"."main"."stg_order_details" AS od
JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
    );
  
  
[0m14:25:14.511323 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:25:14.511501 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */

  
    
    

    create  table
      "jaffle_shop"."main"."low_stock__dbt_tmp"
  
    as (
      WITH dim_products AS (
    SELECT
      product_id,
      product_name,
      category,
      price,
      created_at AS product_created_date
    FROM "jaffle_shop"."main"."stg_products"
),

inventory_status AS (
    SELECT
      i.product_id,
      p.product_name,
      i.quantity,
      i.last_updated
    FROM "jaffle_shop"."main"."stg_inventory" AS i
    JOIN "jaffle_shop"."main"."stg_products" AS p ON i.product_id = p.product_id
),

current_inventory AS (
    SELECT
        i.product_id,
        p.product_name,
        p.category,
        i.quantity,
        i.last_updated
    FROM inventory_status AS i
    JOIN dim_products AS p ON i.product_id = p.product_id
),

low_stock_products AS (
    SELECT
        ci.product_id,
        ci.product_name,
        ci.category,
        ci.quantity,
        ci.last_updated
    FROM current_inventory AS ci
    WHERE ci.quantity < 20
)

SELECT * FROM low_stock_products
ORDER BY quantity ASC
    );
  
  
[0m14:25:14.511687 [debug] [Thread-14 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_products__dbt_tmp"
  
    as (
      SELECT
  product_id,
  product_name,
  category,
  price,
  created_at AS product_created_date
FROM "jaffle_shop"."main"."stg_products"
    );
  
  
[0m14:25:14.511871 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      SELECT
  customer_id,
  first_name,
  last_name,
  email,
  created_at AS customer_created_date
FROM "jaffle_shop"."main"."stg_customers"
    );
  
  
[0m14:25:14.513895 [debug] [Thread-14 ]: SQL status: OK in 0.002 seconds
[0m14:25:14.515190 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:25:14.515361 [debug] [Thread-14 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m14:25:14.515539 [debug] [Thread-12 ]: SQL status: OK in 0.004 seconds
[0m14:25:14.515694 [debug] [Thread-10 ]: SQL status: OK in 0.004 seconds
[0m14:25:14.515875 [debug] [Thread-15 ]: SQL status: OK in 0.004 seconds
[0m14:25:14.517048 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:25:14.518181 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:25:14.519260 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:25:14.519380 [debug] [Thread-14 ]: SQL status: OK in 0.003 seconds
[0m14:25:14.519517 [debug] [Thread-12 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m14:25:14.519662 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:25:14.519797 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock" rename to "low_stock__dbt_backup"
[0m14:25:14.520863 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:25:14.521067 [debug] [Thread-12 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.521230 [debug] [Thread-14 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
alter table "jaffle_shop"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:25:14.521371 [debug] [Thread-15 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.521512 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.522600 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:25:14.524260 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:25:14.525397 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:25:14.525515 [debug] [Thread-14 ]: SQL status: OK in 0.003 seconds
[0m14:25:14.525648 [debug] [Thread-12 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
alter table "jaffle_shop"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m14:25:14.525783 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
alter table "jaffle_shop"."main"."low_stock__dbt_tmp" rename to "low_stock"
[0m14:25:14.525917 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:25:14.527829 [debug] [Thread-14 ]: On model.jaffle_shop.dim_products: COMMIT
[0m14:25:14.528491 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:25:14.528662 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.528805 [debug] [Thread-12 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.528942 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.529076 [debug] [Thread-14 ]: On model.jaffle_shop.dim_products: COMMIT
[0m14:25:14.529682 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m14:25:14.530212 [debug] [Thread-12 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m14:25:14.530757 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: COMMIT
[0m14:25:14.530963 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:25:14.531477 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:25:14.531644 [debug] [Thread-14 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.531783 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:25:14.531915 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: COMMIT
[0m14:25:14.532041 [debug] [Thread-12 ]: On model.jaffle_shop.fact_sales: COMMIT
[0m14:25:14.532977 [debug] [Thread-14 ]: Using duckdb connection "model.jaffle_shop.dim_products"
[0m14:25:14.533117 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: COMMIT
[0m14:25:14.533334 [debug] [Thread-14 ]: On model.jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_products"} */
drop table if exists "jaffle_shop"."main"."dim_products__dbt_backup" cascade
[0m14:25:14.533488 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.533622 [debug] [Thread-12 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.534651 [debug] [Thread-10 ]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:25:14.534801 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.535830 [debug] [Thread-12 ]: Using duckdb connection "model.jaffle_shop.fact_sales"
[0m14:25:14.535962 [debug] [Thread-14 ]: SQL status: OK in 0.002 seconds
[0m14:25:14.536114 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m14:25:14.537049 [debug] [Thread-15 ]: Using duckdb connection "model.jaffle_shop.low_stock"
[0m14:25:14.537202 [debug] [Thread-12 ]: On model.jaffle_shop.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fact_sales"} */
drop table if exists "jaffle_shop"."main"."fact_sales__dbt_backup" cascade
[0m14:25:14.537738 [debug] [Thread-14 ]: On model.jaffle_shop.dim_products: Close
[0m14:25:14.537914 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.low_stock"} */
drop table if exists "jaffle_shop"."main"."low_stock__dbt_backup" cascade
[0m14:25:14.538179 [debug] [Thread-14 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab3b50>]}
[0m14:25:14.538324 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.538630 [info ] [Thread-14 ]: 11 of 16 OK created sql table model main.dim_products .......................... [[32mOK[0m in 0.05s]
[0m14:25:14.538807 [debug] [Thread-12 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.539284 [debug] [Thread-10 ]: On model.jaffle_shop.dim_customers: Close
[0m14:25:14.539429 [debug] [Thread-15 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.539656 [debug] [Thread-14 ]: Finished running node model.jaffle_shop.dim_products
[0m14:25:14.540125 [debug] [Thread-12 ]: On model.jaffle_shop.fact_sales: Close
[0m14:25:14.540323 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6a050>]}
[0m14:25:14.540820 [debug] [Thread-15 ]: On model.jaffle_shop.low_stock: Close
[0m14:25:14.541087 [debug] [Thread-17 ]: Began running node model.jaffle_shop.top_category
[0m14:25:14.541293 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd39a0>]}
[0m14:25:14.541556 [info ] [Thread-10 ]: 9 of 16 OK created sql table model main.dim_customers .......................... [[32mOK[0m in 0.06s]
[0m14:25:14.545279 [debug] [Thread-15 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab2500>]}
[0m14:25:14.545492 [info ] [Thread-17 ]: 13 of 16 START sql table model main.top_category ............................... [RUN]
[0m14:25:14.545778 [info ] [Thread-12 ]: 10 of 16 OK created sql table model main.fact_sales ............................ [[32mOK[0m in 0.06s]
[0m14:25:14.546029 [debug] [Thread-10 ]: Finished running node model.jaffle_shop.dim_customers
[0m14:25:14.546273 [info ] [Thread-15 ]: 12 of 16 OK created sql table model main.low_stock ............................. [[32mOK[0m in 0.06s]
[0m14:25:14.546516 [debug] [Thread-17 ]: Acquiring new duckdb connection 'model.jaffle_shop.top_category'
[0m14:25:14.546763 [debug] [Thread-12 ]: Finished running node model.jaffle_shop.fact_sales
[0m14:25:14.547160 [debug] [Thread-15 ]: Finished running node model.jaffle_shop.low_stock
[0m14:25:14.547327 [debug] [Thread-19 ]: Began running node model.jaffle_shop.avg_order_value
[0m14:25:14.547478 [debug] [Thread-20 ]: Began running node model.jaffle_shop.customer_LTV
[0m14:25:14.547633 [debug] [Thread-17 ]: Began compiling node model.jaffle_shop.top_category
[0m14:25:14.547900 [debug] [Thread-22 ]: Began running node model.jaffle_shop.monthly_sales_growth
[0m14:25:14.548095 [info ] [Thread-19 ]: 14 of 16 START sql table model main.avg_order_value ............................ [RUN]
[0m14:25:14.548324 [info ] [Thread-20 ]: 15 of 16 START sql table model main.customer_LTV ............................... [RUN]
[0m14:25:14.549986 [debug] [Thread-17 ]: Writing injected SQL for node "model.jaffle_shop.top_category"
[0m14:25:14.550179 [info ] [Thread-22 ]: 16 of 16 START sql table model main.monthly_sales_growth ....................... [RUN]
[0m14:25:14.550412 [debug] [Thread-19 ]: Acquiring new duckdb connection 'model.jaffle_shop.avg_order_value'
[0m14:25:14.550611 [debug] [Thread-20 ]: Acquiring new duckdb connection 'model.jaffle_shop.customer_LTV'
[0m14:25:14.550845 [debug] [Thread-22 ]: Acquiring new duckdb connection 'model.jaffle_shop.monthly_sales_growth'
[0m14:25:14.551005 [debug] [Thread-19 ]: Began compiling node model.jaffle_shop.avg_order_value
[0m14:25:14.551169 [debug] [Thread-20 ]: Began compiling node model.jaffle_shop.customer_LTV
[0m14:25:14.551311 [debug] [Thread-17 ]: Began executing node model.jaffle_shop.top_category
[0m14:25:14.551458 [debug] [Thread-22 ]: Began compiling node model.jaffle_shop.monthly_sales_growth
[0m14:25:14.553603 [debug] [Thread-19 ]: Writing injected SQL for node "model.jaffle_shop.avg_order_value"
[0m14:25:14.554921 [debug] [Thread-20 ]: Writing injected SQL for node "model.jaffle_shop.customer_LTV"
[0m14:25:14.556482 [debug] [Thread-17 ]: Writing runtime sql for node "model.jaffle_shop.top_category"
[0m14:25:14.557836 [debug] [Thread-22 ]: Writing injected SQL for node "model.jaffle_shop.monthly_sales_growth"
[0m14:25:14.558191 [debug] [Thread-19 ]: Began executing node model.jaffle_shop.avg_order_value
[0m14:25:14.558333 [debug] [Thread-20 ]: Began executing node model.jaffle_shop.customer_LTV
[0m14:25:14.558502 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m14:25:14.559977 [debug] [Thread-19 ]: Writing runtime sql for node "model.jaffle_shop.avg_order_value"
[0m14:25:14.560124 [debug] [Thread-22 ]: Began executing node model.jaffle_shop.monthly_sales_growth
[0m14:25:14.561523 [debug] [Thread-20 ]: Writing runtime sql for node "model.jaffle_shop.customer_LTV"
[0m14:25:14.561658 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: BEGIN
[0m14:25:14.563137 [debug] [Thread-22 ]: Writing runtime sql for node "model.jaffle_shop.monthly_sales_growth"
[0m14:25:14.563359 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:25:14.563499 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m14:25:14.563709 [debug] [Thread-19 ]: On model.jaffle_shop.avg_order_value: BEGIN
[0m14:25:14.563857 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:25:14.566208 [debug] [Thread-19 ]: Opening a new connection, currently in state init
[0m14:25:14.566378 [debug] [Thread-17 ]: SQL status: OK in 0.003 seconds
[0m14:25:14.566607 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:25:14.566754 [debug] [Thread-20 ]: On model.jaffle_shop.customer_LTV: BEGIN
[0m14:25:14.566945 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m14:25:14.567086 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.567232 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: BEGIN
[0m14:25:14.567370 [debug] [Thread-20 ]: Opening a new connection, currently in state init
[0m14:25:14.567547 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */

  
    
    

    create  table
      "jaffle_shop"."main"."top_category__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
        od.order_id,
        o.order_date,
        od.product_id,
        od.quantity,
        od.unit_price,
        od.line_total,
        o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

category_sales AS (
    SELECT
        dp.category,
        SUM(fs.line_total) AS total_category_sales
    FROM fact_sales AS fs
    JOIN "jaffle_shop"."main"."dim_products" AS dp ON fs.product_id = dp.product_id
    GROUP BY dp.category
),

top_category AS (
    SELECT
        cs.category,
        cs.total_category_sales,
        RANK() OVER (ORDER BY cs.total_category_sales DESC) AS category_rank
    FROM category_sales AS cs
)

SELECT * FROM top_category
    );
  
  
[0m14:25:14.567722 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:25:14.567864 [debug] [Thread-22 ]: Opening a new connection, currently in state init
[0m14:25:14.568062 [debug] [Thread-20 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.568249 [debug] [Thread-19 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */

  
    
    

    create  table
      "jaffle_shop"."main"."avg_order_value__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_order_totals AS (
    SELECT
        customer_id,
        COUNT(DISTINCT order_id) AS total_orders,
        SUM(line_total) AS total_spent
    FROM fact_sales
    GROUP BY customer_id
    HAVING COUNT(DISTINCT order_id) > 3
),

average_order_value AS (
    SELECT
        cot.customer_id,
        dc.first_name,
        dc.last_name,
        cot.total_orders,
        cot.total_spent,
        ROUND(cot.total_spent / cot.total_orders, 1) AS avg_order_value
    FROM customer_order_totals AS cot
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cot.customer_id = dc.customer_id
)

SELECT * FROM average_order_value
ORDER BY avg_order_value DESC
    );
  
  
[0m14:25:14.568467 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:25:14.568618 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.568809 [debug] [Thread-20 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */

  
    
    

    create  table
      "jaffle_shop"."main"."customer_LTV__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

customer_revenue AS (
    SELECT
        fs.customer_id,
        SUM(fs.line_total) AS total_revenue,
        MIN(fs.order_date) AS first_purchase_date,
        MAX(fs.order_date) AS last_purchase_date,
        COUNT(DISTINCT fs.order_id) AS total_orders
    FROM fact_sales AS fs
    GROUP BY fs.customer_id
),

customer_ltv AS (
    SELECT
        cr.customer_id,
        dc.first_name,
        dc.last_name,
        cr.total_revenue,
        cr.total_orders,
        DATE_PART('day', cr.last_purchase_date - cr.first_purchase_date) AS customer_lifespan_days,
        ROUND(cr.total_revenue / NULLIF(cr.total_orders, 0), 2) AS avg_order_value,
        ROUND(cr.total_revenue / NULLIF(DATE_PART('day', CURRENT_DATE - cr.first_purchase_date) / 30, 0), 2) AS monthly_ltv
    FROM customer_revenue AS cr
    JOIN "jaffle_shop"."main"."dim_customers" AS dc ON cr.customer_id = dc.customer_id
)

SELECT * FROM customer_ltv
ORDER BY total_revenue DESC
    );
  
  
[0m14:25:14.568994 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:25:14.569204 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */

  
    
    

    create  table
      "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp"
  
    as (
      WITH fact_sales AS (
    SELECT
      od.order_id,
      o.order_date,
      od.product_id,
      od.quantity,
      od.unit_price,
      od.line_total,
      o.customer_id
    FROM "jaffle_shop"."main"."stg_order_details" AS od
    JOIN "jaffle_shop"."main"."stg_orders" AS o ON od.order_id = o.order_id
),

monthly_sales AS (
    SELECT
        DATE_TRUNC('month', order_date) AS sales_month,
        SUM(line_total) AS total_revenue,
        SUM(quantity) AS total_quantity_sold
    FROM "jaffle_shop"."main"."fact_sales"
    GROUP BY sales_month
),

sales_growth AS (
    SELECT
        ms.sales_month,
        ms.total_revenue,
        ms.total_quantity_sold,
        LAG(ms.total_revenue) OVER (ORDER BY ms.sales_month) AS previous_revenue,
        LAG(ms.total_quantity_sold) OVER (ORDER BY ms.sales_month) AS previous_quantity
    FROM monthly_sales AS ms
),

growth_calculations AS (
    SELECT
        sg.sales_month,
        sg.total_revenue,
        sg.total_quantity_sold,
        ROUND(((sg.total_revenue - sg.previous_revenue) / sg.previous_revenue) * 100, 2) AS revenue_growth_percentage,
        ROUND(((sg.total_quantity_sold - sg.previous_quantity) / sg.previous_quantity) * 100, 2) AS quantity_growth_percentage
    FROM sales_growth AS sg
    WHERE sg.previous_revenue IS NOT NULL
)

SELECT * FROM growth_calculations
ORDER BY sales_month ASC
    );
  
  
[0m14:25:14.570414 [debug] [Thread-17 ]: SQL status: OK in 0.002 seconds
[0m14:25:14.572435 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m14:25:14.572621 [debug] [Thread-22 ]: SQL status: OK in 0.003 seconds
[0m14:25:14.572890 [debug] [Thread-19 ]: SQL status: OK in 0.004 seconds
[0m14:25:14.573042 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
alter table "jaffle_shop"."main"."top_category__dbt_tmp" rename to "top_category"
[0m14:25:14.574339 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:25:14.575486 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:25:14.575735 [debug] [Thread-20 ]: SQL status: OK in 0.007 seconds
[0m14:25:14.575924 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth" rename to "monthly_sales_growth__dbt_backup"
[0m14:25:14.576102 [debug] [Thread-19 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value" rename to "avg_order_value__dbt_backup"
[0m14:25:14.576248 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.577416 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:25:14.577643 [debug] [Thread-22 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.578176 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: COMMIT
[0m14:25:14.578313 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.578471 [debug] [Thread-20 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV" rename to "customer_LTV__dbt_backup"
[0m14:25:14.579631 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:25:14.579800 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m14:25:14.580900 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:25:14.581079 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
alter table "jaffle_shop"."main"."monthly_sales_growth__dbt_tmp" rename to "monthly_sales_growth"
[0m14:25:14.581236 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: COMMIT
[0m14:25:14.581369 [debug] [Thread-20 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.581526 [debug] [Thread-19 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
alter table "jaffle_shop"."main"."avg_order_value__dbt_tmp" rename to "avg_order_value"
[0m14:25:14.582810 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:25:14.582932 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.583057 [debug] [Thread-17 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.583227 [debug] [Thread-20 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
alter table "jaffle_shop"."main"."customer_LTV__dbt_tmp" rename to "customer_LTV"
[0m14:25:14.583373 [debug] [Thread-19 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.583907 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m14:25:14.584772 [debug] [Thread-17 ]: Using duckdb connection "model.jaffle_shop.top_category"
[0m14:25:14.585893 [debug] [Thread-19 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m14:25:14.586045 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:25:14.586178 [debug] [Thread-20 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.586329 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.top_category"} */
drop table if exists "jaffle_shop"."main"."top_category__dbt_backup" cascade
[0m14:25:14.586472 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:25:14.586616 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: COMMIT
[0m14:25:14.587139 [debug] [Thread-20 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m14:25:14.587305 [debug] [Thread-19 ]: On model.jaffle_shop.avg_order_value: COMMIT
[0m14:25:14.587473 [debug] [Thread-17 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.587631 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:25:14.587768 [debug] [Thread-22 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.588315 [debug] [Thread-17 ]: On model.jaffle_shop.top_category: Close
[0m14:25:14.588452 [debug] [Thread-19 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.588606 [debug] [Thread-20 ]: On model.jaffle_shop.customer_LTV: COMMIT
[0m14:25:14.614861 [debug] [Thread-22 ]: Using duckdb connection "model.jaffle_shop.monthly_sales_growth"
[0m14:25:14.615143 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa5c00>]}
[0m14:25:14.616051 [debug] [Thread-19 ]: Using duckdb connection "model.jaffle_shop.avg_order_value"
[0m14:25:14.616242 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.monthly_sales_growth"} */
drop table if exists "jaffle_shop"."main"."monthly_sales_growth__dbt_backup" cascade
[0m14:25:14.616528 [info ] [Thread-17 ]: 13 of 16 OK created sql table model main.top_category .......................... [[32mOK[0m in 0.07s]
[0m14:25:14.616727 [debug] [Thread-20 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.616868 [debug] [Thread-19 ]: On model.jaffle_shop.avg_order_value: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.avg_order_value"} */
drop table if exists "jaffle_shop"."main"."avg_order_value__dbt_backup" cascade
[0m14:25:14.617166 [debug] [Thread-17 ]: Finished running node model.jaffle_shop.top_category
[0m14:25:14.618160 [debug] [Thread-20 ]: Using duckdb connection "model.jaffle_shop.customer_LTV"
[0m14:25:14.618303 [debug] [Thread-22 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.618585 [debug] [Thread-20 ]: On model.jaffle_shop.customer_LTV: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_LTV"} */
drop table if exists "jaffle_shop"."main"."customer_LTV__dbt_backup" cascade
[0m14:25:14.618742 [debug] [Thread-19 ]: SQL status: OK in 0.000 seconds
[0m14:25:14.619282 [debug] [Thread-22 ]: On model.jaffle_shop.monthly_sales_growth: Close
[0m14:25:14.619767 [debug] [Thread-19 ]: On model.jaffle_shop.avg_order_value: Close
[0m14:25:14.619985 [debug] [Thread-22 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0f010>]}
[0m14:25:14.620128 [debug] [Thread-20 ]: SQL status: OK in 0.001 seconds
[0m14:25:14.620316 [debug] [Thread-19 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fac5e0>]}
[0m14:25:14.620607 [info ] [Thread-22 ]: 16 of 16 OK created sql table model main.monthly_sales_growth .................. [[32mOK[0m in 0.07s]
[0m14:25:14.621105 [debug] [Thread-20 ]: On model.jaffle_shop.customer_LTV: Close
[0m14:25:14.621340 [info ] [Thread-19 ]: 14 of 16 OK created sql table model main.avg_order_value ....................... [[32mOK[0m in 0.07s]
[0m14:25:14.621611 [debug] [Thread-22 ]: Finished running node model.jaffle_shop.monthly_sales_growth
[0m14:25:14.624457 [debug] [Thread-20 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d7ad94-55ed-4694-babc-c1166ad21b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa7490>]}
[0m14:25:14.624703 [debug] [Thread-19 ]: Finished running node model.jaffle_shop.avg_order_value
[0m14:25:14.625003 [info ] [Thread-20 ]: 15 of 16 OK created sql table model main.customer_LTV .......................... [[32mOK[0m in 0.07s]
[0m14:25:14.625281 [debug] [Thread-20 ]: Finished running node model.jaffle_shop.customer_LTV
[0m14:25:14.625972 [debug] [MainThread]: Using duckdb connection "master"
[0m14:25:14.626103 [debug] [MainThread]: On master: BEGIN
[0m14:25:14.626207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:14.628249 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:25:14.628379 [debug] [MainThread]: On master: COMMIT
[0m14:25:14.628493 [debug] [MainThread]: Using duckdb connection "master"
[0m14:25:14.628599 [debug] [MainThread]: On master: COMMIT
[0m14:25:14.628719 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:25:14.628835 [debug] [MainThread]: On master: Close
[0m14:25:14.629303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:14.629430 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m14:25:14.629539 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory' was properly closed.
[0m14:25:14.629644 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_inventory_transactions' was properly closed.
[0m14:25:14.629736 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_order_details' was properly closed.
[0m14:25:14.629828 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m14:25:14.629920 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_products' was properly closed.
[0m14:25:14.630009 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_supplier_products' was properly closed.
[0m14:25:14.630100 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_suppliers' was properly closed.
[0m14:25:14.630205 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m14:25:14.630303 [debug] [MainThread]: Connection 'model.jaffle_shop.fact_sales' was properly closed.
[0m14:25:14.630404 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_products' was properly closed.
[0m14:25:14.630496 [debug] [MainThread]: Connection 'model.jaffle_shop.low_stock' was properly closed.
[0m14:25:14.630585 [debug] [MainThread]: Connection 'model.jaffle_shop.top_category' was properly closed.
[0m14:25:14.630677 [debug] [MainThread]: Connection 'model.jaffle_shop.avg_order_value' was properly closed.
[0m14:25:14.630767 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_LTV' was properly closed.
[0m14:25:14.630856 [debug] [MainThread]: Connection 'model.jaffle_shop.monthly_sales_growth' was properly closed.
[0m14:25:14.631035 [info ] [MainThread]: 
[0m14:25:14.631167 [info ] [MainThread]: Finished running 8 view models, 8 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m14:25:14.632090 [debug] [MainThread]: Command end result
[0m14:25:14.650264 [info ] [MainThread]: 
[0m14:25:14.650500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:14.650635 [info ] [MainThread]: 
[0m14:25:14.650765 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m14:25:14.652141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8247886, "process_user_time": 1.149825, "process_kernel_time": 0.150755, "process_mem_max_rss": "169574400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:25:14.652343 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:14.652308 after 0.83 seconds
[0m14:25:14.652497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105182920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e45f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e455d0>]}
[0m14:25:14.652640 [debug] [MainThread]: Flushing usage events
